<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8"/>
    <meta property="og:url" content="https://www.itmedia.co.jp/news/articles/1912/09/news078.html"/>
    <meta property="og:site_name" content="ITmedia NEWS"/>
    <meta property="article:published_time" content="2019-12-09T13:00:00+00:00"/>
    <meta property="og:title" content="「見破るのは実質不可能」──ECサイトからカード番号盗む“最新手口”、セキュリティ専門家の徳丸氏が解説 (1/2)"/>
    <meta property="og:description" content="セキュリティ専門家の徳丸浩氏は、「情報漏えい事件が急増した1年だった」と振り返る。情報を盗もうとする攻撃者の最新手口については「自分でも気付けるか分からない」と状況は深刻だ。"/>
  </head>
  <body>
    <article>
      <h1>「見破るのは実質不可能」──ECサイトからカード番号盗む“最新手口”、セキュリティ専門家の徳丸氏が解説 (1/2)</h1>
      <h2>セキュリティ専門家の徳丸浩氏は、「情報漏えい事件が急増した1年だった」と振り返る。情報を盗もうとする攻撃者の最新手口については「自分でも気付けるか分からない」と状況は深刻だ。</h2>
      <address><time datetime="2019-12-09T13:00:00+00:00">09 Dec 2019, 13:00</time> by <a rel="author">井上輝一，ITmedia</a></address>
      <p>　ECサイトからクレジットカードや個人情報などの情報漏えいが相次いだ2019年。記憶に新しいところでは<a href="https://www.itmedia.co.jp/news/articles/1912/05/news150.html">象印</a>、19年前半では<a href="https://www.itmedia.co.jp/news/articles/1905/29/news114.html">ヤマダ電機</a>などのECサイトからクレジットカード情報が漏えいした。セキュリティ専門家の徳丸浩氏は、「情報漏えい事件が急増した1年だった」と振り返る。情報を盗もうとする攻撃者の最新手口については「自分でも気付けるか分からない」と状況は深刻だ。</p>
      <h3>サイトはクレジットカード情報を保持していないのに……</h3>
      <p>　徳丸氏は、19年に目立った攻撃手法として「<b>入力画面の改ざん</b>」と「<b>偽の決済画面</b>」という2つの手法を挙げる。</p>
      <p>　これらの攻撃を受けるECサイトは、決済方法について2種類に分けられる。1つは、クレジットカード情報をECサイトの画面で受けつつも直接決済サーバに送り、決済サーバからECサイトのサーバに返ってきたトークンを使って決済処理を行う「<b>トークン型</b>」。もう1つは決済自体を決済会社側で行う「<b>リダイレクト型</b>」だ。</p>
      <figure>
        <img src="https://image.itmedia.co.jp/news/articles/1912/09/ki_1609376_tokumaru02_w290.jpg"/>
        <figcaption>決済サーバから返ってきたトークンで決済処理を行う「トークン型」（左）と、決済自体を決済会社側で行う「リダイレクト型」（右）</figcaption>
      </figure>
      <figure>
        <img src="https://image.itmedia.co.jp/news/articles/1912/09/ki_1609376_tokumaru_w190.jpg"/>
        <figcaption>セキュリティ専門家の徳丸浩氏</figcaption>
      </figure>
      <p>　「これら2つの決済方法は、いずれもECサイト側でクレジットカード情報を保持していない」と徳丸氏は解説する。</p>
      <p>　「2018年6月に割賦販売法が改正された。この際に、ECサイトのクレジットカード番号非保持化が定められた」</p>
      <p>　従来のECサイトでは、各サイトのデータベースにクレジットカード情報が保存されていたため、「SQLインジェクション」やバックドア攻撃などでセキュリティ的に脆弱なサイトのデータベースから情報を直接盗むことができた。</p>
      <p>　しかし18年6月以降、各ECサイトのデータベースにクレジットカード情報は保存されていない。このような状況でなぜ、クレジットカード情報の漏えいが起こるのか。</p>
      <p>　徳丸氏は、ECサイトのシステム管理がずさんな現状を指摘する。</p>
      <h3>普及している「バージョン2」に“難”あり</h3>
      <p>　ECサイトを構築するためのシステムとして、「EC-CUBE」というコンテンツ管理システムが広く用いられている。「最新バージョンは4系だが、バージョン2系が特に広く普及している」と徳丸氏は話す。攻撃で狙われているのはこの「バージョン2系」だという。</p>
      <p>　徳丸氏は、バージョン2で構築したデモ用ECサイトを実際に攻撃しながら手法を説明する。</p>
      <h4>入力画面の改ざん　ECサイト内の入力から番号が盗まれる</h4>
      <figure>
        <img src="https://image.itmedia.co.jp/news/articles/1912/09/ki_1609376_tokumaru04_w490.jpg"/>
        <figcaption>トークン型には入力画面の改ざんで攻撃</figcaption>
      </figure>
      <p>　まず、決済方法にトークン型を用いていた場合。攻撃者は、ECサイト管理者が間違って誰でも見られる状態にしてしまっている「あるページ」から情報を抜き、管理コンソールにログイン。手順を踏んでバックドアを設置し、決済画面でクレジットカード番号を入力する欄に10行程度の攻撃コードを追加する。</p>
      <p>　これにより、ユーザーが入力欄に番号を入力すると、番号が攻撃者のサーバにも送られることになってしまう。</p>
      <p>
        <a href="https://www.itmedia.co.jp/news/articles/1912/09/news078_2.html">「見破るのは実質不可能」　偽の決済画面による抜き取り</a>
      </p>
      <p>　　　　　　 <b>1</b>|<a href="https://www.itmedia.co.jp/news/articles/1912/09/news078_2.html">2</a> <a href="https://www.itmedia.co.jp/news/articles/1912/09/news078_2.html">次のページへ</a></p>
    </article>
  </body>
</html>