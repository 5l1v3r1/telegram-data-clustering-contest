<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8"/>
    <meta property="og:url" content="https://spark.ru/startup/falcon-space/blog/53942/sql-driven-uchetnaya-sistema-s-orientatsiej-na-sql"/>
    <meta property="og:site_name" content="SPARK"/>
    <meta property="article:published_time" content="2019-12-09T09:10:49+00:00"/>
    <meta property="og:title" content="SQL Driven. Учетная система с ориентацией на SQL"/>
    <meta property="og:description" content="В статье описан подход, когда во главу угла ставится SQL, а также плюсы и минусы подобного подхода."/>
  </head>
  <body>
    <article>
      <h1>SQL Driven. Учетная система с ориентацией на SQL</h1>
      <h2>В статье описан подход, когда во главу угла ставится SQL, а также плюсы и минусы подобного подхода.</h2>
      <address><time datetime="2019-12-09T09:10:49+00:00">09 Dec 2019, 09:10</time> by <a rel="author" href="https://spark.ru/startup/falcon-space" target="_blank">Falcon Space</a></address>
      <h3>Что есть полный стек разработки?</h3>
      <p>Самописные системы разрабатываются на базе полного стека разработки с N слоями:</p>
      <ul>
        <li>проектируется база данных</li>
        <li>создается слой доступа к данным</li>
        <li>создается слой бизнес-логики</li>
        <li>разрабатывается API или слой контроллеров</li>
        <li>делается верстка</li>
        <li>к ней подключается динамика за счет front end программирования.</li>
      </ul>
      <p>Это довольно трудоемко, сложно. Но этому есть причина. Коробочные решения не дают гибкости, а для дальнейшего развития системы очень важно иметь возможность легко развивать систему без серьезных ограничений.</p>
      <p>Когда то давно мы создали модуль метрик, который генерировал некие отчеты в виде вложенных показателей. Каждый отчет — это данные в таблицах + некая хранимая процедура для извлечения данных.</p>
      <p>Движок модуля подхватывал эти данные и хранимку и выводил все что нужно пользователю.</p>
      <p>Это привело нас к идее, а почему бы и другие все модули не попробовать сделать по подобному принципу — формы, таблицы, графики, дашборды и прочее.</p>
      <p>Что дает в итоге такой подход:</p>
      <p>во-первых, можно менять бизнес-логику на лету (просто поменяв хранимую процедуру). В случае обычного N-слойного приложения необходима перекомпиляция и обновление программы.</p>
      <p>во-вторых, что следует из первого — это скорость внесения изменений. Очень важно иметь возможность быстро вносить изменения, а не ждать разработчиков по 2 недели, когда они внедрят изменения в систему.</p>
      <p>в-третьих, основная сложность ложится на 1 слой и локация ошибки с высокой степенью вероятности находится только в 1 слое — SQL процедурах. Это упрощает поиск ошибок и минимизирует количество сбоев на front end.</p>
      <h3>Как это выглядит изнутри</h3>
      <p>Возьмем к примеру вывод таблицы.</p>
      <p>На входе — это сниппет</p>
      <p>Ваш JS движок обрабатывает подобные компоненты и запрашивает у базы описание по компонентам и данные для них (все через знанимые процедуры).</p>
      <p>Полученные данные JS движок выводит в виде таблицы. Данные удовлетворяют неким правилам/стандартам. Например для таблиц у нас правила примерно выглядят так:</p>
      <p>процедура GetItems выдает в SELECT 1 данные таблицы, в SELECT 2 — данные о пагинации, в SELECT 3 — настройки вывода таблицы.</p>
      <p>К примеру если в select 3 передать select 1 compact — то таблица будет выведена в компактном режиме.</p>
      <figure>
        <img src="https://spark.ru/upload/other/b_5decbeebd0fde.jpg"/>
        <figcaption>Редактирование SQL для таблицы вывода страниц</figcaption>
      </figure>
    </article>
  </body>
</html>