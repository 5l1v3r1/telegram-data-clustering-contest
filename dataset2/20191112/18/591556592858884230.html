<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8"/>
    <meta property="og:url" content="https://www.zdnet.com/article/intels-cascade-lake-cpus-impacted-by-new-zombieload-v2-attack/"/>
    <meta property="og:site_name" content="ZDNet"/>
    <meta property="article:published_time" content="2019-11-12T18:00:00+00:00"/>
    <meta property="og:title" content="Intel's Cascade Lake CPUs impacted by new Zombieload v2 attack"/>
    <meta property="og:description" content="Zombieload v2 impacts Intel CPUs released since 2013, if they support the Intel TSX instruction set."/>
  </head>
  <body>
    <article>
      <h1>Intel's Cascade Lake CPUs impacted by new Zombieload v2 attack</h1>
      <address><time datetime="2019-11-12T18:00:00+00:00">12 Nov 2019, 18:00</time> by <a rel="author" href="https://www.zdnet.com/meet-the-team/us/catalin.cimpanu/" target="_blank">Catalin Cimpanu</a></address>
      <p>
        <b>Zombieload v2 impacts Intel CPUs released since 2013, if they support the Intel TSX instruction set.</b>
      </p>
      <figure>
        <img src="https://zdnet4.cbsistatic.com/hub/i/2019/05/14/017a88fb-7bcb-4a24-9157-d53e9ffd4e88/3319e0c220ea207d61aa43cb0e854bec/zombieland.png"/>
      </figure>
      <p>The Zombieload vulnerability disclosed earlier this year in May has a second variant that also works against more recent Intel processors, not just older ones, including Cascade Lake, Intel's latest line of high-end CPUs -- initially thought to have been unaffected.<br/><br/>Intel is releasing microcode (CPU firmware) updates today to address this new Zombieload attack variant, as part of its monthly Patch Tuesday -- known as <a href="https://blogs.intel.com/technology/2019/11/ipas-november-2019-intel-platform-update-ipu/">the Intel Platform Update (IPU) process</a>.</p>
      <h3>What is Zombieload</h3>
      <p>Back in May, two teams of academics disclosed a new batch of vulnerabilities that impacted Intel CPUs. Collectively known as <a href="https://cpu.fail/">MDS attacks</a>, these are security flaws in the same class as Meltdown, Spectre, and Foreshadow.<br/><br/>The attacks rely on taking advantage of the speculative execution process, which is an optimization technique that Intel added to its CPUs to improve data processing speeds and performance.<br/><br/>Vulnerabilities like Meltdown, Spectre, and Foreshadow, showed that the speculative execution process was riddled with security holes.</p>
      <p><a href="https://www.zdnet.com/article/intel-cpus-impacted-by-new-zombieload-side-channel-attack/">Disclosed in May</a>, MDS attacks were just the latest line of vulnerabilities impacting speculative execution.<br/><br/>They were different from the original Meltdown, Spectre, and Foreshadow bugs disclosed in 2018 because they attacked different areas of a CPU's speculative execution process.</p>
      <p>While Meltdown, Spectre, and Foreshadow attacked data stored inside the L1 cache, MDS attacks went after a CPU's microarchitectural data structures -- hence, the name of Microarchitectural Data Sampling (MDS) attacks. These microarchitectural data structures included the load, store, and line fill buffers, which the CPU uses for fast reads/writes of data being processed inside the CPU.<br/><br/>The original MDS attacks disclosed in May targeted store buffers (CVE-2018-12126 aka Fallout), load buffers (CVE-2018-12127), line fill buffers (CVE-2018-12130, aka the Zombieload attack, or RIDL), and uncacheable memory (CVE-2019-11091). At the time, Zombieload was deemed the most dangerous of all four MDS attacks because it could retrieve more information than the others.</p>
      <h3>Meet Zombieload v2</h3>
      <p>But unbeknownst to the world, there was a fifth MDS attack at the time, which researchers kept secret because Intel had yet to release a patch.<br/><br/>Nicknamed Zombiload v2 (CVE-2019-11135), this is a variation of the Zombieload v1 vulnerability, but one that worked on Intel's newer line of CPUs, those which the company claimed had protections against speculative execution attacks baked in at the hardware level.<br/><br/>According to an updated version of the Zombieload academic paper that ZDNet received this week, the Zombieload v2 attack exploits the <a href="https://en.wikipedia.org/wiki/Transactional_Synchronization_Extensions">Intel Transactional Synchronization Extensions (TSX)</a> Asynchronous Abort operation that occurs when an attacker uses malicious code to create a conflict between read operations inside a CPU.<br/><br/>This read conflict for TSX Asynchronous Abort (TAA) operations leaks data about what's being processed inside an Intel CPU.<br/><br/>"The main advantage of this approach is that it also works on machines with hardware fixes for Meltdown, which we verified on an i9-9900K and Xeon Gold 5218," the research team explained in the revised version of their whitepaper.<br/><br/>The only condition for a Zombieload v2 attack is that the targeted CPU supports the Intel TSX instruction-set extension, which the research team said is available by default in all Intel CPUs sold since 2013.<br/><br/>The first Intel CPU series to have featured TSX support was the Haswell platform. Everything that came after is affected. Intel's Cascade Lake, which the company released in April this year, was supposed to be the company's first product that featured protections against side-channel and speculative execution attacks at the hardware level.</p>
      <h3>Intel's response</h3>
      <p>In an email to ZDNet, an Intel spokesperson wanted customers to know that microcode updates will be made available for Zombieload v2 on the company's website.<br/><br/>Furthermore, the company added that the Zombieload v2 vulnerability (which Intel tracks as the "TAA attack" in its own documentation) is not as dangerous as it sounds.<br/><br/>While all the MDS attacks can allow attackers to run malicious code against an Intel CPU, attackers can't control what data they can target and extract.<br/><br/>MDS attacks, while very much possible, are inefficient when compared to other means of stealing data from a target, an opinion that other security experts have also expressed in the past.<br/><br/>However, the fact that day-to-day malware gangs won't bother exploiting something as complex as an MDS attack, or Zombieload v2, that doesn't mean the vulnerabilities should be ignored. Applying these microcode updates should be a priority for everyone who manages critical infrastructure or cloud data centers.<br/><br/>If users don't want to update and deal with a potential performance dip due to yet another patch for speculative execution attacks, Intel also recommending disabling the CPU's TSX support, if not used.</p>
      <h3>More bad news</h3>
      <p>But bad news never comes alone. The same research team who found Zombieload v1 and v2, also found an issue with Intel's original patches for the four MDS attacks disclosed in May.<br/><br/><a href="https://software.intel.com/security-software-guidance/insights/deep-dive-intel-analysis-microarchitectural-data-sampling">The VERW instruction set</a>, which Intel claimed could be used to protect apps against MDS attacks that may attempt to extract data while being processed in the CPU, was incomplete and could be circumvented, the research team said.<br/><br/>When we asked Intel about this issue, the CPU chipmaker acknowledged the problem and claimed that the VERW instruction set, along with the other MDS attack protections were meant to reduce the attack surface and make exploitation harder for attackers, and not as a complete patch for MDS attacks.<br/><br/>A version of the <a href="https://zombieloadattack.com/zombieload.pdf">revised Zombieload whitepaper</a> will be made available on the <a href="https://zombieloadattack.com/">Zombieload website</a> later today. The research team will be presenting their revised findings tomorrow at the <a href="https://sigsac.org/ccs/CCS2019/index.php/program/program-2/#Wednesday">ACM CCS conference</a> in London.<br/><br/><i>Updated on November 13 to add a link to </i><a href="https://support.microsoft.com/en-us/help/4530989/guidance-for-protecting-against-intel-processor-machine-check-error-vu"><i>a Microsoft advisory</i></a><i> on how to disable Intel TSX, the technology impacted by the new Zombieload v2 attack.</i></p>
    </article>
  </body>
</html>