<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8"/>
    <meta property="og:url" content="https://www.zdnet.com/article/flaw-in-intel-pmx-driver-gives-near-omnipotent-control-over-a-victim-device/"/>
    <meta property="og:site_name" content="ZDNet"/>
    <meta property="article:published_time" content="2019-11-12T18:00:09+00:00"/>
    <meta property="og:title" content="Flaw in Intel PMx driver gives 'near-omnipotent control over a victim device'"/>
    <meta property="og:description" content="Intel released an updated version of pmxdrvx64.sys and pmxdrv.sys; however, patching might take a while."/>
  </head>
  <body>
    <article>
      <h1>Flaw in Intel PMx driver gives 'near-omnipotent control over a victim device'</h1>
      <address><time datetime="2019-11-12T18:00:09+00:00">12 Nov 2019, 18:00</time> by <a rel="author" href="https://www.zdnet.com/meet-the-team/us/catalin.cimpanu/" target="_blank">Catalin Cimpanu</a></address>
      <p>
        <b>Intel released an updated version of pmxdrvx64.sys and pmxdrv.sys; however, patching might take a while.</b>
      </p>
      <figure>
        <img src="https://zdnet4.cbsistatic.com/hub/i/2019/11/12/05139b80-b1fe-419b-8e11-ed72f8d25842/18da137a3b71dd7c3c49d57f402973ce/intel-logo.jpg"/>
        <figcaption>Image: Artiom Vallat, Intel</figcaption>
      </figure>
      <p>Intel released today an updated version of its PMx driver to fix a set of vulnerabilities that could grant attackers "near-omnipotent control over a victim device."<br/><br/>The vulnerabilities were discovered earlier this year by researchers from Eclypsium, as part of a mammoth project that looked at the overall state of Windows kernel driver security.<br/><br/>Over the summer, Eclypsium researchers presented their findings at the DEF CON 27 security conference in Las Vegas. At the time, they disclosed over 40 vulnerabilities in kernel drivers from 20 different hardware vendors.<br/><br/>They only made public details about 39 kernel drivers, holding back on disclosing a few issues that had yet to be fixed.<br/><br/>Two of those issues were fixed three days later after Eclypsium's DEF CON talk [<a href="https://media.defcon.org/DEF%20CON%2027/DEF%20CON%2027%20presentations/DEFCON-27-Jesse-Michael-Get-off-the-kernel-if-you-cant-drive.pdf">PDF</a>], on August 13, when Intel released fixes for the <a href="https://www.intel.com/content/www/us/en/security-center/advisory/intel-sa-00281.html">Intel Processor Identification Utility</a> and the <a href="https://www.intel.com/content/www/us/en/security-center/advisory/intel-sa-00283.html">Intel Computing Improvement Program</a>.</p>
      <h3>Fixes for Intel's PMx driver rolling out today</h3>
      <p>"Another driver that was held under embargo due to the complexity of the issue was the Intel PMx Driver (also named PMxDrv)," the Eclypsium team <a href="https://eclypsium.com/2019/11/12/mother-of-all-drivers">said in a blog post today</a>.<br/><br/>"During our analysis of the Intel PMx driver, we found it to be incredibly capable, containing a superset of all the capabilities that we had seen previously."</p>
      <p>According to researchers, this kernel driver could<br/><br/>● Read/Write to physical memory<br/>● Read/Write to Model Specific Registers (MSR)<br/>● Read/Write to control registers<br/>● Read/Write to the interrupt descriptor table (IDT) and the global descriptor table (GDT)<br/>● Read/write to debug registers<br/>● Arbitrarily gain I/O access<br/>● Arbitrarily gain PCI access<br/><br/><a href="https://www.zdnet.com/article/researchers-find-security-flaws-in-40-kernel-drivers-from-20-vendors/">As Eclypsium researchers told ZDNet in an interview back in August</a>, all these legitimate PMx driver features could be abused by malicious code running on an infected machine.<br/><br/>Normally, an attacker would need admin rights to access a kernel driver's functions, but Eclypsium said that many vendors had failed to protect kernel drivers according to safe programming practices, and were allowing userspace apps to call kernel driver functions without any restrictions.<br/><br/>Such was the case for Intel's PMx driver.<br/><br/>Making matters worse, this is one of the most popular and widely used kernel drivers in existence. The driver has been a common component of many Intel ME and BIOS-related tools that Intel has been releasing for the past two decades, since 1999.<br/><br/>For example, one of the places you'll find the driver is a "<a href="https://www.intel.com/content/www/us/en/support/articles/000025619/software.html">detection tool</a>" that Intel released in 2017 to help system administrators identify if their workstations and servers were vulnerable to a major bug in the Intel Management Engine.<br/><br/>When reached out for comment, Intel told ZDNet via email that they'll be releasing today updated versions of the pmxdrvx64.sys and pmxdrv.sys PMx driver files to mitigate any potential security threats.<br/><br/>However, as we've seen in the past with many products, it will take a few months, if not years, for these patches to reach most of the Intel population.</p>
      <h3>Summary of the "Screwed Drivers" research</h3>
      <p>For ZDNet readers who were not aware of the general issue that we first covered in August, below is a summary with the most important details they need to be aware, along with helpful links:</p>
      <ul>
        <li>Eclypsium found that many kernel drivers, meant to allow hardware components to interact with the OS kernel, were also allowing apps to relay commands to the kernel, with no safeguards.</li>
        <li>A list of "unprotected kernel drivers" is available <a href="https://github.com/eclypsium/Screwed-Drivers/blob/master/DRIVERS.md">here</a>.</li>
        <li>A list of public security advisories is <a href="https://github.com/eclypsium/Screwed-Drivers/blob/master/ADVISORIES.md">here</a>. Only Intel and Huawei made the security flaws public, while most vendors chose to quietly patch impacted drivers.</li>
        <li>Insyde contacted Microsoft and asked that the vulnerable version of their kernel driver be blocked at the OS level <a href="https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?name=Program%3aWin32%2fVulnInsydeDriver.A&amp;amp;threatid=258247">by Windows Defender</a>.</li>
        <li>Microsoft said it would be using its HVCI (Hypervisor-enforced Code Integrity) capability to blacklist vulnerable drivers that are reported to them.</li>
        <li>The Windows HVCI feature only works on systems with a 7th gen Intel CPU, and is not generally available on all Windows systems. Manual patching may still be needed in the vast majority of cases.</li>
        <li>The list of impacted driver vendors is as follows (three vendor names have not yet been made public because they're still working on patching):</li>
      </ul>
      <p>● American Megatrends International (AMI)<br/>● ASRock<br/>● ASUSTeK Computer<br/>● ATI Technologies (AMD)<br/>● Biostar<br/>● EVGA<br/>● Getac<br/>● GIGABYTE<br/>● Huawei<br/>● Insyde<br/>● Intel<br/>● Micro-Star International (MSI)<br/>● NVIDIA<br/>● Phoenix Technologies<br/>● Realtek Semiconductor<br/>● SuperMicro<br/>● Toshiba</p>
    </article>
  </body>
</html>