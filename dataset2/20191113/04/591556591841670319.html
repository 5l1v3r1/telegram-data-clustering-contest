<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8"/>
    <meta property="og:url" content="https://www.zdnet.com/article/tpm-fail-vulnerabilities-impact-tpm-chips-in-desktops-laptops-servers/"/>
    <meta property="og:site_name" content="ZDNet"/>
    <meta property="article:published_time" content="2019-11-13T04:23:00+00:00"/>
    <meta property="og:title" content="TPM-FAIL vulnerabilities impact TPM chips in desktops, laptops, servers"/>
    <meta property="og:description" content="TPM-FAIL lets attackers steal private keys from TPMs. Attacks take from minutes to a few hours."/>
  </head>
  <body>
    <article>
      <h1>TPM-FAIL vulnerabilities impact TPM chips in desktops, laptops, servers</h1>
      <address><time datetime="2019-11-13T04:23:00+00:00">13 Nov 2019, 04:23</time> by <a rel="author" href="https://www.zdnet.com/meet-the-team/us/catalin.cimpanu/" target="_blank">Catalin Cimpanu</a></address>
      <p>
        <b>TPM-FAIL lets attackers steal private keys from TPMs. Attacks take from minutes to a few hours.</b>
      </p>
      <figure>
        <img src="https://zdnet3.cbsistatic.com/hub/i/2019/11/12/bc7b1e54-c0e3-41e0-b212-b08b54578ea4/492cff1f11f09f52baa4a9057f49a9aa/tpm-fail.png"/>
      </figure>
      <p>A team of academics has disclosed today two vulnerabilities known collectively as TPM-FAIL that could allow an attacker to retrieve cryptographic keys stored inside TPMs.<br/><br/>Thanks to efforts from the research team, both vulnerabilities have been fixed, which is a good thing since both issues can be weaponized in doable real-world attacks -- something that is very rare in the case of TPM vulnerabilities.</p>
      <h3>What are Trusted Platform Modules</h3>
      <p>TPM stands for Trusted Platform Module. In the early days of computing, TPMs were separate chips added to a motherboard were a CPU would store and manage sensitive information such as cryptographic keys.<br/><br/>These keys were used to ensure hardware integrity during the boot-up process or to attest various cryptographic operations, such as handling digital certificates, ensuring HTTPS connections on servers, or verifying authentication-related processes.<br/><br/>However, as the hardware ecosystem evolved with modern smartphones and "smart" embedded devices, there was no room for a separate TPM chipset on all devices, and a 100% software-based solution was developed in the form of firmware-based TPMs -- also known as fTPMs.</p>
      <p>Nowadays, it's hard to find a device that's not using a TPM, either in the form of a hardware-isolated chip, or a software-based solution. TPMs are at the heart of most devices, even in tiny electronics, such as some IoT "smart" devices.</p>
      <h3>TPM-Fail -- what is impacted</h3>
      <p>In a research paper published today, a team of academics from the Worcester Polytechnic Institute (USA), the University of LÃ¼beck (Germany), and the University of California, San Diego (USA) has disclosed two vulnerabilities that impact two very widely used TPM solutions.</p>
      <p>The first vulnerability is CVE-2019-11090 and impacts <a href="https://www.intel.com/content/www/us/en/support/articles/000007452/mini-pcs.html">Intel's Platform Trust Technology</a> (PTT).<br/><br/>Intel PTT is Intel's fTPM software-based TPM solution and is widely used on servers, desktops, and laptops, being supported on all Intel CPUs released since 2013, starting with the Haswell generation.<br/><br/>The second is CVE-2019-16863 and impacts the <a href="https://www.st.com/en/secure-mcus/st33tphf20i2c.html">ST33 TPM chip</a> made by STMicroelectronics.<br/><br/>This chip is incredibly popular and is used on a wide array of devices ranging from networking equipment to cloud servers, being one of the few chips that received a CommonCriteria (CC) EAL 4+ classification -- which implies it comes with built-in protection against side-channel attacks like the ones discovered by the research team.</p>
      <h3>TPM-Fail -- the attacks</h3>
      <p>The actual attacks on these two TPM technologies is what security researcher call a "timing leakage."<br/><br/>An external observer can record the time differences when the TPM is performing repetative operations and infer the data being processed inside the secure chip -- all based on the amount of time the TPM takes to do the same thing over and over again.<br/><br/>The research team says the "timing leakage" they discovered can be used to extract 256-bit private keys that are being stored inside the TPM. More specifically, 256-bit private keys used by certain digital signature schemes based on elliptic curves algorithms such as ECDSA and ECSchnorr.<br/><br/>While this sounds like a very narrow attack surface, these two are common digital signature schemes used in many of today's cryptographically-secured operations, such as establishing TLS connections, signing digital certificates, and authorizing logins.<br/><br/>But the novelty and danger factor surrounding TPM-FAIL relies in the fact that this attack is also fully weaponizable in a real-world scenario. <br/><br/>Similar attacks on TPMs usually recover partial keys or take too long to execute. TPM-FAIL does not.<br/><br/>"They are practical," the research team said about TPM-FAIL.<br/><br/>"A local adversary can recover the ECDSA key from Intel fTPM in 4-20 minutes depending on the access level," they said.<br/><br/>"We even show that these attacks can be performed remotely on fast networks, by recovering the authentication key of a virtual private network (VPN) server in 5 hours."<br/><br/>Performing a five-hour-long attack on a remote VPN server isn't as hard as it sounds. Per the research team, the attack involves initiating around 45,000 authentication handshakes against a remote VPN server and recording the responses.<br/><br/>After enough observations of the response time, attackers would be able to recover the private key that the VPN server was using to sign and verify authentication operations, and allowing themselves to access a VPN-protected network.<br/><br/>The only good news is that the attack is not trivial and that some advanced technical knowledge would be needed from an attacker -- however, not that advanced that would exclude any potential attacks.<br/><br/>"The attacks could indeed be weaponized with some effort," Daniel Moghimi from the Worcester Polytechnic Institute, and one of the researchers behind TPM-FAIL, told <i>ZDNet </i>in an interview today.<br/><br/>"The required skill to pull this kind of attack is, of course, more than the script-kiddie effort, but there are many people out there who use similar techniques to solve more advanced CTF challenges."</p>
      <h3>TPM-FAIL -- patches and proof-of-concept code</h3>
      <p>Moghimi told <i>ZDNet </i>that the research team started working on exploring this new attack vector inside TPMs earlier this year in January.<br/><br/>They tested many TPM technologies and not just the ones from Intel and STMicroelectronics. However, TPMs from Infineon and Nuvoton were not found to be vulnerable.<br/><br/>The first issue that they discovered was the one impacting Intel's PPT, which they reported to the company in February.<br/><br/>"Intel was quite professional," Moghimi told <i>ZDNet</i>. "In the last two years, they have pretty much streamlined the disclosure process. Our only concern was the initial assigned CVS score, but after we provided them a detailed [proof-of-concept] showing that the attack can be performed remotely, they changed/increased it."<br/><br/>Moghimi said this disclosure process ended today, on November 12, when Intel released firmware updates for the Intel PTT, which users can download via the <a href="https://www.intel.com/content/www/us/en/security-center/advisory/intel-sa-00241.html">company's official security advisory</a>.<br/><br/>The STMicroelectronics issue was discovered a few months later after the Intel one, namely in May, when the research team also reached out to the company.<br/><br/>Since STMicroelectronics was shipping a hardware-enforced TPM, the company couldn't just issue a software update. Instead, they prepared a new iteration of the ST33 chip.<br/><br/>The research team said they received a version of this new chip and confirmed that it was resistant to the TPM-FAIL attacks on September 12, 2019.<br/><br/>The company was supposed to publish <a href="https://www.st.com/tpm-update">a security advisory</a> at the following URL (also mentioned in <a href="https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/ADV190024">a Microsoft security advisory</a>), but the security advisory was not public at the time of this article's publication.<br/><br/>Now, a long process starts during which end-users -- home consumers and enterprise customers alike -- are expected to update CPU/motherboard firmware, and replace outdated equipment.<br/><br/>Of the two, the issue impacting Intel's fTPM solution is considered the most dangerous, as it could be exploited remotely.<br/><br/>The research team told <i>ZDNet </i>they plan to publish the tools they used to analyze the vulnerable TPMs, along with proof-of-concept code, <a href="https://github.com/VernamLab/TPM-Fail">on GitHub</a>.<br/><br/>In large enterprise networks, some system administrators may not be fully aware of what TPMs they are using on particular devices. The proof-of-concept code should help these sysadmins test and see if they have devices vulnerable to the two attacks.<br/><br/>Unfortunately, the same proof-of-concept code may also end up helping attackers, once it gets published online. Applying the Intel PPT firmware updates should be a top priority.<br/><br/>A technical whitepaper on the TPM-FAIL attacks is available for download, and is entitled "<a href="http://tpm.fail/tpmfail.pdf">TPM-FAIL: TPM meets Timing and Lattice Attacks</a>." <a href="http://tpm.fail/">A dedicated website</a> is also available. Some of the researchers involved in TPM-FAIL were also involved in the discovery of the <a href="https://www.zdnet.com/article/intel-cpus-impacted-by-new-zombieload-side-channel-attack/">Zombieload</a> and <a href="https://www.zdnet.com/article/all-intel-chips-open-to-new-spoiler-non-spectre-attack-dont-expect-a-quick-fix/">Spoiler</a> CPU vulnerabilies.</p>
    </article>
  </body>
</html>