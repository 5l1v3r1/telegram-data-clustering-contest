<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8"/>
    <meta property="og:url" content="https://tjournal.ru/tech/126318-polzovatel-habra-rasskazal-kak-vzlomal-wi-fi-v-sapsane-i-poluchil-dostup-k-dannym-passazhirov"/>
    <meta property="og:site_name" content="TJ"/>
    <meta property="article:published_time" content="2019-11-17T12:48:21+00:00"/>
    <meta property="og:title" content="Пользователь «Хабра» рассказал, как взломал Wi-Fi в «Сапсане» и получил доступ к данным пассажиров"/>
    <meta property="og:description" content="Он успел сделать это за одну поездку от скуки из-за отсутствия интернета."/>
  </head>
  <body>
    <article>
      <h1>Пользователь «Хабра» рассказал, как взломал Wi-Fi в «Сапсане» и получил доступ к данным пассажиров</h1>
      <address><time datetime="2019-11-17T12:48:21+00:00">17 Nov 2019, 12:48</time> by <a rel="author">Дамир Камалетдинов</a></address>
      <p>Он успел сделать это за одну поездку от скуки из-за отсутствия интернета.</p>
      <figure>
        <img src="https://leonardo.osnova.io/8f397748-e5f4-3e00-3de0-5e91680ecc06/"/>
      </figure>
      <p>Пользователь «Хабра» под псевдонимом keklick1337 <a href="https://habr.com/ru/post/476034/">рассказал</a>, как взломал Wi-Fi в «Сапсане» пока ехал из Санкт-Петербурга в Москву. Как оказалось, на сервере скоростного поезда хранится информация обо всех текущих и прошлых рейсах.</p>
      <h3>Взлом Wi-Fi от скуки</h3>
      <p>Keklick1337 рассказал, что ехал в Москву с конференции по информационной безопасности ZeroNights, на которой не было «интересных задач». Ему быстро наскучило читать книгу, и он решил поработать. Но в пути он часто ловил только 2G-интернет, которого не хватало, даже чтобы подключиться к почте.</p>
      <blockquote>Я решил подключиться к местному Wi-Fi «Сапсана». Делал я это впервые! Ну так вот, он попросил меня ввести номер вагона, места и последние 4 цифры паспорта для авторизации, и тут меня уже немного заинтересовало, что же я могу сделать с этой сеткой Сапсана, но всё же в приоритете были пентест-задачи по работе.</blockquote>
      <p>Из-за плохого соединения пользователь так и не поработал и собирался вернуться к книге, но попробовал взломать «Сапсан». Он отметил, что раз для авторизации в Wi-Fi нужно вводить цифры паспорта и номер места с вагоном, то поезд хранит у себя данные обо всех пассажирах.</p>
      <p>Пользователь решил выяснить, насколько трудно получить к ней доступ. Оказалось, для этого достаточно просканировать сеть и использовать пару публичных эксплоитов.</p>
      <h3>Как произошёл взлом</h3>
      <p>Сначала Keklick1337 просканировал сеть «Сапсана» с помощью утилиты nmap с параметрами -v -A. Он обнаружил множество сервисов с открытыми портами и отметил, что такой «взлом» занял 20 минут — и то, потому что сервер «Сапсана» глючил.</p>
      <figure>
        <img src="https://leonardo.osnova.io/b87f4055-50e3-62bc-587d-0de4585ce0a4/"/>
        <figcaption>Лишь часть открытых портов в сети «Сапсана»<cite>Скриншот пользователя «Хабра» Keklick1337​</cite></figcaption>
      </figure>
      <p>Пользователь решил зайти на каждый сервис по отдельности. Вскоре он понял, что в «Сапсане» всё работает на одном сервере, на котором установлен Docker — среда для управления и развёртывания контейнерных приложений.</p>
      <figure>
        <img src="https://leonardo.osnova.io/341708ba-6b15-86f0-a232-d41a11baf0ef/"/>
      </figure>
      <figure>
        <img src="https://leonardo.osnova.io/972c571a-0e6e-aeaa-d76a-58eb3eacb10b/"/>
      </figure>
      <p>После этого Keklick1337 зашёл в cAdvisor — утилиту для мониторинга ресурсов и удивился показателям. Оперативная память сервера была загружена на 96% — вероятно, из-за этого он и глючил.</p>
      <slideshow>
        <figure>
          <img src="https://leonardo.osnova.io/96bf2457-f9b5-6b59-5692-67e1c72da5b4/-/resize/680/"/>
        </figure>
        <figure>
          <img src="https://leonardo.osnova.io/d215af4c-915b-6bd5-637d-dac6e8e54078/-/resize/680/"/>
        </figure>
      </slideshow>
      <p>Пользователь изучил содержимое контейнеров и с помощью публичных эксплоитов попал в файловую систему. Он пояснил, что у «Сапсана» установлены простые пароли, а по ssh можно получить доступ к Root.</p>
      <figure>
        <img src="https://leonardo.osnova.io/d999bdf0-03f5-d868-eb39-9164704bf878/"/>
      </figure>
      <p>В базе данных на диске «Сапсана» нашлась информация обо всех пассажирах текущего и прошлых рейсов. Кроме того, там оказался VPN в сеть РЖД. Однако больше всего пользователя удивило, что компания не стала покупать сертификат шифрования для HTTPS, а воспользовалась бесплатным Let's Encrypt.</p>
      <figure>
        <img src="https://leonardo.osnova.io/870f618b-313b-2259-b81b-b2b3330cced3/"/>
      </figure>
      <p>Keklick1337 пришёл к выводу, что в «Сапсанах» всё настроено «ужасно». По его словам, везде используют одни и те же пароли, а данные хранят в текстовых документах.</p>
      <p>Пользователь не опубликовал данные авторизации, одинаковые для всех «Сапсанов». Он пояснил, что несколько лет назад уже обращался в РЖД с уязвимостью, но ему не выплатили вознаграждения и просто исправили ошибку.</p>
      <p>Keklick1337 призвал компанию исправить уязвимости и пообещал проверить их ещё раз через пару месяцев. Заодно он напомнил всем пассажирам «Сапсана», что их данные находятся под угрозой.</p>
      <blockquote>Все, кто подключён к их Wi-Fi, подвержены снифу [перехвату] трафика. Так как всё идёт через их прокси, можно легко собирать HTTP-трафик, но если чуть постараться, то и [зашифрованный] HTTPS (проверенно). К данным пассажиров рейса получить доступ не составляет труда, и занимает это от силы 20 минут.</blockquote>
      <p>Редакция TJ обратилась к РЖД за комментарием по ситуации, но пока не получила ответа.</p>
    </article>
  </body>
</html>