<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8"/>
    <meta property="og:url" content="https://kod.ru/vzlom-sapsana-za-20-minut/"/>
    <meta property="og:site_name" content="Код Дурова"/>
    <meta property="article:published_time" content="2019-11-17T14:05:45+00:00"/>
    <meta property="og:title" content="На взлом Wi-Fi-сети «Сапсана» и получение данных о пассажирах ушло 20 минут"/>
    <meta property="og:description" content="Один из пользователей «Хабра» с ником keklick1337 поделился своим опытом взлома публичной Wi-Fi-сети «Сапсана»."/>
  </head>
  <body>
    <article>
      <h1>На взлом Wi-Fi-сети «Сапсана» и получение данных о пассажирах ушло 20 минут</h1>
      <address><time datetime="2019-11-17T14:05:45+00:00">17 Nov 2019, 14:05</time> by <a rel="author">Kirill Sergeev</a></address>
      <p>Один из пользователей «Хабра» с ником keklick1337 <a href="https://habr.com/ru/post/476034/">поделился</a> своим опытом взлома публичной Wi-Fi-сети «Сапсана». Ему понадобилось всего 20 минут, чтобы получить доступ к данным пассажиров.</p>
      <figure>
        <img src="https://kod.ru/content/images/2019/11/image-175.png"/>
      </figure>
      <p>По словам keklick1337, он ехал из Петербурга в Москву и решил попробовать подключиться к Wi-Fi поезда от скуки:</p>
      <blockquote>Я решил подключиться к местному Wi-Fi «Сапсана». Делал я это впервые! Ну так вот, он попросил меня ввести номер вагона, места и последние 4 цифры паспорта для авторизации, и тут меня уже немного заинтересовало, что же я могу сделать с этой сеткой Сапсана, но всё же в приоритете были пентест-задачи по работе.</blockquote>
      <p>Поработать у пользователя так и не вышло, так как в интернет выйти не удалось, а вот взломать внутреннюю сеть поезда получилось. Для этого ему понадобилось просканировать сеть и использовать пару публичных экплоитов. Сначала он воспользовался утилитой <b>nmap</b> с параметрами <b>-v -A</b> и обнаружил множество серверов с открытыми портами. Такой взлом занял у него 20 минут, при условии, что сервер «Сапсана» все это время работал нестабильно.</p>
      <figure>
        <img src="https://kod.ru/content/images/2019/11/image-176.png"/>
        <figcaption>Часть открытых портов «Сапсана»</figcaption>
      </figure>
      <p>keklick1337 определил, что в «Сапсане» все работает на одном сервере, причем его оперативная память загружена на 96%. Вероятно, из-за этого сервер и глючит. Кроме того, у «Сапсана» установлены простые пароли, через ssh можно получить доступ к root, а многие конфиденциальные данные хранятся в простых текстовых документах.</p>
      <figure>
        <img src="https://kod.ru/content/images/2019/11/image-177.png"/>
        <figcaption>Файловая система «Сапсана»</figcaption>
      </figure>
      <p>Оказалось, что в базе данных на диске «Сапсана» хранится информация обо всех пассажиров текущего и прошлых рейсов, есть и VPN в сеть «РЖД». При этом компания такого уровня не использует сертификат шифрования для HTTPS, а пользуется бесплатным Let's Encrypt.</p>
      <figure>
        <img src="https://kod.ru/content/images/2019/11/image-178.png"/>
        <figcaption>Let's Encrypt вместо сертификата для HTTPS</figcaption>
      </figure>
      <p>Keklick1337 призвал «РЖД» исправить текущую ситуацию и пообещал проверить плоды их работы через пару месяцев. Также он предупредил пользователей, что все, кто подключен к их Wi-Fi-сети, подвержены перехвату трафика, причем не только HTTP, но и HTTPS. А доступ к личным данным пассажиров можно получить за 20 минут.</p>
    </article>
  </body>
</html>