<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8"/>
    <meta property="og:url" content="https://dou.ua/lenta/articles/security-sandwich/"/>
    <meta property="og:site_name" content="ДОУ"/>
    <meta property="article:published_time" content="2019-11-15T13:00:00+00:00"/>
    <meta property="og:title" content="Security Sandwich: инструкция по приготовлению"/>
    <meta property="og:description" content="Готовим Security Sandwich правильно: определяем, что и от кого защищаем; разрабатываем и внедряем; тестируем. Таня Зинченко, Lead QA Engineer, рассказывает о том, что такое бутерброд безопасности и как нужно его есть, чтобы не подавиться."/>
  </head>
  <body>
    <article>
      <h1>Security Sandwich: инструкция по приготовлению</h1>
      <address><time datetime="2019-11-15T13:00:00+00:00">15 Nov 2019, 13:00</time> by <a rel="author" href="https://dou.ua/users/vestfalka/" target="_blank">Tanja Zinchenko</a></address>
      <p>Привет! Меня зовут Таня, и я все еще тестировщик. За то время, что мы с вами не виделись, я успела основать митап QA Amsterdam и дать интервью о том, как докатилась до такой жизни. А сегодня я хочу рассказать о Security Sandwich.</p>
      <p>Кот Матроскин говорил, что бутерброд лучше есть маслом вниз: так вкуснее. О том, что такое бутерброд безопасности и как нужно его есть, чтобы не подавиться, эта статья.</p>
      <h3>Что же представляет из себя классический бутерброд безопасности</h3>
      <p><b>Начальная стадия</b>, включающая в себя требования к безопасности, обновление инфраструктуры, соглашения и принципы реализации.</p>
      <p><b>Разработка</b>, включающая внедрение этого добра в итеративную аджайл-методологию, инсайты, основные элементы, постоянные требования и пересмотр.</p>
      <p><b>Go-Live-стадия</b>, включающая код ревью и тестирование на проникновение.</p>
      <h3>Начальная стадия: все хотят от чего-то защититься. Но от чего?</h3>
      <p>Прежде чем начинать делать что-то в этом направлении, хорошо бы подумать над тем, <b>что</b> мы защищаем и <b>от кого</b>. И тогда мы получим правильный ответ на вопрос, <b>как</b> защищаться.</p>
      <p>Например, компания, в которой я работаю, — это платежный провайдер. Мы храним безумное количество данных о транзакциях, которые совершаются по всему миру ежеминутно. Мы знаем почти все, даже какие трусы и где вы купили. Разве что я не смогу узнать, покупали ли вы оружие и порнографию, потому что мы не сотрудничаем с такими мерчантами.</p>
      <p>Но в целом, если кто-то получит доступ к нашим данным, то он получит все. Включая номера кредиток, имя и домашний адрес. И покупки, конечно же.</p>
      <p>Поэтому ответ на вопрос, <b>что</b> мы защищаем, — конфиденциальность наших клиентов и свою репутацию. В случае взлома последствия будут для нас слишком тяжелыми. Скорее всего, компания этого не переживет.</p>
      <p><b>От кого</b>. Враг может быть как внешним (взломщики всех мастей), так и внутренним (например, обиженный сотрудник).</p>
      <p><b>Как</b> мы защищаемся — военная тайна, конечно же. Но попытки получить доступ к информации у нас происходят постоянно. Из самых безобидных, о которых можно рассказать, — фишинг. Чаще всего это рассылка писем всем сотрудникам компании. Фантазия и осведомленность взломщиков не знает границ. Я всерьез восхищаюсь тщательностью работы, которую взломщики проводят перед тем, как отправить то или иное письмо.</p>
      <p>Например, пару месяцев назад они отправляли e-mail в стиле «Привет! Сижу на совещании, не могу говорить, срочно пришли такую-то информацию. Рудольф». Отправлено с айфона.</p>
      <p>Вроде бы ничего такого, вот только указанный Рудольф — это наш СЕО. Он в тот момент действительно сидел на совещании, и он действительно время от времени присылает с совещаний такие письма, используя свой айфон.</p>
      <p>Когда мы выяснили вот это все, то решили определить стоимость провала: во сколько нам обойдется то, что мы «профакапим» то или иное действие. Обычно это оценивается с точки зрения вероятности, критичности и рисков.</p>
      <figure>
        <img src="https://s.dou.ua/storage-files/image1_lTsR6uF.png"/>
      </figure>
      <h3>Итак, что у нас должно быть результатом работы на первом этапе</h3>
      <p><b>Цели безопасности</b>: определен круг запросов от бизнеса, юристов и регулятивный контекст (какие законы должны соблюдаться и пр.).</p>
      <p><b>Сценарий</b> «А что, если?..»: что произойдет, если наши поставленные цели будут нарушены?</p>
      <p><b>Риски возникновения:</b> берутся исходя из собственного опыта, или аналогичного происшествия у конкурентов, или из законодательных актов.</p>
      <h3>Разработка: когда же «происходит» безопасность</h3>
      <p>Традиционно путь к продакшену включает:</p>
      <ul>
        <li>обсуждения (вербализацию функциональности);</li>
        <li>требования (перенос того, что нам нужно, в эпики);</li>
        <li>анализ (разделение эпиков на User Stories);</li>
        <li>разработку (User Stories становятся функционалом);</li>
        <li>тестирование (поставленный функционал проходит ревью);</li>
        <li>деплоймент (функционал доступен пользователям).</li>
      </ul>
      <p>На этапе <b>анализа</b> мы устанавливаем Definitions of Ready.</p>
      <p>Для этого нам нужно:</p>
      <ul>
        <li>проанализировать имеющиеся активы: что именно мы затронем изменениями, какие новые компоненты будут в этом затрагивании участвовать, насколько критично то, что у нас сейчас есть и как все это вместе повлияет на текущую ситуацию;</li>
        <li>смоделировать угрозы. Эта часть самая интересная. Она базово включает в себя вопросы о том, как мы можем быть взломаны и что будет при этом задето. Но моделирование угроз само по себе — один из моих любимых этапов. Модели бывают простые и известные типа STRIDE, а есть прикольные и замысловатые типа Persona non Grata. Я очень хочу с этой темой выступить на следующем митапе, но перед этим потренироваться. Если вы хотите присоединиться и послушать про моделирование угроз, то приходите на <a href="https://zoom.us/s/833242016">вебинар</a> 27 ноября, в 20.00 (по Киеву) . N. B. Материал будет читаться на английском языке!</li>
        <li>предусмотреть действия при взломах. Смягчить? Перенаправить? Избежать? Или принять?</li>
        <li>предусмотреть обратную связь. Как мы защищались? Как отвечали на взлом? Как восстанавливалась система? Какие у нас могли бы быть альтернативы?</li>
      </ul>
      <p>И конечно, теперь у нас появляется новый долг — security debt, за ним теперь тоже надо тщательно следить.</p>
      <p>На этапе <b>разработки</b> мы облегчаем себе жизнь с помощью автоматизации, а также:</p>
      <ul>
        <li>обращаем внимание на зависимости: действуем на упреждение, поддерживаем их в актуальном состоянии и активно тестируем;</li>
        <li>используем CVE (Common Vulnerabilities and Exposures): списки с уязвимостями постоянно пополняются, и это можно и нужно использовать. Автоматическая настройка сканеров для библиотек и фреймворков никогда не повредит;</li>
        <li>контейнеры: как ни странно, контейнеризация — это не панацея от всех бед. В них тоже есть уязвимости, и хорошо бы настроить и для них автоматическое сканирование.</li>
      </ul>
      <h3>Go-Live: знай свою систему!</h3>
      <p>Вся предварительно проведенная работа была бы бессмысленной, если бы мы не могли увидеть ее результаты. Поэтому после выпуска продукта (или нового функционала) мы обычно:</p>
      <ol>
        <li>Визуализируем текущее состояние системы. Это всяческие метрики и статистика в реальном времени, по одному взгляду на которые можно сделать вывод, хорошо ли все идет. Например, у нас в компании в комнате каждой команды установлены большие мониторы (а у менеджеров их и вовсе по несколько штук), на которые выведены дашборды с метриками системы. В любой момент каждый член команды может достоверно сказать, все ли идет как надо. Для этого достаточно поднять голову и посмотреть на монитор на стене.</li>
        <li>Делаем структурированные и понятные логи. Хорошим тоном тут считается не засовывать логи в стринги, а логировать нормальные, индексируемые данные. В идеале система логирования должна быть легко инспектируемой и коррелировать со всей системой.</li>
        <li>Определяем нормальное и не очень поведение. Мы должны уметь быстро фиксировать, что что-то пошло не так, и иметь стандартную процедуру поведения в таких ситуациях. Например, у нас один раз «кое-что» случилось. Это «кое-что» быстро устранили, но нервов потрепали немало, потому что, во-первых, «кое-что» случилось около полуночи, а во-вторых, процедуры на случай «кое-что» не было. Поэтому действовали по наитию и достаточно хаотично. После устранения «кое-что» провели работу над ошибками и сделали строго определенный регламент поведения на случай повторения, который разослали всем работникам компании: кому звонить первому, кому второму, по каким телефонам, каких клиентов и каким образом информировать и так далее.</li>
        <li>Применяем методологию безопасности Shift Left. Эта (и схожая с ней Shift Right) методология набирает все больше популярности, и вот она доползла до безопасности. Суть ее проста: если мы представим процесс разработки как прямую с планированием в точке ноль и выпуском готового функционала в крайней правой точке, то Shift Left — это сдвиг влево. То есть начинаем делать что-то как можно раньше. Так теперь и с безопасностью: раньше начнешь — меньше потеряешь. Поэтому стоит следить за Security Debt, внедрять коллективную ответственность за дыры безопасности в коде и прочие приятные штуки.</li>
      </ol>
      <h3>В качестве заключения</h3>
      <p>Security Sandwich кажется простой и незамысловатой вещью, тем не менее в процессе постоянно что-то теряется.</p>
      <p>Но, как и с настоящим бутербродом, если убрать нижний слой хлебушка (стадия Go-Live), то весь сыр с колбасой будет постоянно проваливаться вниз, а поддерживать его пальцами практически нереально.</p>
      <p>Когда же убираем верхний слой хлебушка (планирование требований, учет соглашений и пр.), то все вроде бы работает. Но если съесть колбасу с сыром недостаточно быстро, они обветрятся и будет уже не тот кайф.</p>
      <p>Ну а убрав середину (анализ, разработка, тестирование), получим не сэндвич, а вообще какое-то хлебное недоразумение.</p>
      <p>Готовьте ваш Security Sandwich правильно.</p>
      <p>И приятного аппетита!</p>
      <p>Темы: <a href="https://dou.ua/lenta/tags/%D0%B1%D0%B5%D0%B7%D0%BE%D0%BF%D0%B0%D1%81%D0%BD%D0%BE%D1%81%D1%82%D1%8C/">безопасность</a></p>
    </article>
  </body>
</html>