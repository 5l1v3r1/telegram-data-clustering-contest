<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8"/>
    <meta property="og:url" content="https://www.forbes.com/sites/daveywinder/2019/11/23/new-gmail-feature-introduced-with-an-old-security-vulnerability/"/>
    <meta property="og:site_name" content="Forbes"/>
    <meta property="article:published_time" content="2019-11-23T00:00:00+00:00"/>
    <meta property="og:title" content="New Gmail Feature Introduced With An Old Security Vulnerability"/>
    <meta property="og:description" content="Google introduced a new feature to make Gmail more dynamic but missed an old security vulnerability in doing so."/>
  </head>
  <body>
    <article>
      <h1>New Gmail Feature Introduced With An Old Security Vulnerability</h1>
      <address><time datetime="2019-11-23T00:00:00+00:00">23 Nov 2019</time> by <a rel="author">Davey Winder</a></address>
      <figure>
        <img src="https://specials-images.forbesimg.com/imageserve/5dd91764ea103f0006532a72/960x0.jpg?fit=scale"/>
        <figcaption>Google introduced a new feature to make Gmail more dynamic but missed an old security vulnerability ... [+] in doing so<cite>2018 Chesnot</cite></figcaption>
      </figure>
      <p>A recently out of beta feature for Gmail users was designed to make the webmail experience more dynamic and came with little by way of fanfare from Google. Unfortunately, what this new "dynamic email" feature did arrive with was an old security vulnerability. You may not have noticed that your Google Gmail account had started featuring dynamic email from July 2, not least as Google itself didn't make much of a fuss about it. However, dynamic email, or Accelerated Mobile Pages for email (AMP4Email) to be formal, was toggled on by default for most users, nonetheless. One security researcher did notice, thankfully, and found a security problem. A discovery that the Google Vulnerability Reward Program team is said to have described as being "awesome."</p>
      <h3>What does AMP4Email bring to Gmail users?</h3>
      <p>The Accelerated Mobile Pages (AMP) project was announced by Google back in October 2015, designed primarily to improve the performance of the mobile web. The first web pages to be delivered to users of mobile search appeared in February 2016. Within a year, Adobe <a href="https://theblog.adobe.com/google-amp-one-year-later">reported</a> that the top publishers in the U.S. saw 7% of their total traffic, across all devices, delivered through Google AMP. Another year later, on February 13, 2018, Google announced a developer preview of AMP4Email. "This new spec will be a powerful way for developers to create more engaging, interactive, and actionable email experiences," the Google <a href="https://www.blog.google/products/g-suite/bringing-power-amp-gmail/">announcement</a> stated.</p>
      <p>What AMP4EMail brings to the Gmail party is dynamic and engaging content, right there in your inbox. By supporting a subset of the original AMP HTML components, AMP4Email promises dynamic interaction of the kind we are all used to via our smartphone apps but within email messages. Everything from responding to event invitations to completing a questionnaire, entering hotel reservation details, or even searching Pinterest can be done from inside an email message, thanks to AMP4Email. The trouble is, as one security researcher found out, it also introduced the potential to launch a cross-site scripting attack by threat actors.</p>
      <h3>What is the Gmail security vulnerability in question?</h3>
      <p>Michal Bentkowski, the chief security researcher at Securitum, was curious as to the possibility of dynamic content in email opening up the opportunity to inject arbitrary JavaScript code. This kind of cross-site scripting (XSS) vulnerability has been a perennial thorn in the side of secure development. Simply put, an XSS vulnerability enables an attacker to execute malicious scripts within a web application.</p>
      <p>Bentkowski <a href="https://research.securitum.com/xss-in-amp4email-dom-clobbering/">found such an XSS vulnerability</a> in the Gmail AMP4Email implementation, an example of what he refers to as "a real-world exploitation of a well-known browser issue called DOM Clobbering." Document Object Model (DOM) clobbering is an old, legacy feature of web browsers. Here comes the computer science bit, in brief, from the Bentkowski report. Instead of using a function to reference an HTML-created element from JavaScript, this legacy method accesses it by way of a property of the global window object instead. This DOM clobbering can, Bentkowski said, "lead to interesting vulnerabilities if the application makes decisions based on the existence of certain global variables." So the potential was there for an attacker to use malicious code in a dynamic Gmail message that could get executed in the browser when the recipient opened that email.</p>
      <h3>How serious a vulnerability in Gmail is DOM clobbering?</h3>
      <p>Let’s be realistic here; this was never going to have quite the same level of shock and awe from the vulnerability perspective as the recent <a href="https://www.forbes.com/sites/daveywinder/2019/11/19/google-confirms-android-camera-security-threat-hundreds-of-millions-of-users-affected/">Google Camera app security threat</a>, or the intrigue that <a href="https://www.forbes.com/sites/daveywinder/2019/11/02/new-android-security-threat-as-unremovable-malware-infects-45000-phones-so-far/">“unremovable” Android malware</a> brought to the security news table.</p>
      <p>For one thing, the Gmail AMP4Email implementation had plenty of abuse mitigation built-in from the get-go. To send a dynamic message, the sender has to be using Transport Layer Security (TLS) as well as authentication such as DomainKeys Identified Mail (DKIM), Domain-based Message Authentication, Reporting and Conformance (DMARC) and Sender Policy Framework (SPF) for example. AMP itself only allows specific attributes and tags to be used, specifically to mitigate the risk of malicious JavaScript execution. Indeed, the good news is that Bentkowski was unable to get past the content security policy in AMP, which did the job it was intended to. That doesn't mean the vulnerability risk was negated though; as Bentkowski wrote in his report, "maybe someone else will find a way to bypass."</p>
      <p>Google itself certainly took the vulnerability seriously enough to refer to the discovery as “awesome,” according to Bentkowski who reported it using the <a href="https://www.google.com/about/appsecurity/reward-program/">Google Vulnerability Reward Program (VRP)</a> on August 15. Confirmation that it had been fixed was received from Google on October 12. The researcher is understood to have accepted the standard XSS bug bounty payment of $5,000 (£3,895) from Google.</p>
      <p>I have reached out to Google for a statement regarding the vulnerability and will update this article when one arrives with me.</p>
    </article>
  </body>
</html>