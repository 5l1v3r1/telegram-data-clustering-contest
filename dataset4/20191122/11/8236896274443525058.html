<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8"/>
    <meta property="og:url" content="https://www.seonews.ru/analytics/prognoz-konversii-dlya-klyuchevykh-slov-po-kotorym-malo-dannykh-instruktsiya-po-raschetu-v-power-bi/"/>
    <meta property="og:site_name" content="SEOnews"/>
    <meta property="article:published_time" content="2019-11-22T11:20:00+00:00"/>
    <meta property="og:title" content="Прогноз конверсии для ключевых слов, по которым мало данных. Инструкция по расчету в Power BI"/>
    <meta property="og:description" content="Пошаговая инструкция по расчету в Power BI"/>
  </head>
  <body>
    <article>
      <h1>Прогноз конверсии для ключевых слов, по которым мало данных. Инструкция по расчету в Power BI</h1>
      <address><time datetime="2019-11-22T11:20:00+00:00">22 Nov 2019, 11:20</time> by <a rel="author">Алексей Жарий</a></address>
      <p>Прогноз коэффициента конверсии можно рассчитать даже в том случае, если у вас не хватает статистики. <u><a href="https://www.seonews.ru/analytics/kak-rasschitat-veroyatnost-konversiy-esli-statistiki-slishkom-malo-instruktsiya-dlya-nachinayushchikh/">В предыдущей статье</a></u> мы на наглядных примерах показали, как получить прогнозные значения для ключевых слов, которые набрали совсем мало кликов и конверсий. Сегодня мы расскажем, как с помощью тех же формул получить прогноз конверсии в Power BI.</p>
      <h3>Методика и формула расчета</h3>
      <p>Прогнозные значения CR (коэффициента конверсии) мы получаем с помощью многоуровневого пулинга. Благодаря этому методу можно не переживать из-за недостатка статистики: если данных по какой-то сущности (ключевому слову, объявлению, кампании, аккаунту) не хватает, то в расчет берутся показатели для сущности уровнем выше. Например, когда недостаточно статистики по ключевым словам при расчете используются данные соответствующей группы объявлений.</p>
      <p>Напомним формулу расчета прогнозируемого CR для сущностей, по которым нет достаточного объема данных. В нее включаются клики и конверсии для текущей сущности, CR для сущности уровнем выше и степень пулинга, которая в нашем случае приравнивается к единице.</p>
      <figure>
        <img src="https://www.seonews.ru/upload/medialibrary/911/911c37749210f0358bd788af68cf95e2.jpg"/>
      </figure>
      <h3>Еноты снова в деле</h3>
      <p>Как и в первой статье, мы будем рассчитывать прогноз CR на примере интернет-магазина мягких игрушек. В нашем воображаемом магазине продаются только плюшевые слоны и еноты, поэтому семантическое ядро включает 16 ключевых фраз, распределенных по кампаниям «Слоны» и «Еноты». Чтобы рассчитать прогноз для каждого ключевого слова, нам придется сначала определить CR для более высоких сущностей: аккаунта, кампаний и групп признаков.</p>
      <figure>
        <img src="https://www.seonews.ru/upload/medialibrary/2cc/2ccb45134193a51bcd68f4a8babdb5f7.jpg"/>
      </figure>
      <h3>Основные функции Power Query</h3>
      <p>Предполагается, что читатель хотя бы поверхностно знаком с интерфейсом Power BI, языком M для Power Query и языком Dax. Для тех, кто пока не может похвастаться такими знаниями, мы подготовили описание функций Power Query, необходимых для обработки данных и расчета прогноза. Остальные могут смело пропустить эту часть.</p>
      <p>Прежде всего отметим, что в Power Query нельзя редактировать отдельные ячейки по координатам (X,Y), как в Excel. Преобразование происходит на уровне столбцов. А вот опции, которые нам пригодятся:</p>
      <p>1. <i>Use first row as headers</i>. Первая строка загруженной таблицы будет использоваться в качестве источника заголовков.</p>
      <figure>
        <img src="https://www.seonews.ru/upload/medialibrary/9f9/9f923c3913bd63c7841d0c6b0964ec58.png"/>
      </figure>
      <p>2. Выбор типа данных в столбцах.</p>
      <figure>
        <img src="https://www.seonews.ru/upload/medialibrary/330/3301c33b19e499044ab9e0be63b68cea.png"/>
      </figure>
      <p>Вот основные типы данных (про остальные можно узнать <u><a href="https://docs.microsoft.com/ru-ru/power-bi/desktop-data-types">в официальной справке Power BI</a></u>):</p>
      <ul>
        <li><i>Decimal Number</i> (числовые данные с «плавающей» запятой).</li>
        <li><i>Fixed Decimal Number</i> (числовые данные с фиксированной запятой). Обычно этот формат используется в столбцах, которые содержат значения в какой-либо валюте (CPC, CPA, расход, доход и т.д.).</li>
        <li><i>Whole Number</i> (целое число). Этот тип данных предназначен для столбцов с показателями, которые могут выражаться только целыми числами (клики, конверсии, показы).</li>
        <li><i>Text</i> (текстовые данные). Формат подходит для столбцов с названиями кампаний, ключевыми словами, различными статусами, признаками, значениями геотаргетинга и т. п.</li>
      </ul>
      <p>Тип данных можно задавать и для нескольких столбцов сразу. При нажатой клавише <i>CTRL</i> выделите нужные столбцы, затем нажмите правую кнопку мыши и выберите в меню <i>Change Type</i>.</p>
      <p>Иногда при смене типа данных в столбце появляются ошибки. Чаще всего это происходит при работе с показателями из Яндекс.Метрики и Яндекс.Директа, связанными с денежными единицами (расходом, доходом и другими). В этом случае нужно открыть список с типами данных и выбрать пункт <i>Using Locale</i>. Во всплывающем окне задайте тип данных, в нижнем списке <i>English (United States).</i></p>
      <p>3. Переименование столбцов. Опция доступна после двойного клика по заголовку столбца. Задавайте короткие и простые заголовки, которые ясно описывают данные в столбце.</p>
      <figure>
        <img src="https://www.seonews.ru/upload/medialibrary/d2d/d2d272303b64841b7e4e70e502a956f1.png"/>
      </figure>
      <p>4. Округление числовых данных с «плавающей» запятой до нужного разряда. Наведите курсор на столбец, нажмите правую кнопку мыши и выберите <i>Transform — Round — Round. </i>После этого задайте нужное число знаков после запятой.</p>
      <figure>
        <img src="https://www.seonews.ru/upload/medialibrary/23e/23ee705f4e0dd1064548aa6d6794b4ce.png"/>
      </figure>
      <p>5. Добавление нового столбца по заданному правилу. Откройте вкладку <i>Add Column</i> и нажмите на кнопку <i>Custom Column</i>.</p>
      <figure>
        <img src="https://www.seonews.ru/upload/medialibrary/0c3/0c37f9a55ba27f375bee6316a225568f.png"/>
      </figure>
      <p>В загрузившемся окне задайте название столбца и правило, в соответствии с которым будут формироваться значения в новом столбце. В поле <i>Available Columns </i>отображается список уже имеющихся столбцов. Двойной клик по столбцу добавляет его правило.</p>
      <figure>
        <img src="https://www.seonews.ru/upload/medialibrary/d7f/d7f997a9cde27d902b8b5145d957ac42.png"/>
      </figure>
      <p>В нашем примере новый столбец «Кампания-Ключ» будет содержать данные из столбцов «Кампания» и «Ключевое слово», разделенные дефисом.</p>
      <figure>
        <img src="https://www.seonews.ru/upload/medialibrary/19a/19a498fc294937371db9828647bb62c2.png"/>
      </figure>
      <p>6. Разбивка данных в столбце по делителю. Опция используется повсеместно, например, при отделении минус-слов от ключевой фразы. Давайте для примера разделим столбец «Кампания-Ключ», который мы только что создали, на два новых. Наводим курсор на столбец, нажимаем правую кнопку мыши и выбираем <i>Split Column — By Delimiter</i>.</p>
      <figure>
        <img src="https://www.seonews.ru/upload/medialibrary/b43/b43b082d2afa794cdc2198514238fe31.png"/>
      </figure>
      <p>В загрузившемся окне выбираем <i>Custom</i> и прописываем делитель (в нашем случае — дефис). Затем выбираем <i>Left-most delimiter</i> («Делить по самому левому делителю», то есть по первому дефису, который обнаружится в столбце при чтении слева направо). Раскрываем список <i>Advanced Options</i> и задаем <i>None</i> в поле <i>Quote Character</i>. В противном случае кавычки (например, вокруг ключевых слов) просто исчезнут после разделения. Обратите внимание, что сам делитель при разбивке на столбцы пропадает.</p>
      <figure>
        <img src="https://www.seonews.ru/upload/medialibrary/68e/68e92c7cf79d2b1d2ba1f5e1d90c09ba.png"/>
      </figure>
      <p>7. Удаление столбца. Наводим курсор на столбец, нажимаем правую кнопку мыши и выбираем <i>Remove.</i></p>
      <p>8. Дублирование столбца со всеми его значениями. Наводим курсор на столбец, нажимаем правую кнопку мыши и выбираем <i>Duplicate.</i></p>
      <p>9. Добавление условного столбца. Опция позволяет добавлять столбцы, значения в которых определяются на основе значений из других столбцов. Например, можно добавить столбец со значениями «еноты-пилоты» (для ключей, содержащих слово «енот») и «слоники-электроники» (для всех остальных). Открываем вкладку <i>Add Column</i> и нажимаем кнопку <i>Conditional Column</i>. В загрузившемся окне:</p>
      <ul>
        <li>задаем название нового столбца;</li>
        <li>в поле <i>Column Name</i> выбираем столбец, данные которого станут основой для правил;</li>
        <li>в поле <i>Operator</i> выбираем <i>Contains</i> (<i>«Содержит»</i>);</li>
        <li>в поле <i>Value</i> задаем правило для отбора («енот»);</li>
        <li>в поле <i>Output</i> задаем значение, которое будет отображаться в новом столбце при соблюдении правила («еноты-пилоты»);</li>
        <li>в поле <i>Otherwise</i> задаем значение, которое будет отображаться в новом столбце при несоблюдении правила («слоники-электроники»).</li>
      </ul>
      <figure>
        <img src="https://www.seonews.ru/upload/medialibrary/475/475d3b81f07ec7c3386932906f7ea049.png"/>
      </figure>
      <figure>
        <img src="https://www.seonews.ru/upload/medialibrary/d9b/d9b339755d58ecc7e0436acdba356a1e.png"/>
      </figure>
      <figure>
        <img src="https://www.seonews.ru/upload/medialibrary/364/3645128e64d5ef8bcfdd65992ed15bd1.png"/>
      </figure>
      <p>10. Добавление столбца с одновременным выполнением арифметических операций со значениями из других столбцов. К примеру, мы можем создать столбец, в котором будут суммироваться значения столбцов «Клики» и «Конверсии» (на практике такой столбец, конечно, никому не понадобится, но нас интересует, как работает функция). При нажатой клавише <i>CTRL</i> выделите нужные столбцы. Затем откройте вкладку <i>Add Column</i>, нажмите кнопку <i>Standard</i> и выберите нужную операцию. Обратите внимание, что при делении и вычитании важен порядок выделения столбцов. Тип данных во всех столбцах должен быть числовым.</p>
      <figure>
        <img src="https://www.seonews.ru/upload/medialibrary/b2e/b2e49feca048d73b2bd37de9152e08e4.png"/>
      </figure>
      <h3>Создание основной таблицы данных в Power Query</h3>
      <h4>
        <anchor name="_heml8sisu4ox"/>
      </h4>
      <p>Для начала нам нужно импортировать статистику по запросам из Excel:</p>
      <p>1. Открываем Power BI, создаем новый файл в формате pbix и нажимаем в загрузившемся на кнопку <i>Get Data</i>.</p>
      <figure>
        <img src="https://www.seonews.ru/upload/medialibrary/786/786cb763206f34c041f78631311bec18.png"/>
      </figure>
      <p>2. Затем выбираем нужный источник данных (<i>Excel</i>) и загружаем файл в формате .xlsx или .csv (в Power BI можно импортировать данные из множества разных источников, но начинают все обычно с этого).</p>
      <figure>
        <img src="https://www.seonews.ru/upload/medialibrary/e10/e109172bbc4453161309e83eedfb3297.png"/>
      </figure>
      <p>3. В окне <i>Navigator</i> отмечаем лист, на котором находятся данные, и нажимаем кнопку <i>Edit</i>.</p>
      <figure>
        <img src="https://www.seonews.ru/upload/medialibrary/5d8/5d87a9dc48ee206ea9ae45aa960f7db4.png"/>
      </figure>
      <p>4. Наша таблица откроется в Power Query — инструменте для загрузки и преобразования данных. Теперь нужно задать правильный тип данных для каждого из столбцов. После этого нажимаем кнопку <i>Close and Apply</i> и переходим из Power Query в Power Pivot.</p>
      <figure>
        <img src="https://www.seonews.ru/upload/medialibrary/4ac/4acf34a683cec357b018bdba3b844962.png"/>
      </figure>
      <h3>Расчет фактического CR в Power Pivot</h3>
      <p>Начнем с небольших пояснений для тех, кто не знаком с интерфейсом Power BI. На скриншоте ниже отмечены:</p>
      <ol>
        <li>Загруженные данные с указанием столбцов.</li>
        <li>Список доступных визуализаций.</li>
        <li>Значения, которые используются в выбранной визуализации.</li>
        <li>Кнопка форматирования визуализаций.</li>
        <li>Кнопка перехода в интерфейс Power Query.</li>
      </ol>
      <p>В левой части интефейса находятся кнопки <i>Report, Data</i> и<i> Model. Report</i> — это и есть наш отчет, в котором мы выводим и визуализируем данные. <i>Data </i>— данные, загруженные из Power Query. <i>Model </i>— вкладка, на которой можно связывать таблицы друг с другом (в нашем случае она не понадобится).</p>
      <figure>
        <img src="https://www.seonews.ru/upload/medialibrary/ccb/ccb317090f85c777a7f3395e6d9c40c1.png"/>
      </figure>
      <p>Теперь подготовим таблицу для дальнейшей работы:</p>
      <p>1. Выбираем визуализацию <i>Table</i> и перетаскиваем нужные столбцы в <i>Values</i> (либо отмечаем соответствующие чек-боксы).</p>
      <figure>
        <img src="https://www.seonews.ru/upload/medialibrary/24d/24d28876ee5b328f5f878f506b482832.png"/>
      </figure>
      <p>2. Расставляем столбцы в таблице в правильном порядке, перемещая их названия внутри <i>Values</i>.</p>
      <figure>
        <img src="https://www.seonews.ru/upload/medialibrary/d80/d8001d13e1ec6f7600abeab8e4cdf987.png"/>
      </figure>
      <p>3. Чтобы добавить в таблицу фактический CR, открываем вкладку <i>Modeling</i> и нажимаем кнопку <i>New Measure</i>.</p>
      <figure>
        <img src="https://www.seonews.ru/upload/medialibrary/801/801546447f25cef5f818846b2942de22.png"/>
      </figure>
      <p>4. Загрузится строка для ввода формулы. Это поле лучше развернуть, поскольку чаще всего формула состоит из нескольких строчек.</p>
      <figure>
        <img src="https://www.seonews.ru/upload/medialibrary/528/5281f972540429e66e0f3b1be778059d.png"/>
      </figure>
      <p>5. Задаем формулу для расчета CR:</p>
      <figure>
        <img src="https://www.seonews.ru/upload/medialibrary/2f0/2f00ba045a44c36de8e8dd9328142a07.jpg"/>
      </figure>
      <p>6. Результаты расчетов появятся в списке загруженных данных (на первом месте, поскольку название меры мы прописали с нижнего подчеркивания). Чтобы добавить столбец с фактическим CR в таблицу, перетащим его в <i>Values.</i></p>
      <figure>
        <img src="https://www.seonews.ru/upload/medialibrary/ab4/ab4ecb5e4417623d75be06217e1a26f4.png"/>
      </figure>
      <p>7. Чтобы фактический CR отображался в процентном формате, выделим меру (вокруг нее должна появиться желтая рамка), откроем вкладку <i>Modeling</i> и нажмем кнопку <i>%.</i></p>
      <figure>
        <img src="https://www.seonews.ru/upload/medialibrary/d0c/d0cbe85e73c2856a556d2714330d62da.png"/>
      </figure>
      <h3>Загрузка данных о признаках ключевых слов в Power Query</h3>
      <p>Чтобы получить прогноз CR для отдельных ключевых слов, нам нужно рассчитать этот показатель для групп, включающих фразы с определенным набором признаков. Напомню, что мы разделили все ключевые слова по двум признакам: указанию на цвет («Цвет») и интересу к покупке («Коммерц»). Теперь нам нужно:</p>
      <p>1. Нажать на кнопку <i>Edit Queries</i>, чтобы вернуться в Power Query, и загрузить файл с разбивкой ключевых фраз по признакам.</p>
      <figure>
        <img src="https://www.seonews.ru/upload/medialibrary/15f/15f8dcb26c9434aa7fc5415cb3157581.png"/>
      </figure>
      <p>2. В меню <i>Queries</i> отобразятся две таблицы: одна с данными по кликам и конверсиям для каждой из фраз («data») и вторая, содержащая признаки ключевых слов («Priznaki»).</p>
      <figure>
        <img src="https://www.seonews.ru/upload/medialibrary/0a7/0a706bb6c497a4b8027c0f1f93d21540.png"/>
      </figure>
      <p>3. Чтобы добавить признаки в «data», выберем эту таблицу в меню <i>Queries</i>, откроем вкладку <i>Home</i> и нажмем кнопку <i>Merge queries</i>.</p>
      <figure>
        <img src="https://www.seonews.ru/upload/medialibrary/186/186783d0a60e6adba5785252317dabc6.png"/>
      </figure>
      <p>4. В окне <i>Merge</i> выбираем связуемые столбцы в обеих таблицах («Ключевое слово») и нажимаем кнопку <i>ОК</i>.</p>
      <figure>
        <img src="https://www.seonews.ru/upload/medialibrary/df4/df4903d0ec12429e996b9631614f8dd0.png"/>
      </figure>
      <p>5. В таблице с данными о кликах и конверсиях появился новый столбец «Priznaki». Нажимаем кнопку рядом с его названием и выбираем столбцы, которые нужно добавить из таблицы «Priznaki» в таблицу «data».</p>
      <figure>
        <img src="https://www.seonews.ru/upload/medialibrary/fc3/fc3abc51f5882d48add16b49832a4027.png"/>
      </figure>
      <p>6. В «data» появились столбцы «Цвет» и «Коммерц», которые теперь нужно объединить в столбец «Все признаки». Открываем вкладку <i>Add Column</i> и нажимаем кнопку <i>Custom Column</i>. Затем задаем название нового столбца и правило, по которому в нем будут формироваться значения. Чтобы задать правило, выбираем в поле <i>Available columns</i> столбец «Коммерц», прописываем <i>&amp;” “&amp;</i>, выбираем столбец «Цвет» и нажимаем <i>ОК</i>.</p>
      <figure>
        <img src="https://www.seonews.ru/upload/medialibrary/11b/11b61cb9d6b8f77f450f834bc650d933.png"/>
      </figure>
      <p>7. В таблице появляется столбец «Все признаки». Столбцы «Цвет» и «Коммерц» можно удалить.</p>
      <figure>
        <img src="https://www.seonews.ru/upload/medialibrary/18f/18f87b98b52d691e7677f94ac13bdfd2.png"/>
      </figure>
      <p>8. Теперь нужно сделать так, чтобы запрос «Priznaki» не подгружался, ведь данные по признакам мы уже подтянули и никакой необходимости во втором запросе нет (однако удалять его нельзя, поскольку данные из «Priznaki» используются в главной таблице «data»). Чтобы отключить загрузку, в списке <i>Queries </i>выберите «Priznaki», нажмите правую кнопку мыши и снимите галочку с <i>Enable Load</i>.</p>
      <p>9. Наконец-то все готово! Нажимаем кнопку <i>Close and Apply</i>, выходим из Power Query и возвращаемся в Power Pivot.</p>
      <h3>Расчет прогнозных значений CR в Power Pivot</h3>
      <p>Итак, мы вышли на финишную прямую:</p>
      <p>1. В списке загруженных данных теперь отображается столбец «Все признаки». Добавим его в нашу таблицу, а заодно удалим столбцы «Ключевое слово» и «Кампания». Таблица станет меньше, статистика кликов и конверсиям агрегируется для каждой группы признаков.</p>
      <figure>
        <img src="https://www.seonews.ru/upload/medialibrary/79a/79a966cfbc59bbfb9bf27d345f9632a7.png"/>
      </figure>
      <p>2. Откроем меню <i>Data</i> и добавим в таблицу столбцы «@Клики (аккаунт)», «@Конверсии (аккаунт)», «@Клики (кампания)», «@Конверсии (кампания)», «@Клики (признаки)» и «@Конверсии (признаки)». Чтобы добавить новый столбец, открываем вкладку <i>Modeling</i>, нажимаем кнопку <i>New Column</i> и вводим нужную формулу.</p>
      <figure>
        <img src="https://www.seonews.ru/upload/medialibrary/dad/dad42a22285050ee60dece243f30770e.jpg"/>
      </figure>
      <p>3. В таблице отобразится суммарное количество кликов и конверсий для каждой из сущностей (аккаунт, кампания, признаки), к которой принадлежит конкретное ключевое слово.</p>
      <figure>
        <img src="https://www.seonews.ru/upload/medialibrary/a9a/a9a3087395b4b89264796fd92282c0a6.png"/>
      </figure>
      <p>4. Чтобы рассчитать прогноз CR по схеме, которая описана в прошлой статье, добавляем в таблицу столбцы «@Прогн. CR (аккаунт → кампания)», «@Прогн. CR (кампания → признаки)», «@Прогн. CR (признаки → ключевое слово)» и задаем соответствующие формулы.</p>
      <figure>
        <img src="https://www.seonews.ru/upload/medialibrary/911/911c5df3ccc8b926f11245fbef9bd824.jpg"/>
      </figure>
      <p>5. Последняя формула позволяет нам получить заветные показатели — прогнозы коэффициента конверсии для каждого ключевого слова. Чтобы корректно оформить полученные результаты, вернемся в <i>Reports</i> и выберем среди вариантов визуализации таблицу.</p>
      <figure>
        <img src="https://www.seonews.ru/upload/medialibrary/4f2/4f270e7e3b65e993b844f3fcbbc1a912.png"/>
      </figure>
      <p>6. Добавим в таблицу нужные нам столбцы: «Ключевое слово», «Клики», «Конверсии», «_CR» и «@Прогн. CR (признаки → ключевое слово)».</p>
      <figure>
        <img src="https://www.seonews.ru/upload/medialibrary/a38/a38b406fede56e9f32179de71272807c.png"/>
      </figure>
      <p>7. Чтобы прогноз CR отображался в процентном формате, выделим название столбца, откроем вкладку <i>Modeling</i> и нажмем кнопку <i>%.</i></p>
      <figure>
        <img src="https://www.seonews.ru/upload/medialibrary/f2e/f2e84cce946adf7cdaf573ad3bdaab55.png"/>
      </figure>
      <p>8. Теперь уберем сумму значений из столбца «@Прогн. CR (признаки → ключевое слово)». </p>
      <figure>
        <img src="https://www.seonews.ru/upload/medialibrary/6b7/6b706bec86d940dcde123506e677a34c.PNG"/>
      </figure>
      <h3>Вместо заключения</h3>
      <p>Мы получили таблицу с прогнозом CR для каждого ключевого слова в семантическом ядре. В том числе для фраз, у которых фактический CR нерепрезентативен из-за недостатка статистики или вообще отсутствует, поскольку нет ни одной конверсии. Теперь мы можем оптимизировать наши кампании: сократить расходы на запросы, у которых прогнозируется низкий CR, и увеличить ставки для фраз, сулящих хорошую конверсию.</p>
      <figure>
        <img src="https://www.seonews.ru/upload/medialibrary/25a/25aba51c9463e11a64cc1c0db9ec1aad.png"/>
      </figure>
    </article>
  </body>
</html>