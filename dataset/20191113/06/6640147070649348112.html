<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8"/>
    <meta property="og:url" content="https://www.tomshw.it/hardware/tsx-asynchronous-abort-taa-vulnerabilita-cpu-intel/"/>
    <meta property="og:site_name" content="Tom's Hardware"/>
    <meta property="article:published_time" content="2019-11-13T06:39:00+00:00"/>
    <meta property="og:title" content="TSX Asynchronous Abort (TAA), una nuova falla per le CPU Intel"/>
    <meta property="og:description" content="Le CPU Intel con supporto alle istruzioni TSX sono affette da una vulnerabilità chiamata TSX Asynchronous Abort (TAA). Coinvolte anche le ultime CPU basate sul progetto &quot;Cascade Lake&quot;."/>
  </head>
  <body>
    <article>
      <h1>TSX Asynchronous Abort (TAA), una nuova falla per le CPU Intel</h1>
      <address><time datetime="2019-11-13T06:39:00+00:00">13 Nov 2019, 06:39</time> by <a rel="author">Manolo De Agostini</a></address>
      <p>Attacchi come <b>Spectre, Meltdown e </b><b>le </b><b>molteplici varianti </b>emerse hanno dimostrato come anche i <b>microprocessori</b> – e più in generale l’hardware nei nostri computer – possano avere delle vulnerabilità di sicurezza che consentono <b>l’accesso a</b><b> informazioni sensibili</b> da parte di malintenzionati.</p>
      <p>Le aziende del settore hanno affrontato la situazione offrendo un mix di aggiornamenti (microcode, firmware, sistema operativo, ecc.) per più generazioni di piattaforme, ma a quanto pare il pericolo è sempre dietro l’angolo, come <a href="https://www.tomshw.it/hardware/falle-cpu-intel-sviluppatore-linux-problema-attuale/">ribadito solo poche settimane fa</a>, e oggi ne abbiamo purtroppo la conferma.</p>
      <figure>
        <img src="https://www.tomshw.it/images/images/2019/10/intel-core-x-cascade-lake-x-55487.768x432.jpg"/>
      </figure>
      <p>In queste ore sono emerse <b>nuove varianti di attacchi noti</b>, come ZombieLoad o RIDL (a cui Intel si riferisce come <a href="https://www.tomshw.it/hardware/intel-mds-microarchitectural-data-sampling/">Microarchitectural Data Sampling, MDS</a>), che <b>colpiscono le piattaforme di Intel </b>fino ai più recenti processori basati sul <b>progetto</b><b> </b><b>Cascade Lake </b><b>(architettura Skylake), </b><b>salvo le CPU che non supportano Intel TSX.</b></p>
      <p>Prima di addentrarci in una lunga spiegazione, dobbiamo sottolineare che <b>non ci sono report di exploit nel mondo reale che utilizzano queste vulnerabilità</b>, il che se non altro può farci stare tutti un po’ più tranquilli. Andiamo con ordine.</p>
      <p>A far emergere il problema che prende il nome di <b>TSX asynchronous abort </b>(<b>TAA</b>) è stato un gruppo di ricercatori appartenenti a vari atenei e centri di ricerca: Vrije Universiteit di Amsterdam, KU Leuven del Belgio, il tedesco Helmholtz Center for Information Security e la Graz University of Technology austriaca. La stessa Intel ha pubblicato una nota in merito visibile <a href="https://blogs.intel.com/technology/2019/11/ipas-november-2019-intel-platform-update-ipu/#gs.foxxnj">a questo indirizzo</a>.</p>
      <p><b>La vulnerabilità </b><b>TSX Asynchronous Abort (TAA) </b><b>è secondo Intel “simile alla</b><b> Microarchitectural Data Sampling (MDS)</b> e affligge gli stessi buffer (store buffer, fill buffer, load port writeback data bus). La condizione TAA, su alcuni processori che usano l’esecuzione speculativa, potrebbe consentire a un utente autenticato di consentire la pontenziale divulgazione di informazioni tramite un side channel con accesso locale”.</p>
      <p>TAA sfrutta però un nuovo meccanismo per l’exploit. Come gli attacchi MDS, anche TAA può esporre dati sia dai core fisici che dai thread logici su processori con tecnologia Hyper-Threading. Nel caso specifico però <b>vengono tirate in ballo le Intel Transactional Synchronization Extensions (Intel TSX)</b>, un’estensione del set di istruzioni x86 che aggiunge il supporto hardware alla memoria transazionale per migliorare le prestazioni con il software multi-thread.</p>
      <p>TSX ha due sottofunzionalità: Restricted Transactional Memory (RTM) e Hardware Lock Elision (HLE). “TSX supporta transazioni atomiche di memoria sia svolte che abortite. In caso di interruzione di Intel TSX, tutte le precedenti scritture di memoria all’interno della transazione vengono ripristinate allo stato precedente all’inizio della transazione”, spiega Intel.</p>
      <p>“Una transazione Intel TSX può essere interrotta <b>in modo sincrono</b>, ad esempio a causa di istruzioni non supportate nelle transazioni. Le transazioni Intel TSX possono essere interrotte anche in <b>modo</b> <b>asincrono</b>, quando un diverso processore logico scrive su una riga della cache che fa parte del set di lettura della transazione o quando la transazione supera il suo spazio di memoria buffer o per altri motivi legati alla microarchitettura”.</p>
      <figure>
        <img src="https://www.tomshw.it/images/images/2018/10/intel-cpu-1825.768x432.jpg"/>
      </figure>
      <p><b>Il problema è</b> che mentre avviene <b>un’interruzione asincrona</b> della transazione, alcuni carichi all’interno della transazione che non sono stati ancora completati potrebbero<b> leggere dati dalle str</b><b>u</b><b>tture microarchitetturali e passare speculativamente tali dati a operazioni dipendenti.</b> “Ciò può causare effetti collaterali, che possono successivamente essere misurati per dedurre il valore dei dati nelle strutture microarchitetturali”, spiega Intel.</p>
      <p>Siamo di fronte ancora a una vulnerabilità side channel in qualche modo legata all’esecuzione speculativa. L’esecuzione speculativa è una tecnica usata dalle CPU moderne per velocizzare i calcoli. I processori possono fare ipotesi dei calcoli successivi che dovrebbero svolgere e preparare già il risultato, al fine di velocizzare l’intero processo.</p>
      <p>Nel caso però tale ipotesi si riveli sbagliata, l’esecuzione viene bloccata e bisogna avviare il corretto percorso di esecuzione in base alle condizioni reali. Questo processo porta la CPU ad ottenere dati arbitrari dai buffer, parti del chip che fanno da collegamento tra i diversi componenti, come il processore e la sua cache.</p>
      <p>I ricercatori hanno dimostrato che è possibile sia manipolare quei buffer per contenere dati sensibili come chiavi crittografiche o password, sia causare accessi alla memoria speculativi interrotti. Di conseguenza è possibile far trapelare le informazioni sensibili dai buffer del chip.</p>
      <p>Più concretamente un malintenzionato <b>può arrivare a quei dati eseguendo un Javascript ad hoc da un sito visitato dal PC che si vuole colpire, ma anche attaccare una macchina virtuale </b>su un server cloud.</p>
      <p><b>Secondo quanto affermato a <a href="https://www.wired.com/story/intel-mds-attack-taa/">Wired</a> dai ricercatori </b>che hanno messo a punto l’attacco TAA, Intel è stata informata di queste nuove varianti di MDS a settembre dello scorso anno, ma l’azienda non ha corretto i problemi nell’arco dei successivi 14 mesi. Praticamente, a detta dei ricercatori, gli sforzi compiuti da Intel per risolvere le falle MDS non sarebbero stati sufficienti.</p>
      <p>“<b>Sapevano che le mitigazioni diffuse a maggio potevano essere superate</b>. Non erano efficaci”, ha commentato Kaveh Razavi, uno dei ricercatori della Vrije Universiteit. “Hanno <b>completamente</b> <b>mancato una variante del nostro attacco, la più pericolosa</b>”. Gli studiosi affermano di essere riusciti a perfezionare la tecnica per arrivare a <b>sottrarre</b><b> dati sensibili in pochi secondi anziché ore o giorni</b> come in precedenza si riteneva necessario.</p>
      <p>Il ricercatore Jonas Theis della Vrije Universiteit ha <b>usato TAA per portare un sistema a rivelare l’hash della password di un amministratore in soli 30 secondi</b>, come mostrato nel video qui sotto. Un malintenzionato dovrebbe comunque craccare quell’hash per ottenere una password usabile, cionondimeno è un problema serio.</p>
      <figure>
        <iframe src="https://www.youtube.com/embed/zaTxBZXE9pQ" width="500" height="281" data-service="Youtube" scrolling="no"/>
      </figure>
      <p><b>Per risolvere le falle MDS Intel ha </b><b>deciso di </b>non impedire ai suoi processori di prendere dati arbitrari dai buffer quando avveniva un accesso di memoria invalido, ma si è limitata a<b> impedire specifiche situazioni che permettevano al dato di fuoriuscire. </b>Così facendo Intel ha lasciato la porta aperta ad alcune varianti.</p>
      <p><b>I</b><b> ricercatori affermano che non sono ancora del tutto sicuri che </b><b>l’</b><b>ampio aggiornamento d</b><b>ei microcode</b><b> che Intel sta rilasciando affronti questi problemi.</b> Il team della Vrije Universiteit ritiene che Intel abbia ora impedito la presenza di dati sensibili in alcuni dei suoi componenti buffer, ma non tutti.</p>
      <p>“<b>Siamo particolarmente preoccupati </b>che il piano di mitigazione di Intel sia orientato sui Proof of Concept (PoC), con una completa mancanza di ingegneria della sicurezza e analisi delle cause alla radice, con lievi variazioni nei PoC che portano a nuovi embarghi e a “nuove” vulnerabilità che rimangono irrisolte per lunghi periodi”, si legge sul <a href="https://mdsattacks.com/#ridl-ng">sito creato dai ricercatori dedicato all’attacco</a>. “Sfortunatamente, fino a quando non vi sarà una sufficiente pressione pubblica / industriale, Intel sembra avere pochi incentivi a cambiare rotta, <b>lasciando al pubblico un falso senso di sicurezza</b>”.</p>
      <p>I ricercatori della Vrije Universiteit quindi ritengono che le misure adottate non siano risolutive e “raccomanda di disattivare l’hyperthreading nei processori Intel. Questo non risolve tutti i problemi, ma elimina i pericoli maggiori”.</p>
      <p><b>Intel ha rilasciato un commento </b><b>ufficiale </b>che riportiamo di seguito: “I ricercatori hanno identificato un nuovo meccanismo, simile al Microarchitectural Data Sampling (MDS) che chiamiamo Transactional Synchronization Extensions (TSX) Asynchronous Abort, o TAA. Questo meccanismo fa affidamento su TSX, e le mitigazioni sono state offerte in un nuovo aggiornamento di microcode abbinato ad aggiornamenti corrispondenti per sistemi operativi e software hypervisor”.</p>
      <p>“<b>Le mitigazioni riducono sostanzialmente la superficie d’attacco potenziale fornendo un mezzo per cancellare i buffer e disabilitare TSX per quei clienti che non usano questa funzione. </b>Continuiamo ad incoraggiare tutti e tenere aggiornati i propri dispositivi, siccome è questo uno dei migliori modi per essere protetti. Ringraziamo i ricercatori che hanno lavorato insieme a noi, e i nostri partner di settore per il loro contributo, per l’annuncio coordinato di questo problema”.</p>
      <p><b>TAA però non è l’unico problema a cui Intel ha dovuto far fronte </b><b>in questi mesi</b><b>. </b>Nel complesso l’azienda dice di aver affrontato 77 vulnerabilità di vario tipo (67 delle quali scoperte da personale di Intel), tra cui un problema chiamato Jump Conditional Code (JCC). Si tratta di un bug che “coinvolge la Decoded ICache della CPU” e la cui risoluzione porterebbe a un impatto prestazionale tra lo 0 e il 4%.</p>
      <h3>Cosa fare per mettersi al sicuro?</h3>
      <p>Utenti comuni e aziende non devono far altro che <b>mantenere aggiornati i propri sistemi</b>: aggiornare i BIOS delle schede madre, i sistemi operativi e i vari software, come i browser che s’interfacciano al web, ma anche hypervisor, macchine virtuali, tutto insomma.</p>
      <p>Come detto dai ricercatori, <b>disabilitare l’Hyper-Threading è una soluzione parziale, e bisogna tener conto che si perdono prestazioni</b> in alcuni scenari. Va inoltre ribadito che non ci sono report di exploit reali che usano queste vulnerabilità, quindi l’ultima soluzione la lasceremmo per il momento come ultima spiaggia.</p>
      <h3>Quali CPU sono coinvolte?</h3>
      <p>Si parla di<b> tutti i processori Intel recenti con supporto TSX, inclusi i processori server Cascade Lake di quest’anno</b>. TAA funziona anche su microarchitetture con mitigazioni hardware per Meltdown e Foreshadow, e su processori che non sono vulnerabili a MDS. Per un quadro complessivo delle falle emerse negli ultimi anni, di come sono state affrontate e delle architetture coinvolte in questo caso specifico, vi rimandiamo a <a href="https://www.intel.com/content/www/us/en/architecture-and-technology/engineering-new-protections-into-hardware.html">questa pagina sul sito di Intel</a>.<b> Sono coinvolte le CPU di altre aziende? Al momento non risulta e difficilmente potrebbero, dato che il problema coinvolge Intel TSX.</b></p>
      <h3>Ci sono rischi di sicurezza seri?</h3>
      <p>Come già scritto, <b>non ci sono al momento report di exploit reali che usano queste vulnerabilità.</b></p>
    </article>
  </body>
</html>