<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8"/>
    <meta property="og:url" content="https://www.zdnet.com/article/iranian-hacking-group-built-its-own-vpn-network/"/>
    <meta property="og:site_name" content="ZDNet"/>
    <meta property="article:published_time" content="2019-11-14T07:00:00+00:00"/>
    <meta property="og:title" content="Iranian hacking group built its own VPN network"/>
    <meta property="og:description" content="Security researchers identify APT33's private network of 21 VPN nodes."/>
  </head>
  <body>
    <article>
      <h1>Iranian hacking group built its own VPN network</h1>
      <address><time datetime="2019-11-14T07:00:00+00:00">14 Nov 2019, 07:00</time> by <a rel="author" href="https://www.zdnet.com/meet-the-team/us/catalin.cimpanu/" target="_blank">Catalin Cimpanu</a></address>
      <p>
        <b>Security researchers identify APT33's private network of 21 VPN nodes.</b>
      </p>
      <figure>
        <img src="https://zdnet4.cbsistatic.com/hub/i/2019/10/03/ec637648-4827-459c-8996-adbbb5cda13a/13954ceaf63a905b0535a5c34133aa20/ddos-globe.jpg"/>
      </figure>
      <p>One of Iran's elite state-sponsored hacking groups has built and has been operating its own private network of VPN nodes, which they've using to connect to hacking infrastructure, perform reconnaissance on future targets, and even casual web browsing, according to research published today by cyber-security firm Trend Micro.<br/><br/>The group, tracked in cyber-security circles under the codename of APT33, is, by far, Iran's most sophisticated hacking unit.<br/><br/>They are the ones who developed the disk-wiping malware known as <a href="https://en.wikipedia.org/wiki/Shamoon">Shamoon</a> (DistTrack) that destroyed over 35,000 workstations at Saudi Arabia's Saudi Aramco in 2012.<br/><br/>Recently, the group has resurfaced with new attacks, primarily targeting the oil and aviation industries, and <a href="https://www.zdnet.com/article/shamoon-malware-destroys-data-at-italian-oil-and-gas-company/">even deploying a new version of the Shamoon malware</a>, late last year.<br/><br/>In 2019, APT33 operations have relied on classic spear-phishing operations and sometimes on the use<a href="https://www.zdnet.com/article/us-cyber-command-issues-alert-about-hackers-exploiting-outlook-vulnerability/"> of a clever Outlook vulnerability</a>.</p>
      <p>Per Trend Micro, confirmed APT33 infections in 2019 include a private American company that offers services related to national security, victims connected to a university and a college in the US, a victim most likely related to the US military, and several victims in the Middle East and Asia.</p>
      <h3>Tracking down APT33's infrastructure</h3>
      <p>But researchers say that while investigating these hacks, they were able to gain insight into how APT33 manages its hacking infrastructure.</p>
      <p>According to researchers, everything is layered and isolated, to keep APT33 operators underneath a cloak of secrecy from incident responders.<br/><br/>Based on a hand-drawn schema shared by Trend Micro researchers, there are four layers between APT33 operators and their targets.</p>
      <ul>
        <li><b>VPN layer</b> -- a custom-built network of VPN nodes to hide the operator's real IP address and location</li>
        <li><b>Bot Controller layer</b> -- an intermediary layer of servers</li>
        <li><b>C&amp;C Backend layer</b> -- the actual backend servers through which the group manages its malware botnets</li>
        <li><b>Proxy layer</b> -- a collection of cloud proxy servers through which C&amp;C (command-and-control) servers hide from infected hosts</li>
      </ul>
      <figure>
        <img src="https://zdnet3.cbsistatic.com/hub/i/2019/11/14/c958a2e7-4195-4d56-b3a8-d3c28cb11006/2ff49f0af7f133ef38cb7e115bb8d780/apt-nfrastructure.jpg"/>
        <figcaption>Image: Trend Micro</figcaption>
      </figure>
      <p>But what stood out to researchers was the fact that APT33 was not using commercial VPN servers to hide their location, as some hacking groups tend to do.<br/><br/>Instead, the group had set up and was operating its own private VPN network.<br/><br/>"Setting up a private VPN can be easily done by renting a couple of servers from data centers around the world and using open source software like OpenVPN," researchers said.</p>
      <h3>APT33's custom VPN network was a big mistake</h3>
      <p>But what APT33 didn't know was that this, actually, made them easier to track. Researchers only had to keep an eye out for a few IP addresses. If APT33 had used a commercial VPN provider's network, then they would have seamlessly melted into all the other legitimate traffic.<br/><br/>"APT33 likely uses its VPN exit nodes exclusively," Trend Micro said. "We have been tracking some of the group's private VPN exit nodes for more than a year, and we have listed known associated IP addresses in the table below."</p>
      <figure>
        <img src="https://zdnet1.cbsistatic.com/hub/i/r/2019/11/14/1c3f32ca-586b-4c90-821e-a71f7732d1d9/resize/370xauto/8968e5a59bf575fab104f60cc3ecf9fa/apt33-vpns.png"/>
        <figcaption>Image: Trend Micro</figcaption>
      </figure>
      <p>But besides connecting to their malware botnet control panels, Trend Micro said that the group had also used the same private VPN exit nodes "for reconnaissance of networks that are relevant to the supply chain of the oil industry."<br/><br/>"More concretely, we have witnessed some of the IP addresses in Table 3 doing reconnaissance on the network of an oil exploration company and military hospitals in the Middle East, and an oil company in the U.S.," researchers said.<br/><br/>"APT33 also has a clear interest in websites that specialize in the recruitment of employees in the oil and gas industry," Trend Micro's team said. "We recommend companies in the oil and gas industry to cross-relate their security log files with the IP addresses listed above."<br/><br/>In addition, Trend Micro said APT33 also used its private VPN network to access websites of penetration testing companies, webmail, websites on vulnerabilities, and cryptocurrency hacking sites.<br/><br/><i>Additional indicators of compromise (IoCs) for APT33's recent hacking operations are available in the Trend Micro report, </i><a href="https://blog.trendmicro.com/trendlabs-security-intelligence/more-than-a-dozen-obfuscated-apt33-botnets-used-for-extreme-narrow-targeting/"><i>here</i></a><i>.</i></p>
    </article>
  </body>
</html>