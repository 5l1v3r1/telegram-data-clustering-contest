<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8"/>
    <meta property="og:url" content="https://www.golem.de/news/ransomware-nextcry-hat-es-auf-nextcloud-installationen-abgesehen-1911-145077.html"/>
    <meta property="og:site_name" content="Golem.de"/>
    <meta property="article:published_time" content="2019-11-19T10:07:01+00:00"/>
    <meta property="og:title" content="Nextcry hat es auf Nextcloud-Installationen abgesehen"/>
    <meta property="og:description" content="Die Ransomware Nextcry verschlüsselt die Daten im Cloudspeicher von Nextcloud-Installationen. Auf den Server gelangt sie nicht über die Nextcloud, sondern über eine bereits"/>
  </head>
  <body>
    <article>
      <h1>Nextcry hat es auf Nextcloud-Installationen abgesehen</h1>
      <h2>Die Ransomware Nextcry verschlüsselt die Daten im <a href="https://www.golem.de/specials/cloud-storage/">Cloudspeicher</a> von <a href="https://www.golem.de/specials/nextcloud/">Nextcloud</a>-Installationen. Auf den Server gelangt sie nicht über die Nextcloud, sondern über eine bereits gepatchte <a href="https://www.golem.de/specials/sicherheitsluecke/">Sicherheitslücke</a> in <a href="https://www.golem.de/specials/php/">PHP</a>.</h2>
      <address><time datetime="2019-11-19T10:07:01+00:00">19 Nov 2019, 10:07</time> by <a rel="author">Moritz Tremmel</a></address>
      <p>Die Ransomware Nextcry hat es auf Nextcloud-Installationen abgesehen und wurde bereits in freier Wildbahn gesichtet. Die Ransomware verschlüsselt die Dateien im Cloudspeicher mit dem Verschlüsselungsalgorithmus AES und löscht Ordner und Dateien, die bei der Wiederherstellung der Daten helfen können. Laut den Nextcloud-Entwicklern soll die Ransomware über eine Sicherheitslücke, die nicht in Nextcloud steckt und bereits geschlossen wurde, auf die Server gelangen. Zuerst hatte das <a href="https://www.bleepingcomputer.com/news/security/new-nextcry-ransomware-encrypts-data-on-nextcloud-linux-servers/">Onlinemagazin Bleepingcomputer berichtet</a>.</p>
      <p>Der Sicherheitsforscher Michael Gillespie untersuchte eine Kopie der Ransomware. Laut Gillespie handelt es sich um ein Pythonscript, welches in eine ausführbare Datei umgewandelt wurde. Gelangt die Ransomware auf den Server, verschlüsselt sie die Nextcloud-Dateien per AES mit einem 256-Bit-Schlüssel, welcher wiederum mit einem in der Ransomware hinterlegten RSA-2048-Bit-Key verschlüsselt wird. Die Ransomware fordert 0,025 Bitcoin - knapp 200 Euro - Lösegeld.</p>
      <h4>Nextcry nutzt bereits gepatchte Sicherheitslücke in PHP-FPM unter NGINX</h4>
      <p>Anfangs war unklar, wie die Ransomware Nextcry auf die Server gelangen konnte. Im Forum von Bleepingcomputer meldeten sich Nutzer, deren Nextcloud-Installationen von der Ransomware befallen waren und die auf den Webserver NGINX setzen. Bleepingcomputer vermutete daher, dass die Ransomware auf eine Sicherheitslücke in dem FastCGI-Prozessmanager PHP-FPM (<a href="https://nvd.nist.gov/vuln/detail/CVE-2019-11043">CVE-2019-11043</a>), der PHP-Anwendungen beschleunigt, im Zusammenspiel mit NGINX setzte. <a href="https://nextcloud.com/blog/urgent-security-issue-in-nginx-php-fpm/">Nextcloud warnte bereits vor einem Monat</a> vor der Sicherheitslücke, die die Standardinstallation von Nextcloud unter NGINX betrifft. Die Lücke wurde im Oktober veröffentlicht und geschlossen.</p>
      <p>Die Nextcloud-Entwickler bestätigten gegenüber Bleepingcomputer, dass diese Lücke das Einfallstor für die Ransomware sei. Mit PHP-FPM ließ sich im Zusammenspiel mit NGINX unter bestimmten Bedingungen Code auf dem Server ausführen. Nextcloud hatte daher bereits im Oktober dringend zu einem Update sowie einer Anpassung der Konfiguration geraten. Nextcloud-Betreiber, die ihre Installation entsprechend angepasst und aktuell halten, sollten daher nicht von Nextcry befallen werden. Gleiches gilt für Installationen, die auf Apache oder einen anderen Webserver setzen oder NGINX ohne PHP-FPM verwenden. <a href="https://nextcloud.com/blog/nextcry-or-how-a-hacker-tried-to-exploit-a-nginx-issue-with-2-nextcloud-servers-out-of-300-000-hit-and-no-payout/">Laut Nextcloud</a> wurde ein Angriff nur bei zwei der über 300.000 Nextcloud-Installationen bekannt.</p>
    </article>
  </body>
</html>