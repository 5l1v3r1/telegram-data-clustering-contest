<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8"/>
    <meta property="og:url" content="https://www.bleepingcomputer.com/news/security/critical-windows-update-spam-fails-at-delivering-ransomware/"/>
    <meta property="og:site_name" content="BleepingComputer"/>
    <meta property="article:published_time" content="2019-11-19T16:00:00+00:00"/>
    <meta property="og:title" content="Critical Windows Update Spam Fails at Delivering Ransomware"/>
    <meta property="og:description" content="A new spam campaign pretending to be a 'Critical Microsoft Windows Update' has been discovered that attempts to deliver the Cyborg Ransomware, but turns out to be an utter failure."/>
  </head>
  <body>
    <article>
      <h1>Critical Windows Update Spam Fails at Delivering Ransomware</h1>
      <address><time datetime="2019-11-19T16:00:00+00:00">19 Nov 2019, 16:00</time> by <a rel="author" href="https://www.bleepingcomputer.com/author/lawrence-abrams/" target="_blank">Lawrence Abrams</a></address>
      <figure>
        <img src="https://www.bleepstatic.com/content/hl-images/2018/07/10/ransomware-header.jpg"/>
      </figure>
      <p>A new spam campaign pretending to be a 'Critical Microsoft Windows Update' has been discovered that attempts to deliver the Cyborg Ransomware, but turns out to be an utter failure.</p>
      <p>In a report from Trustwave that was released today, researchers outline how an attacker is sending spam email that pretends to be a 'Critical' Windows update and prompts the recipient to install it.</p>
      <figure>
        <img src="https://www.bleepstatic.com/images/news/ransomware/c/cyborg/malspam.jpg"/>
        <figcaption>Critical Microsoft Windows Update Spam</figcaption>
      </figure>
      <p>Trustwave told BleepingComputer that this spam campaign was not targeted in nature and was sent to recipients all over the world.</p>
      <p>The supposed Windows update attached to the email is actually a downloader for the Cyborg Ransomware executable that has been renamed to a random named jpg image file.  This is seen by the hex edit of the JPG file that clearly shows it is an executable.</p>
      <figure>
        <img src="https://www.bleepstatic.com/images/news/ransomware/c/cyborg/hex-edit.jpg"/>
        <figcaption>Hex edit of the JPG file</figcaption>
      </figure>
      <p>While this JPG file is a legitimate executable that if properly named would have encrypted computer, the attackers made the mistake of distributing it as a JPG image file.</p>
      <p>By doing so, they failed to take into account that when a user opens this file, Windows will automatically load it into the configured Photo viewer and not execute the malware. This will just display an error stating that the "file appears to be damaged, corrupted, or is too large."</p>
      <figure>
        <img src="https://www.bleepstatic.com/images/news/ransomware/c/cyborg/opens-in-picture-viewer.jpg"/>
        <figcaption>Executable opened in the Photo Viewer</figcaption>
      </figure>
      <p>It is not known why the ransomware was distributed this way, but it ultimately would have prevented any recipients who opened the image from being infected. This is obviously a good mistake.</p>
      <p>When BleepingComputer asked Trustwave their opinion on why the ransomware was distributed this way, they too were confused by use of this method.</p>
      <p>"Frankly, at this stage, we are not sure what the attacker had in mind. It will not run upon a double click. However, it could be run in a command line with Administrator privilege."</p>
      <h3>The Cyborg Ransomware</h3>
      <p>When taking a look at the Cyborg Ransomware we get a better understanding of why the spam campaign didn't go well.</p>
      <p>According to <a href="https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/fake-windows-update-spam-leads-to-cyborg-ransomware-and-its-builder/">Trustwave's report</a>, the Cyborg Ransomware is promoted through a YouTube video that states it is a tool "designed to penetration testing" and should not be used for illegal use.</p>
      <figure>
        <iframe src="https://www.youtube.com/embed/TTRCtWZ8sZw" width="640" height="360" data-service="Youtube" scrolling="no"/>
      </figure>
      <p>This builder is a .NET tool that allows a user to enter a bitcoin address, a contact email, an extension to use for encrypted files, and a ransom amount that the victim needs to pay. The user can then generate a .NET ransomware executable that utilizes these configuration settings.</p>
      <figure>
        <img src="https://www.bleepstatic.com/images/news/ransomware/c/cyborg/cyborg-builder.jpg"/>
        <figcaption>Cyborg Ransomware Builder</figcaption>
      </figure>
      <p>As you can see, this builder is not very sophisticated and when we look at the executable used in this campaign, it also shows a similar level of sophistication.</p>
      <p>The attached executable is actually a downloader that downloads the Cyborg Ransomware component from a now inactive Github repository.</p>
      <p>For many ransomware variants, when a victim is infected, the ransomware will send a notification back to the attacker by connecting to a command and control server.</p>
      <p>With this Cyborg downloader, the attacker uses smtp.gmail.com to email themselves with information about the victim. This executable also has the email user name and password hardcoded into the executable that could allow anyone who examines the email to access the account.</p>
      <figure>
        <img src="https://www.bleepstatic.com/images/news/ransomware/c/cyborg/email-actor.jpg"/>
        <figcaption>Emailing actor about new infection</figcaption>
      </figure>
      <p>While many ransomware creators have called their projects "for educational purposes" or as a "pentesting tool", other people will use these projects for nefarious purposes as we saw saw <a href="https://www.bleepingcomputer.com/news/security/hidden-tear-ransomware-developer-blackmailed-by-malware-developers-using-his-code/">with HiddenTear</a>.</p>
      <p>The good news is that those who use open source ransomware, typically do not do a good job distributing or creating them. This leads to easily decryptable ransomware, or as seen in this case, poor planning in ransomware distribution.</p>
    </article>
  </body>
</html>