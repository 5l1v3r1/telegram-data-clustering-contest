<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8"/>
    <meta property="og:url" content="https://www.zdnet.com/article/android-vulnerability-lets-rogue-apps-take-photos-record-video-even-if-your-phone-is-locked/"/>
    <meta property="og:site_name" content="ZDNet"/>
    <meta property="article:published_time" content="2019-11-19T12:26:30+00:00"/>
    <meta property="og:title" content="Android flaw lets rogue apps take photos, record video even if your phone is locked"/>
    <meta property="og:description" content="Millions of Google and Samsung devices were vulnerable to exploit."/>
  </head>
  <body>
    <article>
      <h1>Android flaw lets rogue apps take photos, record video even if your phone is locked</h1>
      <address><time datetime="2019-11-19T12:26:30+00:00">19 Nov 2019, 12:26</time> by <a rel="author" href="https://www.zdnet.com/meet-the-team/us/charlie-osborne/" target="_blank">Charlie Osborne</a></address>
      <p>
        <b>Millions of Google and Samsung devices were vulnerable to exploit.</b>
      </p>
      <figure>
        <video src="https://techrepublicvideo.cbsistatic.com/vr/2019/11/15/1642614851574/2019-11-15-wochit-malware-attacks-on-hospitals-are-on-the-rise_1977847_742.mp4"/>
      </figure>
      <figure>
        <img src="https://zdnet1.cbsistatic.com/hub/i/r/2019/11/15/5f278576-86a5-42ad-a1ff-a76b637ba49f/thumbnail/570x322/b08d4f69aab4c6c48abee2d796f6e78c/malware-attacks-on-hospitals-are-on-the-5dce7671e970ea0001731ecc-1-nov-15-2019-14-30-49-poster.jpg"/>
      </figure>
      <p>Google and Samsung have confirmed the existence of security vulnerabilities which allow cyberattackers to hijack your phone camera and covertly take pictures or record video -- even if your device is locked. <br/><br/>On Tuesday, Erez Yalon, Director of Security Research at Checkmarx <a href="https://www.checkmarx.com/blog/how-attackers-could-hijack-your-android-camera">disclosed the bugs</a>, tracked overall as <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-2234">CVE-2019-2234</a>, which stem from permission bypass issues.</p>
      <p>The team began an investigation of the security of our smartphones' camera capabilities by exploring the Google Camera app on a Google Pixel 2 XL and Pixel 3, leading to the discovery that they were able to tamper with particular actions and, overall, make it "possible for any application, without specific permissions, to control the Google Camera app." <br/><br/>This included taking photos and recording video, even if the target device was locked or the screen was turned off, or if the victim was in the middle of a phone call -- all of which are potential attack vectors that could lead to surveillance and a serious invasion of privacy. <br/><br/>Checkmarx says that other smartphone vendors making use of the Android operating system, namely Samsung, were also vulnerable. As a result, it is possible that hundreds of millions of end-users could have been susceptible to exploit. </p>
      <p>Google is strict when it comes to mobile applications obtaining access to sensitive information from camera, microphone, or location services. As a result, users must accept permission requests, but in Checkmarx's attack scenario, these requirements are bypassed.  <br/><br/>The Android camera application usually stores images and videos on an SD card, and so for apps to access this content, they require storage permissions. </p>
      <p>"Unfortunately, storage permissions are very broad and these permissions give access to the entire SD card," the researchers note. "There are a large number of applications, with legitimate use-cases, that request access to this storage, yet have no special interest in photos or videos. In fact, it's one of the most common requested permissions observed." <br/><br/><b>See also: </b><a href="https://www.zdnet.com/article/malicious-android-apps-containing-joker-malware-reach-half-a-million-installs-on-google-play/">Malicious Android apps containing Joker malware set up shop on Google Play</a> <br/><br/>It is this set of permissions that the team decided to use as an attack conduit. If a malicious app is granted access to an SD card, it was not only possible to access photos and videos, but the vulnerability ensured that the photo app could be forced to take new images and video content.  <br/><br/>"We could easily record the receiver's voice during the call and we could record the caller's voice as well," the researchers said. "This is not desired behavior, since the Google Camera app should not be allowed to be fully controlled by an external app, circumventing the camera/mic/GPS permissions that the user is trusting the Android OS to enforce." <br/><br/>To make matters worse, as GPS metadata is often recorded and embedded into images, an attacker could theoretically parse this data and gain knowledge of a user's whereabouts.  <br/><br/>A proof-of-concept (PoC) mock weather app has been designed to show that as long as there are basic storage permissions in place, this attack vector is possible. When opened, the app connects to a command-and-control (C2) server and waits for the operator to send commands to take and steal footage. <br/><br/>The PoC app is able to perform the following functions:</p>
      <ul>
        <li>Take a photo on the victim's phone and upload it to the C2</li>
        <li>Record a video on the victim's phone and upload it to the C2</li>
        <li>Parse photos for GPS tags and locate the phone on a global map</li>
        <li>Silence the phone while taking photos and recording videos</li>
        <li>Wait for a voice call -- made possible through the phone's proximity sensor -- and automatically record video from the victim and audio from both sides</li>
      </ul>
      <p>The vulnerability impacts all Google handsets, including those beyond the Pixel product line.  <br/><br/><b>CNET: </b><a href="https://www.cnet.com/news/demonstrators-to-scan-public-faces-in-dc-to-show-lack-of-facial-recognition-laws/?ftag=CMG-01-10aaa1b">Demonstrators scan public faces in DC to show lack of facial recognition laws</a> <br/><br/>Google was informed of the researchers' findings on July 4, 2019, and both the PoC app and an accompanying video were sent a day later. Feedback on Google's belief the security issue was only "moderate" later convinced the tech giant to bump up the issue to a "high" severity problem, and by August 1, Google registered the CVE and confirmed that other vendors were impacted.  <br/><br/>A fix was then released, leading to public disclosure. <br/><br/><b>TechRepublic: </b><a href="https://www.techrepublic.com/article/cybersecurity-remains-the-top-concern-for-middle-market-companies/?ftag=CMG-01-10aaa1b">Cybersecurity remains the top concern for middle market companies</a> <br/><br/>"We appreciate Checkmarx bringing this to our attention and working with Google and Android partners to coordinate disclosure," Google said in a statement. "The issue was addressed on impacted Google devices via a Play Store update to the Google Camera Application in July 2019. A patch has also been made available to all partners." <br/><br/>By August 29, Samsung, one of the affected vendors, confirmed the vulnerability impacted the firm's handsets. <br/><br/>A Samsung spokesperson told ZDNet:</p>
      <blockquote>"Since being notified of this issue by Google, we have subsequently released patches to address all Samsung device models that may be affected. We value our partnership with the Android team that allowed us to identify and address this matter directly."</blockquote>
      <h3>Previous and related coverage</h3>
      <ul>
        <li>
          <a href="https://www.zdnet.com/article/attackers-using-whatsapp-vulnerability-triggered-by-video-files-can-remotely-execute-code/">Attackers using WhatsApp MP4 video files vulnerability can remotely execute code</a>
        </li>
        <li>
          <a href="https://www.zdnet.com/article/android-malware-disguises-as-ad-blocker-but-then-pesters-users-with-ads/">Android malware disguises as ad blocker, but then pesters users with ads</a>
        </li>
        <li>
          <a href="https://www.zdnet.com/article/30-million-android-users-have-installed-malicious-lifestyle-apps/">Malicious lifestyle apps found on Google Play, 30 million installs recorded</a>
        </li>
      </ul>
      <hr/>
      <p><b>Have a tip?</b> Get in touch securely via WhatsApp | Signal at +447713 025 499, or over at Keybase: charlie0</p>
      <hr/>
    </article>
  </body>
</html>