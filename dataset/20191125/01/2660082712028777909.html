<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8"/>
    <meta property="og:url" content="https://virgool.io/@ehtemam/%D8%A7%D8%A8%D8%B2%D8%A7%D8%B1-react-native-doctor-%D8%A8%D8%B1%D8%A7%DB%8C-%D8%A8%D8%B1%D8%B1%D8%B3%DB%8C-%D9%85%D8%AD%DB%8C%D8%B7-%D8%AA%D9%88%D8%B3%D8%B9%D9%87-%D8%A8%D8%B1%D8%B1%D8%B3%DB%8C-%DA%A9%D8%AF%D9%87%D8%A7%DB%8C-doctor-oe4rqldkwfjg"/>
    <meta property="og:site_name" content="ویرگول"/>
    <meta property="article:published_time" content="2019-11-25T01:40:15+00:00"/>
    <meta property="og:title" content="ابزار React Native Doctor برای بررسی محیط توسعه + بررسی کدهای doctor"/>
    <meta property="og:description" content="با استفاده از Doctor می توانید مشکلات محیط توسعه برای اجرای برنامه های React Native را پیدا کنید"/>
  </head>
  <body>
    <article>
      <h1>ابزار React Native Doctor برای بررسی محیط توسعه + بررسی کدهای doctor</h1>
      <address><time datetime="2019-11-25T01:40:15+00:00">25 Nov 2019, 01:40</time> by <a rel="author" href="https://virgool.io/@ehtemam" target="_blank">Mohammad Bagher Ehtemam</a></address>
      <h3>نیاز به این ابزار</h3>
      <figure>
        <img src="https://files.virgool.io/upload/users/1560/posts/oe4rqldkwfjg/q8yufpqhxjwi.jpeg"/>
        <figcaption>گزارش گیری دستور doctor (منبع عکس)</figcaption>
      </figure>
      <p>من برنامه نویسی هستم که برای برنامه نویسی معمولا از دوتا سیستم عامل استفاده می کنم. بیشتر مواقع از لینوکس و ویندوز استفاده می کنم و بر روی لپ تاپ شخصی هم از لینوکس استفاده می کنم. اما زمانی موقعیتی پیش اومد که توی شرکت من باید از سیستم عامل مک ( با یک مک بوک پرو) استفاده می کردم و خوب این باعث شد من با چیزهایی جدیدی روبرو بشم.من بر روی یک برنامه React Native کار می کردم و طبق عادت هم از محیط توسعه اندروید استفاده می کردم. می دونستم چجوری اندروید استودیو رو نصب کنم و تنظیمات را تا جایی انجام بدم که Emulator رو راه اندازی کنم و برنامه رو اجرا کنم. خوب تا اینجا مشکلی نبود. مشکل از جایی شروع شد که من باید برنامه رو با X Code بر روی مک اون رو اجرا می کردم و خوب به دلیل عدم آشنایی مشکلاتی پیش اومد و من مجبور شدم خیلی چیزهایی جدیدی مثل <a href="https://cocoapods.org/">Cocopods</a> یاد بگیرم و استفاده کنم و خوب وقتی خیلی عجله داشته باشید و یکم اینا اذیت کننده میشن. خوب همینجا این سوال ممکن هست پیش بیاد که چه خوب بود اگر ابزاری وجود داشت که این مشکلات رو پیدا می کرد و اطلاع می داد. مثلا باید فلان برنامه نصب باشه تا برنامه نوشته شده RN اجرا بشه . منظورم بسته ها npm و وابستگی هایی که در package.json لیست شده اند نیستند . مثلا Android SDK یا مثل مشکل من Cocopods یا مثلا نسخه Node JS. به تازگی React Native Community ابزاری بنام doctor رو معرفی کرده که به مرور قراره کار بررسی این موارد رو انجام بده. البته نکته ای که وجود داره این هست که همچین دستوری در Homebrew و همچنین Google Flutter هم وجود داره.</p>
      <h3>چطور از این ابزار استفاده کنم</h3>
      <p>برای اجرای doctor کافی است در پوشه پروژه دستور زیر رو وارد کنید</p>
      <p>
        <i>npx @react-native-community/cli doctor</i>
      </p>
      <p>بعد از اجرای این دستور گزارشی از مورادی که باید نصب کنید را در اختیار شما می گذارد.</p>
      <figure>
        <video src="https://files.virgool.io/upload/users/1560/posts/oe4rqldkwfjg/usxjpqz1hh9m.gif" autoplay="" loop=""/>
        <figcaption>نمونه ای از گزارش</figcaption>
      </figure>
      <h3>چه چیزهایی در گزارش هستند</h3>
      <p>در حال حاضر package manager هایی مانند NPM و Yarn و XCode و Android SDK و Android NDK و Cocopods و چندین وابستگی دیگر بررسی میشوند.</p>
      <h3>پشت پرده چه خبر است</h3>
      <p>خوب حالا نوبت اون هست یکم بررسی دقیق تری به ماجرا داشته باشیم بر روی گیت های این دستور در <a href="https://github.com/react-native-community/cli/tree/master/packages/cli/src/commands/doctor">این آدرس</a> وجود داره . در همین آدرس یک فایل هست بنام versionsRange.ts . از ts متوجه میشیم که با استفاده از TypeScript نوشته شده. اگر این فایل رو در زمان نوشتن این مقاله باز کنید همچین چیزی رو خواهید دید:</p>
      <pre>export default {<br/>  // Common<br/>  NODE_JS: '&gt;= 8.3',<br/>  YARN: '&gt;= 1.10.x',<br/>  NPM: '&gt;= 4.x',<br/>  WATCHMAN: '4.x',<br/>  // Android<br/>  ANDROID_SDK: '&gt;= 26.x',<br/>  ANDROID_NDK: '&gt;= 19.x',<br/>  // iOS<br/>  XCODE: '&gt;= 10.x',<br/>};</pre>
      <p>دستور doctor با استفاده از این فایل نسخه های متفاوت رو چک می کنه . مثلا اگر نسخه Node نصب شده بر روی سیستم عامل شما کمتر از 8.3 باشد در گزارش به شما اخطار می دهد.به احتمال زیاد در آینده اگر قرار باشد چیزهای بیشتری چک شود در اینجا لیست میشود. نکته دیگر برای برنامه نویسان تازه واردی مثل من این است که در در طول برنامه با این فایل مثل یک Enum رفتار میشود.البته چون در اینجا از تایپ اسکریپت استفاده شده است می توانست یک enum هم تعریف کنه. بگذارید در جایی که از این این فایل استفاده شده را بررسی کنیم. مثلا بیایید بررسی کنیم این دستور چطور نسخه Node را شناسایی می کند. اگر وارد پوشه healtchecks بشوید لیست از فایل هایی را خواهید دید که هر کدام مسوول بررسی یکی از نیازمندی ها است. فایل <a href="https://github.com/react-native-community/cli/blob/master/packages/cli/src/commands/doctor/healthchecks/nodeJS.ts">nodeJS.ts</a> مسوول بررسی Node است بنابراین این فایل را باز کنید. در حال حاضر چیزی مانند این را مشاهده خواهید کرد.</p>
      <pre>import versionRanges from '../versionRanges';<br/>import {doesSoftwareNeedToBeFixed} from '../checkInstallation';<br/>import {logManualInstallation} from './common';<br/>import {HealthCheckInterface} from '../types';<br/><br/>export default {<br/>  label: 'Node.js',<br/>  getDiagnostics: async ({Binaries}) =&gt; ({<br/>    needsToBeFixed: doesSoftwareNeedToBeFixed({<br/>      version: Binaries.Node.version,<br/>      versionRange: versionRanges.NODE_JS,<br/>    }),<br/>    version: Binaries.Node.version,<br/>    versionRange: versionRanges.NODE_JS,<br/>  }),<br/>  runAutomaticFix: async ({loader}) =&gt; {<br/>    loader.fail();<br/><br/>    logManualInstallation({<br/>      healthcheck: 'Node.js',<br/>      url: 'https://nodejs.org/en/download/',<br/>    });<br/>  },<br/>} as HealthCheckInterface;</pre>
      <p>همانطور که می بینید در خط اول versionRanges وارد این فایل شده است و به عنوان versionRange به متد doesSoftwareNeedToFix داده شده است. متد <a href="https://github.com/react-native-community/cli/blob/master/packages/cli/src/commands/doctor/checkInstallation.ts">doesSoftwareNeedToFix</a> شماره نسخه برنامه نصب شده و همچنین شماره نسخه مورد علاقه ما را که در versionRanges است را دریافت می کند و نتیجه را بر می گرداند که آیا نیاز است که نسخه بروز رسانی یا نصب شود یا خیر. بنابراین اگر روزی قرار باشد مثلا Foo را بررسی کنید کافی است شماره نسخه مورد علاقه را در versionRanges.ts اضافه کنیم و همچنین یک تست کننده بنام Foo.ts هم در پوشه healtchecks اضافه کنیم و سپس در فایل index.ts در پوشه healthchecks اضافه کنیم.</p>
    </article>
  </body>
</html>