<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8"/>
    <meta property="og:url" content="https://www.zdnet.com/article/some-fortinet-products-shipped-with-hardcoded-encryption-keys/"/>
    <meta property="og:site_name" content="ZDNet"/>
    <meta property="article:published_time" content="2019-11-25T22:40:16+00:00"/>
    <meta property="og:title" content="Some Fortinet products shipped with hardcoded encryption keys"/>
    <meta property="og:description" content="It took Fortinet 18 months to fix the issue. Updates are now out."/>
  </head>
  <body>
    <article>
      <h1>Some Fortinet products shipped with hardcoded encryption keys</h1>
      <address><time datetime="2019-11-25T22:40:16+00:00">25 Nov 2019, 22:40</time> by <a rel="author" href="https://www.zdnet.com/meet-the-team/us/catalin.cimpanu/" target="_blank">Catalin Cimpanu</a></address>
      <p>
        <b>It took Fortinet 18 months to fix the issue. Updates are now out.</b>
      </p>
      <figure>
        <img src="https://zdnet3.cbsistatic.com/hub/i/2019/11/25/b87b4f70-93e8-4ff1-816f-f0b9ae07dfe3/075516e936e4164228214de9141b4693/fortinet-logo.jpg"/>
        <figcaption>Image: Fortinet, ZDNet</figcaption>
      </figure>
      <p>Fortinet, a vendor of cyber-security products, took between 10 and 18 months to remove a hardcoded encryption key from three products that were exposing customer data to passive interception.<br/><br/>The hardcoded encryption key was found inside the FortiOS for FortiGate firewalls and the FortiClient endpoint protection software (antivirus) for Mac and Windows.<br/><br/>These three products used a weak encryption cipher (XOR) and hardcoded cryptographic keys to communicate with various FortiGate cloud services.<br/><br/>The hardcoded keys were used to encrypt user traffic for the FortiGuard Web Filter feature, FortiGuard AntiSpam feature, and FortiGuard AntiVirus feature.<br/><br/>A threat actor in a position to observe a user or a company's traffic would have been able to take the hardcoded encryption keys and decrypt this weakly encrypted data stream. Depending on what product a company was using, the attacker would have learned:</p>
      <p>- Full HTTP or HTTPS links for users' web surfing activity (sent for testing to the Web Filter feature)<br/>- Email data sent for testing to the AntiSpam feature)<br/>- Antivirus data (sent for testing to the (Fortinet cloud) AntiVirus feature)<br/><br/>But besides sniffing a user's traffic, the attacker could have also used the same hardcoded encryption key to alter and re-encrypt responses, neutering alerts for malware detections or bad URLs.</p>
      <h3>It took months to get this fixed</h3>
      <p>The issues were discovered in May 2018 by Stefan Viehböck, a security researcher for SEC Consult. The process of reporting and having these issues fixed by Fortinet has been abnormally long and slow.<br/><br/>For example, while most companies acknowledge bug reports on the same day, it took three weeks until a Fortinet employee got on the case.<br/><br/>Fixing the bugs took even longer. Fortinet removed the encryption key from recent versions of FortiOS only in March 2019, ten months after the initial report.<br/><br/>It then took another eight months to remove the encryption keys from older versions, with the last patch being released earlier this month.<br/><br/>Below are the impacted Fortinet products:</p>
      <ul>
        <li>FortiOS 6.0.6 and below</li>
        <li>FortiClientWindows 6.0.6 and below</li>
        <li>FortiClientMac 6.2.1 and below</li>
      </ul>
      <p>System administrators are advised to apply the following patches to remove the hardcoded encryption keys:</p>
      <ul>
        <li>FortiOS 6.0.7 or 6.2.0</li>
        <li>FortiClientWindows 6.2.0</li>
        <li>FortiClientMac 6.2.2</li>
      </ul>
      <p>A Fortinet spokesperson did not reply to a request for comment before this article's publication. Viehböc's write-up and demo code is available <a href="https://sec-consult.com/en/blog/advisories/weak-encryption-cipher-and-hardcoded-cryptographic-keys-in-fortinet-products/">on the SEC Consult website</a>. Fortinet's security advisory is available <a href="https://fortiguard.com/psirt/FG-IR-18-100">here</a>.</p>
    </article>
  </body>
</html>