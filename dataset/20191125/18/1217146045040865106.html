<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8"/>
    <meta property="og:url" content="https://www.bleepingcomputer.com/news/security/fortiguard-used-hardcoded-key-xor-to-encrypt-communications/"/>
    <meta property="og:site_name" content="BleepingComputer"/>
    <meta property="article:published_time" content="2019-11-25T18:01:02+00:00"/>
    <meta property="og:title" content="FortiGuard Used Hardcoded Key, XOR to Encrypt Communications"/>
    <meta property="og:description" content="Security researchers found that multiple security products from Fortinet use weak encryption and static keys to communicate with FortiGuard services in the cloud, such as AntiSpam, AntiVirus, and Web Filter."/>
  </head>
  <body>
    <article>
      <h1>FortiGuard Used Hardcoded Key, XOR to Encrypt Communications</h1>
      <address><time datetime="2019-11-25T18:01:02+00:00">25 Nov 2019, 18:01</time> by <a rel="author" href="https://www.bleepingcomputer.com/author/ionut-ilascu/" target="_blank">Ionut Ilascu</a></address>
      <figure>
        <img src="https://www.bleepstatic.com/content/posts/2019/11/25/FortiGuardServices.jpg"/>
      </figure>
      <p>Security researchers found that multiple security products from Fortinet use weak encryption and static keys to communicate with FortiGuard services in the cloud, such as AntiSpam, AntiVirus, and Web Filter.</p>
      <p>An attacker capable to intercept network traffic would have little trouble to decrypt and modify messages exchanged with FortiGuard servers.</p>
      <h3>XOR and static key</h3>
      <p>In a vulnerability report released today, SEC Consult Vulnerability Lab published details about the vulnerability, now tracked as CVE-2018-9195, along with proof-of-concept (PoC) code that demonstrates the validity of the findings.</p>
      <p>The issue affects versions of FortiOS (before 6.0.7 or 6.2.0), FortiClient for Windows before 6.2.0, and FortiClient for Mac before 6.2.2, that were released starting March 28, 2019. Fortinet <a href="https://fortiguard.com/psirt/FG-IR-18-100">announced</a> the vulnerability on November 20.</p>
      <p>Stefan Viehböck discovered the weakness on May 16, 2018, and disclosed it responsibly to Fortinet. He found that cloud communication was encrypted using XOR cipher with the key embedded in the products.</p>
      <p>The <a href="https://www.sec-consult.com/en/vulnerability-lab/advisories/index.html">advisory</a> from the pentesting company notes that an adversary exploiting this weakness could glean information that would help them build a better attack. They would be able to track users across the world, spy on their browsing, or obtain email data.</p>
      <h3>Plenty revealed via passive monitoring</h3>
      <p>Among the details that could be acquired through passive monitoring are the serial number of the Fortinet product installation (type and unique ID).</p>
      <p>This would provide a better picture of the Fortinet solutions and FortiClient installations used by the target organization. In the case of the Web Filter feature, internet traffic would be revealed. Moreover, where SSL inspection is enabled, the same protocol would be used, "effectively breaking the confidentiality of SSL/TLS."</p>
      <p>Although SEC Consult does not have more information on what is sent by the AntiSpam filter or the Antivirus component, they say that an attacker could intercept and manipulate internet traffic to change the responses for FortiGuard Web Filter, AntiSpam and AntiVirus features.</p>
      <p>In the PoC from SEC Consult, which is a script in Python 3, the key is removed to make it more difficult for a threat actor to carry out an attack on an organization that has yet to update their Fortinet software.</p>
    </article>
  </body>
</html>