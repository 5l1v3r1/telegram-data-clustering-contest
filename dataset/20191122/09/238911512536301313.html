<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8"/>
    <meta property="og:url" content="https://www.cnbeta.com/articles/tech/913521.htm"/>
    <meta property="og:site_name" content="cnBeta"/>
    <meta property="article:published_time" content="2019-11-22T09:02:00+00:00"/>
    <meta property="og:title" content="Google试图将Android设备内核统一至Linux内核主线"/>
    <meta property="og:description" content="Android是基于Linux内核的操作系统，但是，运行在Android设备上的内核其实与Google选择的LTS版本Linux内核有很大不同。在到达每一台Android设备前，内核会经历三个阶段的fork：Google会先选择某个LTS（长期支持）版本的Linux内核，打上Android操作系统的特定补丁，使其成为Android通用内核；紧接着，通用内核被交付给高通等SoC供应商，打上硬件补丁；"/>
  </head>
  <body>
    <article>
      <h1>Google试图将Android设备内核统一至Linux内核主线</h1>
      <address><time datetime="2019-11-22T09:02:00+00:00">22 Nov 2019, 09:02</time> by <a rel="author">teikaei</a></address>
      <p>
        <a href="https://www.cnbeta.com/topics/444.htm">
          <pic src="https://static.cnbetacdn.com/topics/843ee39ba9f7fbe.png"/>
        </a>
      </p>
      <p><b>Android 是基于 Linux 内核的操作系统，但是，运行在 Android 设备上的内核其实与 Google 选择的 LTS 版本 Linux 内核有很大不同。</b>在到达每一台 Android 设备前，内核会经历三个阶段的 fork：Google 会先选择某个 LTS（长期支持）版本的 Linux 内核，打上 Android 操作系统的特定补丁，使其成为 Android 通用内核；紧接着，通用内核被交付给高通等 SoC 供应商，打上硬件补丁；最后，SoC 内核再被移交至设备制造商，打上设备特定的各类元件补丁，这也就构成到每台设备中的设备内核。</p>
      <hr/>
      <figure>
        <img src="https://oscimg.oschina.net/oscnet/d8ccb327e754cd1bc0754fe158a4a59743e.jpg"/>
      </figure>
      <p>这是一个及其漫长的过程，执行多重 fork 并处理数百万行代码大大减慢了整个开发速度。因此，Android 设备使用的内核相较于 Linux 内核主线要滞后两到三年的时间。Google 于 10 月份最新发布了 Pixel 4，其 Linux 内核则是 2017 年 11 月发布的 4.14 LTS 版本。并且由于过大的工作量，Android 设备通常不获取内核更新，它将永远停留在 4.14 版本上。</p>
      <p>再者，各种设备的内核都不尽相同，一台设备的特定内核无法在其他设备上工作。于是，Google 正试图缩小各 Android 设备内核与主线 Linux 内核间的差距，让设备内核更接近上游内核主线。</p>
      <p>在今年的 Linux Plumbers Conference 上，Android 内核团队负责人 Sandeep Patil 表示，他们的目标是从根本上找到 Android 运行所需要的、但不必在给定的硬件上运行的东西，然后将其引入上游并尽可能接近主线。</p>
      <p>Google 的打算是复制其早期工作 Project Treble 以模块化 Android。Project Treble 用于在 Android 和 HAL（硬件抽象层）之间创建稳定的接口。与此类似，Google 计划稳定 Linux 的内核 ABI，从而提供一个稳定的写入接口，使硬件供应商可以轻松地插入代码，最终消除特定的设备内核。</p>
      <figure>
        <img src="https://oscimg.oschina.net/oscnet/3c47ab6ccf7a161a0fb80e66c430ed93daf.png"/>
      </figure>
      <p>Google 的高级软件工程师 MatthiasMännich 展示了一幅预想中的内核体系结构图。”下一代 Android 设备“内核将由通用内核镜像（Generic Kernel Image，GKI）和多个 GKI 模块构成，特定硬件的驱动程序（可能是闭源驱动）将作为内核模块加载。总之在该设想中，所有东西都被模块化了。</p>
      <p>考虑到 Android 生态系统的技术壁垒和多样性，这应该不是一件容易的事情。无论如何，将 Android 设备内核引入主线 Linux 内核肯定会使包括 Android 用户、<a href="https://c.duomai.com/track.php?site_id=242986&amp;euid=&amp;t=https://shouji.jd.com/">手机</a>制造商和 Linux 社区等在内的不少人受益。不过 Google 的计划刚刚开始，后续还有更多的工作要完成。</p>
    </article>
  </body>
</html>