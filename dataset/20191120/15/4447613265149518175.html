<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8"/>
    <meta property="og:url" content="https://hacks.mozilla.org/2019/11/multiple-column-layout-and-column-span-in-firefox-71/"/>
    <meta property="og:site_name" content="Mozilla Hacks – the Web developer blog"/>
    <meta property="article:published_time" content="2019-11-20T15:13:22+00:00"/>
    <meta property="og:title" content="Multiple-column Layout and column-span in Firefox 71 – Mozilla Hacks - the Web developer blog"/>
    <meta property="og:description" content="Firefox 71 adds the column-span property from Multiple-column Layout. In this post Rachel Andrew takes a look at the implementation."/>
  </head>
  <body>
    <article>
      <h1>Multiple-column Layout and column-span in Firefox 71 – Mozilla Hacks - the Web developer blog</h1>
      <address><time datetime="2019-11-20T15:13:22+00:00">20 Nov 2019, 15:13</time> by <a rel="author">Rachel Andrew</a></address>
      <p>Firefox 71 is an exciting release for anyone who cares about CSS Layout. While I am very excited to have <a href="https://hacks.mozilla.org/2019/06/css-grid-level-2-subgrid-is-coming-to-firefox/">subgrid</a> available in Firefox, there is another property that I’ve been keeping an eye on. Firefox 71 implements <code>column-span</code> from Multiple-column Layout. In this post I’ll explain what it is and a little about the progress of the Multiple-column Layout specification.</p>
      <p><a href="https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Columns">Multiple-column Layout</a>, usually referred to as <i>multicol</i>, is a layout method that does something quite different to layout methods such as flexbox and grid. If you have some content marked up and displaying in Normal Flow, and turn that into a multicol container using the <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/column-width"><code>column-width</code></a> or <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/column-count"><code>column-count</code></a> properties, it will display as a set of columns. Unlike Flexbox or Grid however, the content inside the columns flows just as it did in Normal Flow. The difference is that it now flows into a number of anonymous column boxes, much like content in a newspaper.</p>
      <p>See the Pen <a href="https://codepen.io/rachelandrew/pen/mddKOjb"><br/>Columns with multicol</a> by rachelandrew (<a href="https://codepen.io/rachelandrew">@rachelandrew</a>)<br/>on <a href="https://codepen.io/">CodePen</a>.</p>
      <p>Multicol is described as <i>fragmenting</i> the content when it creates these anonymous column boxes to display content. It does not act on the direct children of the multicol container in a flex or grid-like way. In this way it is most similar to the fragmentation that happens when we print a web document, and the content is split between pages. A column-box is essentially the same thing as a page.</p>
      <h3>What is column-span?</h3>
      <p>We can use the <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/column-span"><code>column-span</code></a> property to take an element appearing in a column, and cause it to span across all of the columns. This is a pattern common in print design. In the CodePen below I have two such spanning elements:</p>
      <ul>
        <li>The <code>h1</code> is inside the article as the first child element and is spanning all of the columns.</li>
        <li>The <code>h2</code> is inside the second section, and also spans all of the columns.</li>
      </ul>
      <p>See the Pen <a href="https://codepen.io/rachelandrew/pen/abbKBaj"><br/>Columns with multicol and column-span</a> by rachelandrew (<a href="https://codepen.io/rachelandrew">@rachelandrew</a>)<br/>on <a href="https://codepen.io/">CodePen</a>.</p>
      <p>This example highlights a few things about <code>column-span</code>. Firstly, it is only possible to span <b>all</b> of the columns, or <b>no</b> columns. The allowable values for <code>column-span</code> are all, or none.</p>
      <p>Secondly, when a span interrupts the column boxes, we end up with two lines of columns. The columns are created in the inline direction above the spanning element, then they restart below. Content in the columns does not “jump over” the spanning element and continue.</p>
      <p>In addition, the <code>h1</code> is a direct child of the multicol container, however the <code>h2</code> is not. The <code>h2</code> is nested inside a <code>section</code>. This demonstrates the fact that items do not need to be a direct child to have <code>column-span</code> applied to them.</p>
      <p>Firefox has now joined other browsers in implementing the <code>column-span</code> property. This means that we have good support for the property across all major browsers, as the <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/column-span#Browser_compatibility">Compat data for <code>column-span</code></a> shows.</p>
      <figure>
        <img src="https://2r4s9p1yi1fa2jd7j43zph8r-wpengine.netdna-ssl.com/files/2019/11/caniuse-column-span.png"/>
      </figure>
      <h3>The multicol specification</h3>
      <p>My interest in the implementation of <code>column-span</code> is partly because I am one of the editors of the <a href="https://drafts.csswg.org/css-multicol-1/">multicol specification</a>. I volunteered to edit the multicol specification as it had been stalled for some time, with past resolutions by the WG not having been edited into the spec. There were also a number of unresolved issues, many of which were to do with the <code>column-span</code> feature. I started work by digging through the mailing list archives to find these issues and resolutions where we had them. I then began working through them and editing them into the spec.</p>
      <p>At the time I started working on the specification it was at Candidate Recommendation (CR) status, which infers that the specification is deemed to be fairly complete. Given the number of issues, the WG decided to return it to Working Draft (WD) status while these issues were resolved.</p>
      <h4>CSS development needs teamwork between browsers and spec editors</h4>
      <p>As a spec editor, it’s exciting when features are being implemented, as it helps to progress the spec. CSS is created via an iterative and collaborative process; the CSS WG do not create a complete specification and fling it over the wall at browser engineers. The process involves working on a feature in the WG, which browser engineers try to implement. Questions and problems discovered during that implementation phase are brought back to the working group. The WG then have to decide what to do about such issues, and the spec editor then gets the job of clarifying the spec based on the resolution. The process repeats — each time we tease out issues. Any lack of clarity could cause an interoperability issue if two browsers interpreted the description of the feature in a different way.</p>
      <p>Based on the work that Mozilla have been doing to implement <code>column-span</code>, several issues were brought to the CSS WG and discussed in our calls and face-to-face meetings. We’ve been able to make the specification much clearer on a number of issues with <code>column-span</code> and related issues. Therefore, I’m very happy to have a new property implemented across browsers, and also happy to have a more resilient spec! We recently published an updated WD of multicol, which includes many changes made during the time Mozilla were implementing multicol in Firefox.</p>
      <h3>Other multicol related issues</h3>
      <p>With the implementation of <code>column-span</code>, multicol will work in much the same way across browsers. We do have an outstanding issue with regards to the <code>column-fill</code> property, which controls how the columns are filled. The default way that multicol fills columns is to try to balance the content, so equal amounts of content end up in each column.</p>
      <p>By using the <code>column-fill</code> property, you can change this behavior to fill columns sequentially. This would mean that a multicol container with a height could fill columns to the specified height, potentially leaving empty columns if there was not enough content.</p>
      <p>See the Pen <a href="https://codepen.io/rachelandrew/pen/XWWYNwB"><br/>Columns with multicol and column-fill</a> by rachelandrew (<a href="https://codepen.io/rachelandrew">@rachelandrew</a>)<br/>on <a href="https://codepen.io/">CodePen</a>.</p>
      <p>Due to specification ambiguity, Firefox and Chrome do different things if the multicol container does not have a height. Chrome ignores the <code>column-fill</code> property and balances, whereas Firefox fills the first column with all of the content. This is the kind of issue that arises when we have a vague or unclear spec. It’s not a case of a browser “getting things wrong”, or trying to make the lives of web developers hard. It’s what happens when specifications aren’t crystal clear! For anyone interested, the somewhat lengthy issue trying to resolve this is <a href="https://github.com/w3c/csswg-drafts/issues/4036">here</a>. Most developers won’t come across this issue in practice. However, if you are seeing differences when using <code>column-fill</code>, it is worth knowing about.</p>
      <p>The implementation of <code>column-span</code> is a step towards making multicol robust and useful on the web. To read more about multicol and possible use cases see the <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Columns#Guides">Guides to Multicol</a> on MDN, and my article <a href="https://www.smashingmagazine.com/2019/01/css-multiple-column-layout-multicol/">When And How To Use Multiple-column Layout</a>.</p>
    </article>
  </body>
</html>