<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8"/>
    <meta property="og:url" content="https://xakep.ru/2019/11/20/google-camera/"/>
    <meta property="og:site_name" content="«Хакер»"/>
    <meta property="article:published_time" content="2019-11-20T18:00:14+00:00"/>
    <meta property="og:title" content="Google и Samsung исправили баг, позволявший приложениям следить за пользователями через камеру"/>
    <meta property="og:description" content="Цепочка уязвимостей позволяла злоумышленникам перехватывать контроль над камерой устройства, а затем скрыто делать снимки или записывать видео, даже в том случае, если устройство заблокировано, а пользователь говорит по телефону."/>
  </head>
  <body>
    <article>
      <h1>Google и Samsung исправили баг, позволявший приложениям следить за пользователями через камеру</h1>
      <address><time datetime="2019-11-20T18:00:14+00:00">20 Nov 2019, 18:00</time> by <a rel="author" href="https://xakep.ru/" target="_blank">Мария Нефёдова</a></address>
      <p>ИБ-специалист компании Checkmarx Эрез Ялон (Erez Yalon) рассказал об обнаружении ряда проблем, в целом отслеживаемых под идентификатором <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-2234">CVE-2019-2234</a>  и связанных с обходом разрешений в Android.</p>
      <p>Анализируя безопасность приложения Google Camera на устройствах Google Pixel 2 XL и Pixel 3, исследователь обнаружил, что Google Camera в сущности может использоваться любым другим приложением, даже если оно не имеет специальных разрешений для этого. В числе прочего оказалось возможно делать фото и записывать видео, даже когда целевое устройство заблокировано, экран отключен, а жертва разговаривает по телефону. Разумеется, все это можно было использовать для слежки за ничего не подозревающими пользователями.</p>
      <p>Как вскоре выяснилось, проблемы затрагивали не только устройства Google, но также продукты Samsung, то есть речь шла о сотнях миллионах пользователей.</p>
      <p>Ялон объясняет, что под одним идентификатором объединились сразу несколько багов. Так, корень проблемы состоит в том, что обычно приложение камеры в Android хранит изображения и видео на SD-карте, и для доступа к этому контенту другим приложениями требуются соответствующие разрешения. Но доступ к карте, это одно из наиболее запрашиваемых разрешений вообще и такие права, к сожалению, весьма широки и предоставляют доступ ко всей SD-карте сразу.</p>
      <p>В итоге, если вредоносному приложению был предоставлен доступ к SD-карте, оно не только получало доступ к уже хранящимся там фотографиям и видео, но также могло использовать брешь для съемки нового фото- и видеоконтента.</p>
      <blockquote>«Мы с легкостью сумели записать голос абонента во время разговора, и также могли бы записать голос звонящего, — рассказывают исследователи. — Это нежелательное поведение, так как приложение Google Camera не должно полностью подпадать под контроль внешних приложений, обходя разрешения для камеры, микрофона, GPS».</blockquote>
      <p>В качестве PoC специалисты создали специальное приложение для проверки погоды, разработанное таким образом, чтобы продемонстрировать атаку при наличии лишь базовых разрешений на доступ к хранилищу. После запуска эта приложение подключалось к управляющему серверу и ожидало команд оператора на съемку фото и видео, а также хищение отснятого материала. PoC-приложение экспертов могло:</p>
      <ul>
        <li>сделать фотографию на телефон жертвы и загрузить на управляющий сервер;</li>
        <li>записать видео и загрузить на управляющий сервер;</li>
        <li>отсортировать фотографии по тегам GPS и найти девайс на карте;</li>
        <li>отключить звук во время фотосъемки и записи видео;</li>
        <li>дождаться голосового вызова (полагаясь на датчик приближения), а затем автоматически записать видео жертвы и аудио обоих участников звонка.</li>
      </ul>
      <figure>
        <iframe src="https://www.youtube.com/embed/XJAMJOVoVyw" width="796" height="448" data-service="Youtube" scrolling="no"/>
      </figure>
      <p>Инженерам Google сообщили о проблеме еще 4 июля 2019 года, предоставив им PoC-приложение и сопровождающее видео. Тем не менее, сначала сотрудники Google сочли, что уязвимость относится к разряду «умеренных» (moderate), и только позже согласились, что брешь все же следует классифицировать как проблему «высокой серьезности» (high). В итоге 1 августа текущего года Google зарегистрировала CVE и подтвердила, что уязвимость касается и продукции других вендоров.</p>
      <p>Теперь в Google сообщают, что минувшим летом проблема была решена через обновление для приложения Google Camera через Play Store, а также патч стал доступен для всех партнеров компании. Представители Samsung так же подтвердили, что к настоящему моменту уже выпустили исправления для всех моделей уязвимых устройств.</p>
    </article>
  </body>
</html>