<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8"/>
    <meta property="og:url" content="https://3dtoday.ru/blogs/krom-berg/reestr-pechati-s-raschetom"/>
    <meta property="og:site_name" content="3dtoday.ru"/>
    <meta property="article:published_time" content="2019-11-20T00:00:00+00:00"/>
    <meta property="og:title" content="Реестр печати с расчетом"/>
    <meta property="og:description" content="И так, доброго всем времени суток)"/>
  </head>
  <body>
    <article>
      <h1>Реестр печати с расчетом</h1>
      <address><time datetime="2019-11-20T00:00:00+00:00">20 Nov 2019</time> by <a rel="author" href="https://3dtoday.ru/blogs/krom-berg" target="_blank">krom_berg</a></address>
      <p>И так, доброго всем времени суток)</p>
      <p>Данный пост начну с небольшого рассказа.</p>
      <p>Я думаю как и многие из нас, я занимаюсь печатью на заказ, правда пока в небольших объемах, но всё же столкнулся с некоторой проблемой. Я старался всегда вести какой-то учет заказов, чтобы собирать статистику, видеть средний расход в месяц по пластику ну и в целом просто подводить итоги в конце месяца. </p>
      <p>Завел себе таблицу Excel, в которую набросал примитивных колонок: вид пластика, вес изделия, время печати и т.д. Хоть объем информации небольшой, но всё же эти 5-6 колонок нужно было после каждого заказа заполнять вручную. </p>
      <p>Позже наткнулся на очень полезную штуку от <a href="https://3dtoday.ru/blogs/chuzhastik/the-calculation-of-the-cost-of-3d-printing/">Chuzhastik</a> (ссылка на статью кликабельна), а именно калькулятор для расчета стоимости печати, в котором довольно приятно реализован метод. </p>
      <p>Попользовавшись довольно долго данным калькулятором, и снова устав вписывать информацию о печати, я в какой-то момент забросил ведение статистики. Но в очередной раз разговаривая с заказчиком, я понял что всё таки надо реализовать некое подобие реестра, в который по одному щелчку мышки будет попадать вся информация по печати. Начиная от цены катушки заканчивая стоимостью за партию.</p>
      <p>Покопавшись денек в интернете, нашел способ в котором можно написать код для Excel на Visual Basic. С языками программирования я немного знаком, но конкретно с этим товарищем я никогда не общался) Потратив еще немного времени и разобравшись в синтаксисе языка, конечно не без помощи "ведосеков", я смог реализовать задумку.</p>
      <p>А теперь по порядку)</p>
      <p>За основу была взята вышеупомянутая таблица с готовым расчетом стоимости печати.</p>
      <p>Первоначально выглядела она так</p>
      <figure>
        <img src="https://3dtoday.ru/cache/870x/posts/main/ywFU9DC1bn0lmsuDKJ9xEUKBjMyXSVK7ZcBdgoUe.png"/>
      </figure>
      <p>Сразу небольшая оговорочка, алгоритм расчета я не трогал от слова совсем, и не стал придумывать колесо т.к. всё реализовано довольно хорошо и меня полностью устраивает.</p>
      <p>Так вот, взяв за основу всю эту красоту, я переделав таблицу немного под себя, получилось следующее:</p>
      <figure>
        <img src="https://3dtoday.ru/cache/870x/posts/main/OOIRdsZBzVhNH2GrEfAjP83aynpe5BFHvEK4kneh.png"/>
      </figure>
      <p>Понимаю что очень уж всё пёстро, но поверьте, в дальнейшем это пригодится, и вы поймёте почему)</p>
      <p>Идем дальше. Приведя всё в тот вид который был у меня в голове, и уже примерно понимая какой вид и какие столбцы будут в реестре я подумал, что будет полезно указывать еще и вид пластика, который использую, чтобы видеть картину по расходу не общего количества пластика, а каждого отдельно. Но как все знают, лень двигатель прогресса, хотя я больше за оптимизацию всего процесса)) Поэтому сделал возможность выбрать необходимый пластик сразу в ячейке из выпадающего списка. Вкратце объясню.</p>
      <p>Создаем нужный нам список, к примеру такой:</p>
      <figure>
        <img src="https://3dtoday.ru/cache/870x/posts/main/bgnJdMXHADrVAtapgmWizbGVWNDrieMQVMSAonhI.png"/>
      </figure>
      <p>Тыкаем на ячейку в которой будет выпадающий список.</p>
      <p>Далее в графе данные, нам нужна "проверка данных".</p>
      <figure>
        <img src="https://3dtoday.ru/cache/870x/posts/main/ZsgjfvXyOjE9tOzp5i9xBCLbr0IHQw6KiVPWR7Yh.png"/>
      </figure>
      <p>Тыкаем на нее и вы новом окне "тип данных" выбираем "список".</p>
      <figure>
        <img src="https://3dtoday.ru/cache/870x/posts/main/0KbYCJ7ubEcnufGGDqVEOOLqv5bHmsGiFgaynvcw.png"/>
      </figure>
      <p>И в "источник" выделяем нужные нам ячейки <u>БЕЗ</u> шапки.</p>
      <figure>
        <img src="https://3dtoday.ru/cache/870x/posts/main/BEQZ3YD2IwkQbl1MWyi55SxGNcGaGNXltL5GjNos.png"/>
      </figure>
      <p>Нажимаем Enter и следом Ok.</p>
      <p>Вуаля, и готово. Лично у меня получилось так: </p>
      <figure>
        <img src="https://3dtoday.ru/cache/870x/posts/main/Cw0hAJp9J38juN3XrfZ5pohznxjwx6C6PkaJ05VO.png"/>
      </figure>
      <p>Дальше необходимо включить вкладку разработчика. Параметры - Настройки ленты - Разработчик.</p>
      <figure>
        <img src="https://3dtoday.ru/cache/870x/posts/main/kJ8W0gURCN5aAZQamrZ4pxIQgih3vwKTGX8PMncA.png"/>
      </figure>
      <p>Далее начинается самое интересное.</p>
      <p>Для начала я начал готовить шапку самого реестра. Получилось следующим образом:</p>
      <figure>
        <img src="https://3dtoday.ru/cache/870x/posts/main/8xxDX7iQYgDPMoXN1O721yLy4i3WDNJds3rSfGlk.png"/>
      </figure>
      <p>Теперь для адекватной работы, всему этому безобразию необходимо присвоить форматирование таблицы. Из выпадающего списка можно выбрать любую понравившуюся или создать самому) Я в свою очередь не стал заморачиваться и взял готовый формат.</p>
      <p>Теперь для каждой ячейки, которую мы будем копировать из листа расчета в лист реестра необходимо задать тег, с помощью которого мы сможем в коде правильно обратиться к ячейке.</p>
      <figure>
        <img src="https://3dtoday.ru/cache/870x/posts/main/NFhhoPRTPcu8g6PjDqAOybY2UPdcKnS2qwrJ1rYP.png"/>
      </figure>
      <p> <b><u>ДАНГЕРУС!!! ОБЯЗАТЕЛЬНО ПОСЛЕ ВВОДА НУЖНО НАЖАТЬ ENTER, ИНАЧЕ НЕ СОХРАНИТСЯ.</u></b></p>
      <p>
        <b>
          <u>ТАК ЖЕ НЕОБХОДИМО СРАЗУ СОХРАНИТЬ ДОКУМЕНТ В ФОРМАТЕ ПРИВЕДЕННОМ НИЖЕ.</u>
        </b>
      </p>
      <figure>
        <img src="https://3dtoday.ru/cache/870x/posts/main/D3eT2JaLWD7L2lUrsOyJtIXVoesqcggZ494LDz9v.png"/>
      </figure>
      <p>Вроде предупредил)После того как мы присвоили всем нужным нам ячейкам имена, начинаем кодить.</p>
      <p>Переходим во вкладку разработчика и открываем Visual Basic</p>
      <figure>
        <img src="https://3dtoday.ru/cache/870x/posts/main/Yq53qx4SfBi0wKoGJjdMo7WvaMuczZsbqo86KbJh.png"/>
      </figure>
      <p>После чего нам нужно подключить во вкладке Insert, Module</p>
      <figure>
        <img src="https://3dtoday.ru/cache/870x/posts/main/6pJnTjyyb6L4t1IvHXTv46ezaepygbjhPr9dQkZw.png"/>
      </figure>
      <p>Переименовываем имеющиеся листы, <u>обязательно</u> английскими буквами.</p>
      <figure>
        <img src="https://3dtoday.ru/cache/870x/posts/main/2P0BV2MXovEtesx1Lp8zgTfH8vE4NW9lxF0ikTxS.png"/>
      </figure>
      <p>И пишем код. Сразу хочу оговориться, что код, который приведен ниже сделан именно под мою таблицу. Красным я подчеркну переменные которые могут меняться.</p>
      <figure>
        <img src="https://3dtoday.ru/cache/870x/posts/main/ZPPlBjFES2A60qw9F6PgVZpFoXQpqV2i31XkFZMz.png"/>
      </figure>
      <p>Знаю, знаю, таких переменных очень много и дабы не мусолить эту довольно большую тему, просто приложу ссылку на видео, в котором поясняется как и что этот код делает.  <b><u><a href="https://www.youtube.com/watch?v=1YlyNFZhYiM&amp;t=741s">Тут</a>.</u></b></p>
      <p>Сразу предупрежу, что мой код отличается от приведенного в видео. Т.к. там объясняется написание кода только для одного листа, следовательно код другой.Все ребята шаристые, разберетесь)</p>
      <p>После того как написали код, сохраняем всё это богатство в вышеупомянутом формате еще раз. </p>
      <p>Приступаем к финальной стадии. Созданию великой <u><b>КНОПКИ.</b></u></p>
      <p>Для этого возвращаемся во вкладку разработчика и тыкаем вставить - кнопка(самая первая в выпадающем окне):</p>
      <figure>
        <img src="https://3dtoday.ru/cache/870x/posts/main/d228Zy2ctoLO8Pd3arR7eguGUQXmU6fej9QWyqpU.png"/>
      </figure>
      <p>Выбираем необходимые размеры и после того как опустим мышку вылезет такое окно:</p>
      <figure>
        <img src="https://3dtoday.ru/cache/870x/posts/main/xOe21zJssfVepBPSVu5137UonOFi9nhcF3u2AJkY.png"/>
      </figure>
      <p>Выбираем наш модуль "AddDateToTable" и тыкаем Ок, появляется активная кнопка, переименовываем ее как нам нужно, перетаскиваем куда нужно и пользуемся)</p>
      <p>Конечный результат:</p>
      <figure>
        <img src="https://3dtoday.ru/cache/870x/posts/main/x53Y19jWPcFXJJPSwwH80HjoM0R7h5E1oBjImlZO.png"/>
      </figure>
      <p>А теперь самое волнительное. Жмем кнопку "Внести в реестр"</p>
      <figure>
        <img src="https://3dtoday.ru/cache/870x/posts/main/FNtKz1FpBnTyDGagvIk5kxPBfFOEuGAV2TCQ3f5t.png"/>
      </figure>
      <p>Дабы не было сомнение что автонумерация и прочие функции работают исправно, от фонаря взял рандомные значения и залил их в реестр, так что всё огонь)</p>
      <figure>
        <img src="https://3dtoday.ru/cache/870x/posts/main/ofpBGg2pN1e4Us4xDAKZo7RDn9TOnUH0Lq3lbol9.png"/>
      </figure>
      <p>И о боги, оно работает, оно живое)</p>
      <p>В конечном итоге что мы с этого имеем?</p>
      <p>Автонумерацию строк, автоматический ввод всех данных в реестр одним кликом, оптимизацию сбора статистики и бесценный опыт.</p>
      <p>Хочу сказать, что такой длиннопост я написал для людей, которым может не понравится мой вариант исполнения, которые увидев задумку, захотят сделать подобное под себя. Я мог бы просто залить пару скринов и сказать "пользуйтесь", но так же не интересно))</p>
      <p>Надеюсь я смог немного заинтересовать вас своей мыслью, друзья сопечатники)</p>
      <p>Ну а теперь, изрядно помучав вас, я выкладываю свою вариацию в Excel файле.</p>
      <p>
        <b>
          <u><a href="https://yadi.sk/i/6WoknkisZ62kPQ">Excel тут</a>.</u>
        </b>
      </p>
      <p>Пользуйтесь на здоровье и добро пожаловать в комментарии для обсуждения сей статьи)</p>
      <p>Всем удачи и хорошей адгезии ;)</p>
    </article>
  </body>
</html>