<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8"/>
    <meta property="og:url" content="https://xakep.ru/2019/11/20/mispadu/"/>
    <meta property="og:site_name" content="«Хакер»"/>
    <meta property="article:published_time" content="2019-11-20T10:30:46+00:00"/>
    <meta property="og:title" content="Банковский троян Mispadu маскируется под рекламу McDonald’s"/>
    <meta property="og:description" content="Специалисты ESET рассказали о банковском трояне Mispadu, который использует фейковую рекламу скидочных купонов McDonald’s для распространения."/>
  </head>
  <body>
    <article>
      <h1>Банковский троян Mispadu маскируется под рекламу McDonald’s</h1>
      <address><time datetime="2019-11-20T10:30:46+00:00">20 Nov 2019, 10:30</time> by <a rel="author" href="https://xakep.ru/" target="_blank">Мария Нефёдова</a></address>
      <p>Специалисты компании ESET рассказали о банковском трояне <a href="https://www.welivesecurity.com/2019/11/19/mispadu-advertisement-discounted-unhappy-meal/">Mispadu</a> из Латинской Америки, который использует фейковую рекламу McDonald’s для распространения. Основными целями трояна являются кража денежных средств и учетных данных. Интересно, что в Бразилии малварь распространяется и как вредоносное расширение для Google Chrome, пытается похищать данные банковских карт и онлайн-банкинга, а также ставит под угрозу пользователей платежной системы Boleto.</p>
      <p>Семейство малвари Mispadu было выявлено во время исследования банковских троянов в Латинской Америке, предназначенных для атак на пользователей из Бразилии и Мексики. Вредонос написан на Delphi и атакует своих жертв, используя те же методы, что и ранее обнаруженные экспертами трояны <a href="https://www.esetnod32.ru/company/press/center/eset-bankovskiy-troyan-amavaldo-ispolzuet-snimki-ekrana-dlya-khishcheniya-informatsii/">Amavaldo </a>и <a href="https://www.esetnod32.ru/company/press/center/eset-bankovskiy-troyan-ispolzoval-youtube-dlya-krazhi-kriptovalyuty/">Casbaneiro</a>. В основном это использование поддельных всплывающих окон и попытки убедить потенциальных жертв сообщить злоумышленникам конфиденциальную информацию.</p>
      <p>Распространяется Mispadu при помощи спама и вредоносной рекламы. Второй способ распространения не слишком характерен для латиноамериканских банкеров, поэтому его исследователи изучили подробнее.</p>
      <figure>
        <img src="https://xakep.ru/wp-content/uploads/2019/11/249005/Figure05_DistributionChainFlow-768x658.png#26759185"/>
        <figcaption>Схема распространения Mispadu</figcaption>
      </figure>
      <p>Так, мошенники начинали с размещения коммерческих публикаций в Facebook, которые предлагали пользователям скидочные купоны в McDonald’s. Кликая по такому рекламному объявлению, потенциальная жертва загружала файл ZIP, замаскированный под скидочный купон и содержащий установщик MSI. Иногда архивы также содержат легитимное ПО, такое как Mozilla Firefox или PuTTY, но это лишь приманки, которые вообще никак не используются. Запустив такой архив пользователь, разумеется, получает не купон на скидку, а банковский троян Mispadu.</p>
      <figure>
        <img src="https://xakep.ru/wp-content/uploads/2019/11/249005/Figure06_FacebookAds-768x660.png"/>
      </figure>
      <figure>
        <img src="https://xakep.ru/wp-content/uploads/2019/11/249005/Figure07_FakeWebsites-768x473.png"/>
      </figure>
      <p>Интересно, что операторы Mispadu использовали Яндекс.Почту для хранения своей полезной нагрузки. Судя по всему, преступники завели учетную запись на Яндекс.Почте, отправили письмо с вредоносным купоном в качестве вложения самим себе, а затем предоставляли жертвам прямую ссылку на это вложение.</p>
      <figure>
        <img src="https://xakep.ru/wp-content/uploads/2019/11/249005/Figure12_YandexLink.png#26759185"/>
      </figure>
      <p>На зараженном устройстве Mispadu способен делать скриншоты, имитировать действия мыши и клавиатуры, а также перехватывать нажатия клавиш. Вредонос может обновлять себя через файл Visual Basic Script (VBS), который он загружает и выполняет. Также Mispadu следит за содержимым буфера обмена и пытается заменить попадающие туда адреса Bitcoin-кошельков адресами своих операторов, как это делал Casbaneiro. Тем не менее, после изучения кошелька злоумышленников исследователи пришли к выводу, что пока эти попытки особенным успехом не увенчались.</p>
      <figure>
        <img src="https://xakep.ru/wp-content/uploads/2019/11/249005/Figure03_BitcoinWallet.png#26759185"/>
      </figure>
      <p>Как и другие латиноамериканские банкеры Mispadu собирает детальную информацию о своих жертвах: версию ОС, имя компьютера, данные о системном языке, список установленных в системе приложений латиноамериканских банков, список установленных защитных продуктов, информацию об установке Diebold Warsaw GAS Tecnologia (популярное в Бразилии приложение для защиты доступа к онлайн-банкингу).</p>
      <p>Как уже было сказано выше, в Бразилии малварь и вовсе распространялась как вредоносное расширение Securty System 1.0 для Google Chrome, то есть была обнаружена в официальном каталоге Chrome Web Store. Схему вредоносных действий такого расширения можно увидеть ниже.</p>
      <figure>
        <img src="https://xakep.ru/wp-content/uploads/2019/11/249005/Figure13_ChromeExtDistributionChainFlow-768x368.png#26759185"/>
      </figure>
      <p>Поскольку в ходе бразильской кампании Mispadu использовались короткие URL Tiny.cc, эксперты смогли собрать статистику. Как видно на рисунке ниже, кампания привлекла почти 100 000 кликов только из Бразилии. Клики, исходящие с устройств под управлением Android, скорее всего, являются результатом ошибки, так как реклама в Facebook показывалась пользователям независимо от используемого устройства. Также можно заметить, что у вредоносной кампании были четкие фазы:  одна фаза закончилась во второй половине сентября 2019 года, и кампания вновь активизировалась в начале октября 2019 года.</p>
      <figure>
        <img src="https://xakep.ru/wp-content/uploads/2019/11/249005/Figure11_BrazilStats.png#26759185"/>
      </figure>
    </article>
  </body>
</html>