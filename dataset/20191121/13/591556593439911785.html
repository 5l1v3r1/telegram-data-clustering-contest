<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8"/>
    <meta property="og:url" content="https://www.zdnet.com/article/deprimon-downloader-uses-novel-ways-to-infect-your-pc-with-coloredlambert-malware/"/>
    <meta property="og:site_name" content="ZDNet"/>
    <meta property="article:published_time" content="2019-11-21T13:44:24+00:00"/>
    <meta property="og:title" content="DePriMon downloader uses novel ways to infect your PC with ColoredLambert malware"/>
    <meta property="og:description" content="It is believed the downloader is using techniques not seen before in the wild."/>
  </head>
  <body>
    <article>
      <h1>DePriMon downloader uses novel ways to infect your PC with ColoredLambert malware</h1>
      <address><time datetime="2019-11-21T13:44:24+00:00">21 Nov 2019, 13:44</time> by <a rel="author" href="https://www.zdnet.com/meet-the-team/us/charlie-osborne/" target="_blank">Charlie Osborne</a></address>
      <p>
        <b>It is believed the downloader is using techniques not seen before in the wild.</b>
      </p>
      <figure>
        <video src="https://techrepublicvideo.cbsistatic.com/vr/2019/11/15/1642614851574/2019-11-15-wochit-malware-attacks-on-hospitals-are-on-the-rise_1977847_742.mp4"/>
      </figure>
      <figure>
        <img src="https://zdnet1.cbsistatic.com/hub/i/r/2019/11/15/5f278576-86a5-42ad-a1ff-a76b637ba49f/thumbnail/570x322/b08d4f69aab4c6c48abee2d796f6e78c/malware-attacks-on-hospitals-are-on-the-5dce7671e970ea0001731ecc-1-nov-15-2019-14-30-49-poster.jpg"/>
      </figure>
      <p>A malware downloader has been spotted using novel "Port Monitor" methods that have not been detected before in active campaigns.  <br/><br/>Dubbed DePriMon, the malicious downloader is used to deploy malware used by Lambert -- also known as the Longhorn advanced persistent threat (APT) group -- which specializes in attacks against European and Middle Eastern companies. </p>
      <p>Kaspersky estimates that Lambert has been active since at <a href="https://securelist.com/unraveling-the-lamberts-toolkit/77990/">least 2008</a>, whereas Symantec rounds up the year as closer to 2011. <br/><br/>The threat actors use a variety of vulnerabilities, from zero-day bugs including the <a href="https://nvd.nist.gov/vuln/detail/CVE-2014-4148">CVE-2014-4148</a> Windows exploit and backdoor malware to infiltrate government, financial, telecoms, energy, aviation, IT, and educational sectors, prompting the belief that Lambert may be state-sponsored. <br/><br/><b>See also: </b><a href="https://www.zdnet.com/article/vegalocker-evolves-into-buran-ransomware-as-a-service/">New Buran ransomware-as-a-service tempts criminals with discount licenses</a></p>
      <p>In 2017, <a href="https://www.symantec.com/connect/blogs/longhorn-tools-used-cyberespionage-group-linked-vault-7">Symantec said</a> that at least 40 targets in 16 countries have been compromised by the attackers. <br/><br/>The APT uses various malware, <a href="https://www.fireeye.com/blog/threat-research/2014/10/two-targeted-attacks-two-new-zero-days.html">assigned different colors</a> by cybersecurity researchers, to conduct reconnaissance, steal data, and maintain persistence. </p>
      <p>These include Black Lampert, an active implant used to connect to a command-and-control (C2) server for instructions; White Lampert, a passive, network-based backdoor; Blue Lampert, a second-stage malware payload; Green Lampert, an older version of the aforementioned payload; and Pink Lambert, a toolkit including a USB-compromising module and an orchestrator.  <br/><br/>The initial Lampert attack vector is unknown. However, the discovery of the malware in tandem with the new DePriMon download is of note.  <br/><br/><b>CNET: </b><a href="https://www.cnet.com/news/facebook-google-surveillance-threatens-human-rights-amnesty-international-says/?ftag=CMG-01-10aaa1b">Facebook, Google 'surveillance' threatens human rights, Amnesty International says</a> <br/><br/>ESET published the results of an investigation into the downloader <a href="https://www.welivesecurity.com/2019/11/21/deprimon-default-print-monitor-malicious-downloader/">in a blog post</a> on Thursday. According to the cybersecurity researchers, the code uses "many non-traditional techniques" including the registration of a new local port monitor to achieve persistence.  <br/><br/>The port monitor is named "Windows Default Print Monitor" -- leading to the downloader's name -- and has been detected at a private company in Europe, alongside "dozens of computers" in the Middle East that were also compromised by Lambert malware.  <br/><br/>DePriMon is downloaded to memory and executed as a DLL using reflective DLL techniques. As the downloader is never stored on disk, this can reduce the risk of being detected.  <br/><br/>The port monitor is registered with a key and value, which requires administrator rights. To achieve this, the DLL will be loaded by spoolsv.exe on system startup. <br/><br/>"We believe DePriMon is the first example of malware using this technique ever publicly described," ESET says.  <br/><br/>A path is then forged for the download and execution of the main malware payloads. This path is encrypted using Microsoft's SSL/TLS and Secure Channel system, initialized with a Windows socket and subsequent SSPI sessions. DePriMon may also use Schannel, depending on the victim's system configuration. <br/><br/>DePriMon is then able to communicate with its C2 over TLS. Commands and configuration data is encrypted with AES-256.  <br/><br/><b>TechRepublic: </b><a href="https://www.techrepublic.com/article/82-of-smb-execs-expect-employees-to-put-business-devices-at-risk-with-holiday-shopping/?ftag=CMG-01-10aaa1b">82% of SMB execs expect employees to put business devices at risk with holiday shopping</a> <br/><br/>"Thanks to its secure design, the configuration is not left in memory in unencrypted form," the researchers say. "Every time the downloader needs to use some element of the configuration file, it decrypts the configuration file, retrieves the member and encrypts the file again. This design protects the malware's primary function -- C2 communication -- against memory forensics." <br/><br/>"DePriMon is an unusually advanced downloader whose developers have put extra effort into setting up the architecture and crafting the critical components," ESET added. "DePriMon is a powerful, flexible and persistent tool designed to download a payload and execute it, and to collect some basic information about the system and its user along the way."</p>
      <h3>Previous and related coverage</h3>
      <ul>
        <li>
          <a href="https://www.zdnet.com/article/when-one-isnt-enough-this-shady-malware-will-infect-your-pc-with-two-trojans/">When one isn't enough: This shady malware will infect your PC with dual Trojans</a>
        </li>
        <li>
          <a href="https://www.zdnet.com/article/emotet-resurgence-packs-in-new-binaries-malicious-functions/">Emotet resurgence packs in new binaries, Trickbot functions</a>
        </li>
        <li>
          <a href="https://www.zdnet.com/article/cloud-atlas-threat-group-updates-weaponry-with-polymorphic-malware/">Cloud Atlas threat group updates weaponry with polymorphic malware</a>
        </li>
      </ul>
      <hr/>
      <p><b>Have a tip?</b> Get in touch securely via WhatsApp | Signal at +447713 025 499, or over at Keybase: charlie0</p>
      <hr/>
    </article>
  </body>
</html>