<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8"/>
    <meta property="og:url" content="https://www.zdnet.com/article/new-sectoprat-malware-creates-hidden-second-desktop-to-control-browser-sessions/"/>
    <meta property="og:site_name" content="ZDNet"/>
    <meta property="article:published_time" content="2019-11-21T15:00:35+00:00"/>
    <meta property="og:title" content="New SectopRAT Trojan creates hidden second desktop to control browser sessions"/>
    <meta property="og:description" content="The Trojan makes sure the second desktop is hidden from sight."/>
  </head>
  <body>
    <article>
      <h1>New SectopRAT Trojan creates hidden second desktop to control browser sessions</h1>
      <address><time datetime="2019-11-21T15:00:35+00:00">21 Nov 2019, 15:00</time> by <a rel="author" href="https://www.zdnet.com/meet-the-team/us/charlie-osborne/" target="_blank">Charlie Osborne</a></address>
      <p>
        <b>The Trojan makes sure the second desktop is hidden from sight.</b>
      </p>
      <figure>
        <video src="https://techrepublicmedia.akamaized.net/media/2019/08/28/1594288707758/2019-08-28-wochit-new-variant-of-trojan-malware-puts-your-personal-information-at-risk_1921739_740.mp4"/>
      </figure>
      <figure>
        <img src="https://zdnet2.cbsistatic.com/hub/i/r/2019/08/28/fc325e42-89c9-409c-b742-98ab36201360/thumbnail/570x322/a897e5332de063ff3990e21d46b37a00/new-variant-of-trojan-malware-puts-your-5d6508c7d187350001653617-1-aug-28-2019-11-48-36-poster.jpg"/>
      </figure>
      <p>A new Trojan, SectopRAT, has appeared in the wild which is able to launch a hidden secondary desktop to control browser sessions on infected machines.  <br/><br/>The new malware was first <a href="https://twitter.com/malwrhunterteam/status/1195288774957244416">spotted by MalwareHunterTeam</a>. In a tweet on 15 November, MalwareHunterTeam said the C# malware, compiled on 13 November, was able to "create [a] hidden desktop and run [a] selected browser there with full control." <br/><br/>This caught the attention of cybersecurity researchers <a href="https://www.gdatasoftware.com/blog/2019/11/35548-new-sectoprat-remote-access-malware-utilizes-second-desktop-to-control-browsers">from G Data</a>, who were able to obtain a second sample, compiled on 14 November, later submitted to Virustotal.</p>
      <figure>
        <img src="https://zdnet4.cbsistatic.com/hub/i/2019/11/21/ff0f5a83-c8f8-4fba-9237-09f1a42fc97a/0ed9f50e382802b2e64817c7d886469d/screenshot-2019-11-21-at-13-57-44.png"/>
      </figure>
      <p>The first SectopRAT sample is signed by Sectigo RSA Code Signing CA and uses a Flash icon, whereas the second is not signed. Both samples of the Remote Access Trojan (RAT) use arbitrary characters in their names, have write/execute characteristics, and make use of ConfuserEx for obfuscation.  <br/><br/>According to the researchers, the malware contains a RemoteClient.Config class with four valuables for configuration -- IP, retip, filename, and mutexName. </p>
      <p>The IP variable relates to the Trojan's command-and-control (C2) server, whereas the retip variable has been designed to set up new C2 IPs that the server can override using the "set IP" command.  <br/><br/><b>See also: </b><a href="https://www.zdnet.com/article/asruex-trojan-exploits-old-office-adobe-bugs-to-backdoor-your-system/">Asruex Trojan exploits old Office, Adobe bugs to backdoor your system</a></p>
      <p>Filename and mutexName, however, are set but not in active use. <br/><br/>The hardcoded filename spoolsvc.exe is added to the registry for persistence, a mimicry of the legitimate Microsoft service spoolsv.exe. <br/><br/>Once connected with its C2, the Trojan can be commanded to either stream an active desktop session or create a secondary one, hardcoded as "sdfsddfg," which is hidden from view. The researchers say that operators of the malware are able to use the "Init browser" command to initiate a browser session through the secondary desktop. </p>
      <p><b>CNET: </b><a href="https://www.cnet.com/news/facebook-google-surveillance-threatens-human-rights-amnesty-international-says/?ftag=CMG-01-10aaa1b">Facebook, Google 'surveillance' threatens human rights, Amnesty International says</a> <br/><br/>Chrome, Firefox or Internet Explorer browser sessions can be launched. The malware is also able to change browser configurations to disable security barriers and sandboxes. However, the browser paths are hardcoded and do not use environmental variables.  <br/><br/>The malware is also able to send computer information back to the C2, such as the name of the operating system, processor data, core information and RAM available.  <br/><br/><b>TechRepublic: </b><a href="https://www.techrepublic.com/article/how-can-you-protect-yourself-from-hackers-an-ibm-social-engineer-offers-advice/?ftag=CMG-01-10aaa1b">How can you protect yourself from hackers? An IBM social engineer offers advice</a> <br/><br/>Another command, "Get codec info" is yet to be implemented. The team believes that the Trojan is not yet complete, as SectopRAT "looks unfinished and in parts hastily done." <br/><br/>"Despite obvious flaws like using hardcoded paths without environmental variables to access system files, the RAT's architecture, the use of a second desktop and changes in browser configuration files and parameters show some internal knowledge that is far from a greenhorn," the researchers say. "It is quite possible that the first samples in the wild are merely for testing." <br/><br/>Indicators of Compromise (IoCs) can be accessed <a href="https://www.gdatasoftware.com/blog/2019/11/35548-new-sectoprat-remote-access-malware-utilizes-second-desktop-to-control-browsers">here</a>. </p>
      <h3>Previous and related coverage</h3>
      <ul>
        <li>
          <a href="https://www.zdnet.com/article/when-one-isnt-enough-this-shady-malware-will-infect-your-pc-with-two-trojans/">When one isn't enough: This shady malware will infect your PC with dual Trojans</a>
        </li>
        <li>
          <a href="https://www.zdnet.com/article/this-old-trojan-malware-is-back-with-a-new-trick-to-help-it-hide-in-plain-sight/">This old trojan malware is back with a new trick to help it hide in plain sight</a>
        </li>
        <li>
          <a href="https://www.zdnet.com/article/magecart-group-linked-to-dridex-banking-trojan-carbanak/">Magecart group linked to Dridex banking Trojan, Carbanak</a>
        </li>
      </ul>
      <hr/>
      <p><b>Have a tip?</b> Get in touch securely via WhatsApp | Signal at +447713 025 499, or over at Keybase: charlie0</p>
      <hr/>
    </article>
  </body>
</html>