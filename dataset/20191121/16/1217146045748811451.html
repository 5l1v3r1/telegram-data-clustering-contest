<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8"/>
    <meta property="og:url" content="https://www.bleepingcomputer.com/news/security/deprimon-malware-registers-itself-as-a-windows-print-monitor/"/>
    <meta property="og:site_name" content="BleepingComputer"/>
    <meta property="article:published_time" content="2019-11-21T16:53:12+00:00"/>
    <meta property="og:title" content="DePriMon Malware Registers Itself as a Windows Print Monitor"/>
    <meta property="og:description" content="A malware downloader being dubbed DePriMon registers itself as a Windows print monitor in order to gain persistence on infected user's computers."/>
  </head>
  <body>
    <article>
      <h1>DePriMon Malware Registers Itself as a Windows Print Monitor</h1>
      <address><time datetime="2019-11-21T16:53:12+00:00">21 Nov 2019, 16:53</time> by <a rel="author" href="https://www.bleepingcomputer.com/author/lawrence-abrams/" target="_blank">Lawrence Abrams</a></address>
      <figure>
        <img src="https://www.bleepstatic.com/content/hl-images/2019/03/12/Worm_Malware.png"/>
      </figure>
      <p>A malware downloader being dubbed DePriMon registers itself as a Windows print monitor in order to gain persistence on infected user's computers.</p>
      <p>Using this method, the malware will have SYSTEM privileges, which allows it to execute commands with elevated privileges such as the downloading of additional malware.</p>
      <h3>What is a Windows print monitor</h3>
      <p>A print monitor is a Windows DLL that registers itself with the system as a printer that a user can print to. This printer can perform a variety of tasks, such as printing a document and automatically saving it to a PDF or printing a document into OneNote.</p>
      <p>When a print monitor is registered, it will create a subkey under the HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Print\Monitors Registry key. This subkey will then specify the DLL that is to be loaded.</p>
      <figure>
        <img src="https://www.bleepstatic.com/images/news/malware/d/DePriMon/windows-print-monitors.jpg"/>
        <figcaption>Registered Adobe PDF Print Monitor</figcaption>
      </figure>
      <p>DLLs registered as print monitors are automatically loaded when Windows starts by the Windows print spooler service or spoolsv.exe. As this service runs with SYSTEM privileges, it also provides the loaded DLL with the same privileges.</p>
      <p>This is why it's an interesting and powerful method to use for malware persistence, such as in the case with the DePriMon malware.</p>
      <h3>A look at the DePriMon malware</h3>
      <p>Now that we understand what a print monitor is and why it's a powerful method of persistence for malware developers, let's take a look at the DePriMon malware.</p>
      <p>Discovered <a href="https://www.welivesecurity.com/2019/11/21/deprimon-default-print-monitor-malicious-downloader/">by ESET researchres</a>, DePriMon is a malware that when loaded will quietly download and execute further malware on the victim's computer.</p>
      <p>According to ESET's telemetry this malware has been active since as early as March 2017.</p>
      <p>"According to our telemetry, DePriMon has been active since at least March 2017. DePriMon was detected in a private company, based in Central Europe, and at dozens of computers in the Middle East."</p>
      <p>While the researchers do not know how this malware is initially infecting victims, they were able to examine the malware to determine how it operates.</p>
      <p>When installed, it will be configured as a print monitor named "Windows Default Print Monitor Driver" and when loaded will communicate with its command and control servers using TLS encryption.</p>
      <p>To make it harder for researchers to perform analysis, the configuration file for the malware is stored in an encrypted format in the %Temp% folder. When the malware needs to read it, it will decrypt the file, read it into memory, and then encrypt the file again.</p>
      <p>Unfortunately, at this time ESET has not been able to determine the final payload delivered by the DePriMon downloader.</p>
      <p>They have, though, noted that this malware has been detected on some victims along with the ColoredLambert malware, which is used by the Lamberts APT group.</p>
      <p>"However, it should be noted that, in a few cases, DePriMon was detected with ColoredLambert malware on the same computers within a short time frame. ColoredLambert is used by the Lamberts (aka Longhorn) cyberespionage group and linked to the Vault 7 leak of CIA capabilities. Our colleagues from <a href="https://www.symantec.com/connect/blogs/longhorn-tools-used-cyberespionage-group-linked-vault-7">Symantec</a> and <a href="https://securelist.com/unraveling-the-lamberts-toolkit/77990/">Kaspersky</a> published their analyses in April 2017."</p>
    </article>
  </body>
</html>