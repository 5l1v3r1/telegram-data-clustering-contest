<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8"/>
    <meta property="og:url" content="https://www.heise.de/newsticker/meldung/Microsoft-Aerger-mit-Access-nach-November-2019-Sicherheitsupdates-4587328.html"/>
    <meta property="og:site_name" content="heise online"/>
    <meta property="article:published_time" content="2019-11-16T09:35:00+00:00"/>
    <meta property="og:title" content="Microsoft: Ärger mit Access nach November-2019-Sicherheitsupdates"/>
    <meta property="og:description" content="Nach Installation der aktuellen Security-Updates scheitern Abfragen aus Access oftmals mit einem Fehler. Es gibt Workarounds; Updates sind geplant."/>
  </head>
  <body>
    <article>
      <h1>Microsoft: Ärger mit Access nach November-2019-Sicherheitsupdates</h1>
      <h2>Nach Installation der aktuellen Security-Updates scheitern Abfragen aus Access oftmals mit einem Fehler. Es gibt Workarounds; Updates sind geplant.</h2>
      <address><time datetime="2019-11-16T09:35:00+00:00">16 Nov 2019, 09:35</time> by <a rel="author">Günter Born</a></address>
      <p>Bereits kurz nach der Bereitstellung der November-2019-Sicherheitsupdates am vergangenen Dienstag ("Patch Tuesday") berichteten Nutzer von Problemen mit Access 2010-Datenbanken: Plötzlich sei der Zugriff gescheitert und Access habe die Fehlermeldung 03340 – "Abfrage <i>[Name der Abfrage] </i>ist beschädigt" – zurückgegeben.</p>
      <p>Später stellte sich heraus, dass Datenbankanfragen aus Access 2013 bis 2016 dieselben Probleme verursachen. Anwendungen, die die Laufzeitumgebungen der verschiedenen Access-Versionen für Datenbankabfragen verwenden, funktionieren ebenfalls nicht mehr. <a href="https://www.borncity.com/blog/2019/11/13/access-fehler-3340-durch-november-2019-updates/#comment-80406">Einem Kommentar im Blog des Autors zufolge</a> sind auch Lösungen von SAGE mit Access-2013-Runtime betroffen, selbst wenn diese auf SQL Server zugreifen.</p>
      <h3>Sicherheitsfix verantwortlich, Korrektur-Updates geplant</h3>
      <p>Die Vermutung, dass zwischen den frisch installierten Updates und dem Fehler ein Zusammenhang besteht, lag nahe. <a href="https://support.office.com/en-us/article/access-error-query-is-corrupt-fad205a5-9fd4-49f1-be83-f21636caedec">Mittlerweile hat Microsoft dies in einem Supportbeitrag bestätigt</a>.</p>
      <figure>
        <img src="https://www.heise.de/imgs/18/2/7/8/9/2/9/7/cfa97846-d77d-4416-84e7-e9fe8180d2ed-7b349a03f3397574.png"/>
        <figcaption>So sieht die englischsprachige Variante des Zugriffsfehlers aus.<cite>(Bild: Microsoft)</cite></figcaption>
      </figure>
      <p>Verantwortlich für den Fehler sind drei Sicherheitsupdates für die Schwachstelle <a href="https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-1402">CVE-2019-1402</a>:</p>
      <ul>
        <li>Office 2010: <a href="https://support.microsoft.com/help/4484127">KB4484127</a></li>
        <li>Office 2013: <a href="https://support.microsoft.com/help/4484119">KB4484119</a></li>
        <li>Office 2016: <a href="https://support.microsoft.com/help/4484113">KB4484113</a></li>
      </ul>
      <p>Dem Supportbeitrag ist zu entnehmen, dass neben MSI-Installationen von Microsoft Office 2010 bis 2016 auch Click-2-Run-Installationen (C2R) von Office 2013 bis 2019 sowie Office 365 betroffen sind.</p>
      <p>Microsoft gibt an, dass für Office 365 und Office 2019 ein Korrektur-Update für den 24. November 2019 eingeplant sei. Alle anderen Office-Versionen erhalten das Update voraussichtlich zum 10. Dezember 2019.</p>
      <h3>Offizieller Workaround von Microsoft</h3>
      <p>Wer nach einer Problemlösung ohne Deinstallation des Schutzes vor CVE-2019-1402 sucht, kann Microsofts eigenen, im <a href="https://support.office.com/en-us/article/access-error-query-is-corrupt-fad205a5-9fd4-49f1-be83-f21636caedec">Supportbeitrag zum Fehler</a> beschriebenen Workaround ausprobieren. Statt der direkten Aktualisierung einer Tabelle schlägt Microsoft darin einen Umweg vor: "The recommended workaround is to update the query so that it updates the results of another query, rather than updating a table directly." Im Beitrag nennt Redmond ein Beispiel zu dieser Vorgehensweise.</p>
      <p>Im Blog des Autors kritisieren Nutzer, dass dies bei fertigen Anwendungen mit Laufzeitumgebungen kaum zu bewältigen sei. Zudem seien diese Abfragen langsamer als die direkten Zugriffe auf die Tabelle. Weiterhin erscheine es in einigen Konstellationen ein unverhältnismäßiger Aufwand zu sein, den Workaround in einem Programm zu implementieren und in wenigen Wochen wieder zurückzunehmen.</p>
      <h3>Update-Deinstallation als schnelle Abhilfe für Betroffene</h3>
      <p>Betroffenen Anwendern bleibt aktuell als schnellste Lösung die – aus Security-Perspektive nur bedingt empfehlenswerte – Deinstallation der betreffenden Sicherheitsupdates aus der Liste der installierten Updates über die Systemsteuerung.</p>
      <p>Nach der Deinstallation berichteten Betroffene im Blog des Autors, dass die Abfragen wieder funktionierten. Andere beklagten allerdings, dass das Update gar nicht im Update-Verlauf gefunden wurde. In diesem Fall bleibt dann nur die Rückkehr auf einen Sicherungspunkt vor dem Patchday.</p>
      <p>Unter Windows 10 führt das Verteilen von Updates in nicht verwalteten Umgebungen unter Umständen dazu, dass das fehlerhafte Update nach der Deinstallation automatisch nachinstalliert wird. Dann bleibt als Notnagel, die Update-Installation zurückzustellen oder das Update <a href="https://support.microsoft.com/de-de/help/3073930/how-to-temporarily-prevent-a-driver-update-from-reinstalling-in-window">(nach Microsofts Anleitung)</a> mittels des Hilfstools "wushowhide.diagcab" auszublenden.</p>
      <p>In Windows 7/8.1 und den Server-Pendants lässt sich das Paket in Windows Update ausblenden und so von der weiteren Installation ausnehmen.</p>
      <h3>Office-Version zurücksetzen in C2R-Installationen</h3>
      <p>In Umgebungen mit C2R-Installationen von Office 365 oder Office 2013 bis 2019 gibt es solche Update-Pakete nicht. Betroffen sind dort Anwender, die die neueste Aktualisierung (beispielsweise 15.0.5189.1000 bei Office 2013) installiert haben. Dort lässt sich mit Befehlen wie:</p>
      <p>
        <i>“C:\Program Files\Microsoft Office 15\ClientX64\OfficeC2RClient.exe” /update user updatetoversion=15.0.5179.1000</i>
      </p>
      <p>zur vorherigen Office-Version zurückkehren. Der Befehl im Beispiel bezieht sich auf Office 2013. Microsoft hat zu diesem Thema <a href="https://support.microsoft.com/en-us/help/2770432/how-to-revert-to-an-earlier-version-of-office-2013-or-office-2016-clic">einen Support-Beitrag mit weiteren Details</a> veröffentlicht.</p>
      <p><a href="https://stackoverflow.com/a/58833831/87698">Auf der Entwicklerplattform Stack Overflow hat ein Nutzer ein VBA-Script veröffentlicht</a>, um das Rollback der problematischen Sicherheitsupdates für MSI- und C2R-Installationen automatisiert vorzunehmen. Ein weiteres Batch-Programm zum Rollback wurde <a href="https://www.borncity.com/blog/2019/11/13/access-fehler-3340-durch-november-2019-updates/#comment-80526">im Blog des Artikelautors</a> veröffentlicht. Die Nutzung erfolgt jeweils auf eigene Gefahr.</p>
      <p>
        <i>Mehr zu den aktuellen Security- und November-2019-Update(s):</i>
      </p>
      <ul>
        <li>
          <a href="https://www.heise.de/meldung/Patchday-Microsoft-schliesst-Zero-Day-Luecke-in-Internet-Explorer-4584926.html">Patchday: Microsoft schließt Zero-Day-Lücke in Internet Explorer</a>
        </li>
        <li>
          <a href="https://www.heise.de/meldung/Windows-10-November-2019-Update-V1909-verfuegbar-Tipps-zur-Installation-4584976.html">Windows 10 November 2019 Update (V1909) verfügbar: Tipps zur Installation</a>
        </li>
      </ul>
      <p>(<a href="mailto:ovw@heise.de">ovw</a>)</p>
    </article>
  </body>
</html>