<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8"/>
    <meta property="og:url" content="https://www.bleepingcomputer.com/news/security/new-banking-trojan-infects-victims-via-mcdonald-s-malvertising/"/>
    <meta property="og:site_name" content="BleepingComputer"/>
    <meta property="article:published_time" content="2019-11-20T17:38:21+00:00"/>
    <meta property="og:title" content="New Banking Trojan Infects Victims via McDonald’s Malvertising"/>
    <meta property="og:description" content="A new banking Trojan distributed via malvertising and malspam campaigns using fake McDonald's coupons as lures was observed while attempting to steal financial information from potential Latin American victim."/>
  </head>
  <body>
    <article>
      <h1>New Banking Trojan Infects Victims via McDonald’s Malvertising</h1>
      <address><time datetime="2019-11-20T17:38:21+00:00">20 Nov 2019, 17:38</time> by <a rel="author" href="https://www.bleepingcomputer.com/author/sergiu-gatlan/" target="_blank">Sergiu Gatlan</a></address>
      <figure>
        <img src="https://www.bleepstatic.com/content/hl-images/2019/11/20/Laptop_Malware.jpg"/>
      </figure>
      <p>A new banking Trojan distributed via malvertising and malspam campaigns using fake McDonald’s coupons as lures was observed while attempting to steal financial information from potential Latin American victim.</p>
      <p>The previously undocumented malware — dubbed Mispadu by ESET's research team that found it — is similar to other Latin American banking Trojans such as Amavaldo and Casbaneiro as it is developed in Delphi and uses a custom cryptographic algorithm for obfuscating its source code.</p>
      <p>This banking Trojan has been specifically built to attack users from Brazil and Mexico, with variants, different installers, and subsequent stages specifically developed for each of the targeted countries.</p>
      <h3>Fake McDonald’s discount coupons used as bait</h3>
      <p>The delivery mechanism makes use of fake McDonald’s discount coupons that either get distributed via spam emails or via malicious Facebook ads that redirect the targets to attacker-controlled sites offering the McDonald's coupons.</p>
      <p>Victims will then have to click a button to generate the coupon but they will instead be served with an archived MSI installer the attackers use to launch an unpacker script that will decrypt and execute a bundled downloader module which, in turn, will retrieve a loader from a remote server.</p>
      <p>This loader is the one that will drop Mispadu's configuration files, the encrypted banking Trojan payload, and the injector DLL designed to execute the malware on the compromised systems.</p>
      <figure>
        <img src="https://www.bleepstatic.com/images/news/u/1109292/November%202019/Mispadu%20campaign%20chain.png"/>
        <figcaption>Mispadu infection chain <i>(ESET)</i></figcaption>
      </figure>
      <p>As the final step in the infection chain, the loader script will add a link to the startup folder and launch the injector that decrypts and executes the encrypted payload downloaded in the previous step.</p>
      <p>"The loader script is more complicated than the first two stages. It is locale-specific; it checks the language identifier of the potential victim machine to verify it really comes from the country targeted by the current campaign (Brazil or Mexico, respectively)," <a href="https://www.welivesecurity.com/2019/11/19/mispadu-advertisement-discounted-unhappy-meal/">ESET says</a>.</p>
      <p>"It can detect some virtual environments as well; if a virtual environment is detected or the desired locale is not found, the loader quits."</p>
      <p>Mispadu was also spotted by ESET while using a malicious Google Chrome extension claiming that it's designed to protect the Chrome web browser to instead infect its targets' systems with the help of three JavaScript files.</p>
      <figure>
        <img src="https://www.bleepstatic.com/images/news/u/1109292/November%202019/Sies%20serving%20fake%20McDonald's%20coupons.png"/>
        <figcaption>Sites serving fake McDonald's coupons<i> (ESET)</i></figcaption>
      </figure>
      <h3>Steals credentials and sensitive info</h3>
      <p>Once it manages to infect a device, Mispadu will use fake pop-up windows to attempt to persuade potential victims to reveal sensitive information it can harvest just like the <a href="https://www.bleepingcomputer.com/news/security/windows-activator-bundles-banker-with-c2-in-youtube-description/">Casbaneiro</a> and <a href="https://www.welivesecurity.com/2019/08/01/banking-trojans-amavaldo/">Amavaldo</a> Trojans.</p>
      <p>Mispadu's main goals are to steal device and system information such as a list of installed common Latin American banking apps and a list of installed security products.</p>
      <p>The malware also extracts credentials from a multitude of web browsers and email clients including but not limited to Google Chrome, Mozilla Firefox, Internet Explorer, Microsoft Outlook, Mozilla Thunderbird, and Windows Live Mail.</p>
      <p>Mispadu also features clipper (aka clipboard hijacker) capabilities as it will also replace any found Bitcoin wallets with its own — ESET says that it hasn't stolen any crypto funds so far.</p>
      <p>Components of the Chrome extension Mispadu uses for distribution can also harvest credit card data from a list of hardcoded sites by scraping contents from input form fields.</p>
      <figure>
        <img src="https://www.bleepstatic.com/images/news/u/1109292/November%202019/Sample%20Boleto%20ticket.png"/>
        <figcaption>Sample Boleto ticket</figcaption>
      </figure>
      <p>Collecting banking information by scraping it from URLs of hardcoded sites and replacing the ID numbers on payment tickets generated using the Boleto payment system with ones controlled by Mispadu's operators are also capabilities built within the malicious Chrome extension.</p>
      <p>"For its backdoor functionality, Mispadu can take screenshots, simulate mouse and keyboard actions, and capture keystrokes," the researchers said. "It can update itself via a Visual Basic Script (VBS) file that it downloads and executes."</p>
      <p>An extensive list of indicators of compromise (IOCs) including malware sample SHA-1 hashes and addresses of servers used by the banking Trojan are available at the end of ESET's <i>Mispadu: Advertisement for a discounted Unhappy Meal</i> report.</p>
    </article>
  </body>
</html>