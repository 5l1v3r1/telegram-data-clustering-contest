<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8"/>
    <meta property="og:url" content="https://www.computerworld.com/article/3455160/mysterious-app-keeps-you-from-shutting-down-or-does-it.html"/>
    <meta property="og:site_name" content="Computerworld"/>
    <meta property="article:published_time" content="2019-11-21T16:02:00+00:00"/>
    <meta property="og:title" content="Mysterious app keeps you from shutting down — or does it?"/>
    <meta property="og:description" content="Some people are finding that Windows shutdown is blocked by a running program called G. Except there is no G, no G.exe, nothing even resembling G. In spite of what you’ve read, it isn’t a virus or other malware. It’s a bug — in Windows."/>
  </head>
  <body>
    <article>
      <h1>Mysterious app keeps you from shutting down — or does it?</h1>
      <h2>Some people are finding that Windows shutdown is blocked by a running program called G. Except there is no G, no G.exe, nothing even resembling G. In spite of what you’ve read, it isn’t a virus or other malware. It’s a bug — in Windows.</h2>
      <address><time datetime="2019-11-21T16:02:00+00:00">21 Nov 2019, 16:02</time> by <a rel="author">Woody Leonhard</a></address>
      <p>At last, we have a description of the mysterious shutdown-blocking G — and a fix for Microsoft’s G-generating bug coming in the next version of Win10, commonly called 20H1.</p>
      <p>If you look online, you’ll see hundreds (if not thousands) of reports about Win10 shutdown getting blocked by a mysterious app called, simply, G.</p>
      <figure>
        <img src="https://images.idgesg.net/images/article/2019/11/g-blocks-shutdown-100818550-medium.jpg"/>
        <figcaption>
          <cite>Overflowbr on <a href="https://www.bleepingcomputer.com/forums/t/669906/app-is-preventing-shutdown-gexe/page-2#entry4439373">Bleeping Computer</a></cite>
        </figcaption>
      </figure>
      <p>Most people assume it’s a virus, some other sort of malware or a harbinger of doom. In fact, it’s nothing of the sort. It’s a bug in the way Windows reports a specific kind of hang, and the bug has been fixed in the latest versions of Win10 20H1.</p>
      <p>The KB article associated with the first <a href="https://blogs.windows.com/windowsexperience/2019/10/29/announcing-windows-10-insider-preview-build-19013/#adT2s4Ij6gSd5CQU.97">Windows Insider beta build 19013 </a>release says:</p>
      <blockquote>Some of you have reached out about when trying to shutdown, seeing a message saying that an app named “G” was preventing shutdown. We investigated and found an issue where windows related to GDI+were only referenced as “G.” We’ve fixed this, so going forward, these will now have the name “GDI+ Window (&lt;exe name&gt;)”, where &lt;exe name&gt; will show the .exe name of the app using GDI+.</blockquote>
      <p>In fact, people have been “reaching out” to Microsoft about this bug for years. I easily found six complaints on Reddit (<a href="https://www.reddit.com/r/techsupport/comments/70xke5/app_called_g_is_preventing_shutdown_or_restart/">1</a>, <a href="https://www.reddit.com/r/techsupport/comments/8hah8x/gexe_preventing_shutdown_unsure_if_malware_or_not/">2</a>, <a href="https://www.reddit.com/r/techsupport/comments/al5iti/g_preventing_shutdown/">3</a>, <a href="https://www.reddit.com/r/techsupport/comments/85ekr1/program_called_g_preventing_shutdown/">4</a>, <a href="https://www.reddit.com/r/techsupport/comments/cte1j0/g_preventing_shutdown/">5</a>, <a href="https://www.reddit.com/r/techsupport/comments/7wjhq8/a_program_named_g_appears_when_shutting_down_in/">6</a>) going back two years. General consensus on Reddit, and elsewhere, is that the afflicted machines are running malware of some sort or another. General consensus is wrong.</p>
      <p>It’s a bug in the way the Blocked Shutdown Resolver pulls the name of the program blocking a shutdown, and “G” may result when there’s a GDI+ program (a program that draws stuff on the screen) that turns belly up as you’re shutting down.</p>
      <p>Raymond Chen, one of my favorite Microsoft explainers, has a detailed (if weighty) discussion on the <a href="https://devblogs.microsoft.com/oldnewthing/20191030-00/?p=103036">Developer Blog</a>.</p>
      <blockquote>At the time the GDI+ library was written, it needed to support Windows 98, which had very limited support for Unicode. Therefore, it was compiled as ANSI and consequently used the ANSI versions of functions like <code>Register­Class</code>, like <code>Create­Window</code>, and <code>Def­WindowProc</code> to create and manage its helper window. The lack of Unicode support in the helper window didn’t really cause a problem because the window never displayed any UI and never processed any text. The window was there to do things like listen for <code>WM_</code><code>SETTINGS­CHANGE</code> messages so it knew when to invalidate its caches. A few years ago, the GDI+ team did a little cleanup, and one of the things they did was get rid of support for Windows 98 and Windows Me...<br/><br/>When a program prevents you from signing out or shutting down, Windows looks for a visible window belonging to that program and uses that to represent it in the <a href="https://docs.microsoft.com/en-us/windows-hardware/customize/enterprise/troubleshooting-custom-logon">Blocked Shutdown Resolver</a> (BSDR) screen. But if the program has no visible windows, then the BSDR will take <i>any</i> window belonging to the program, visible or not. And sometimes the invisible window that gets chosen is the one named “G”.</blockquote>
      <p>So if you see that G is keeping you from shutting down, just go ahead and manually override it. No harm, no foul — and know that it’ll be fixed (finally!) when the next version of Win10 hits.</p>
      <p>
        <i>Thx, @b</i>
      </p>
      <p>
        <i>Having G problems? Tell us about it </i>
        <a href="https://www.askwoody.com/2019/a-mysterious-app-called-g-keeps-you-from-shutting-down-or-does-it/">
          <i>on AskWoody</i>
        </a>
        <i>.</i>
      </p>
    </article>
  </body>
</html>