<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8"/>
    <meta property="og:url" content="https://www.bleepingcomputer.com/news/security/android-camera-app-bug-lets-apps-record-video-without-permission/"/>
    <meta property="og:site_name" content="BleepingComputer"/>
    <meta property="article:published_time" content="2019-11-19T12:30:00+00:00"/>
    <meta property="og:title" content="Android Camera App Bug Lets Apps Record Video Without Permission"/>
    <meta property="og:description" content="A new vulnerability has been found in the Camera apps for millions, if not hundreds of millions, of Android devices that could allow other apps to record video, take pictures, and extract GPS data from media without having the required permissions."/>
  </head>
  <body>
    <article>
      <h1>Android Camera App Bug Lets Apps Record Video Without Permission</h1>
      <address><time datetime="2019-11-19T12:30:00+00:00">19 Nov 2019, 12:30</time> by <a rel="author" href="https://www.bleepingcomputer.com/author/lawrence-abrams/" target="_blank">Lawrence Abrams</a></address>
      <figure>
        <img src="https://www.bleepstatic.com/content/hl-images/2019/08/29/0_android-malware.jpg"/>
      </figure>
      <p>A new vulnerability has been found in the Camera apps for millions, if not hundreds of millions, of Android devices that could allow other apps to record video, take pictures, and extract GPS data from media without having the required permissions.</p>
      <p>Android apps expose various intents, or functions such as the ability to take a picture, that can be executed by other apps on the device. In order to execute an exposed intent, another app has to have the needed permissions.</p>
      <p>In a coordinated disclosure with Google and Samsung, researchers from Checkmarx disclosed today a new vulnerability that allows apps to take pictures, record videos, or get a device's location even if they do not have permissions to do so.</p>
      <p>This vulnerability, known as CVE-2019-2234, is known to affect the Google Camera and Samsung Camera apps if they have not been updated since before July 2019.</p>
      <h3>Bypassing permissions to take pictures and record videos</h3>
      <p>After analyzing the Google Pixel's Camera app, Checkmarx researchers discovered numerous intents that could be combined to manipulate the device's camera in order to take pictures and record video.</p>
      <p>Normally, an app needs to have the android.permission.CAMERA, android.permission.RECORD_AUDIO, android.permission.ACCESS_FINE_LOCATION, and android.permission.ACCESS_COARSE_LOCATION permissions in order to record video, take pictures, or access a device's location.</p>
      <p>Checkmarx discovered that apps that have the 'Storage' permission, which gives the app access to the device's entire SD card and the media stored on it, also gives an app the ability to use the Camera app's exposed intents without the permissions listed above.</p>
      <p>"A malicious app running on an Android smartphone that can read the SD card, not only has access to past photos and videos, but with this new attack methodology, can be directed to initiate (take) new photos and videos at will. And it doesn’t stop there. Since GPS metadata is usually embedded into the photos, the attacker can take advantage of this fact to also locate the user by taking a photo or video and parsing the proper EXIF data. "</p>
      <p>This is problematic because many apps regularly ask for the Storage permission, such as <a href="https://play.google.com/store/apps/details?id=mobi.gameguru.racingfever">car racing games</a>, <a href="https://play.google.com/store/apps/details?id=com.hbo.hbonow">streaming services</a>, and even <a href="https://play.google.com/store/apps/details?id=com.accuweather.android">weather apps</a>.</p>
      <figure>
        <img src="https://www.bleepstatic.com/images/news/security/accuweather-permissions.jpg"/>
        <figcaption>AccuWeather Permissions</figcaption>
      </figure>
      <p>According to <a href="https://www.checkmarx.com/blog/how-attackers-could-hijack-your-android-camera">Checkmarx's report</a>, the Storage permissions is the most common requested permission that they have observed.</p>
      <p>"There are a large number of applications, with legitimate use-cases, that request access to this storage, yet have no special interest in photos or videos. In fact, it’s one of the most common requested permissions observed."</p>
      <p>Even worse, this allowed the researchers to create a proof-of-concept app that pretends to be a weather app, but quietly sends a picture, video, and phone call recordings back to a demo command &amp; control server under the researcher's control as shown below.</p>
      <figure>
        <iframe src="https://www.youtube.com/embed/XJAMJOVoVyw" width="640" height="360" data-service="Youtube" scrolling="no"/>
      </figure>
      <p>As you can see this vulnerability is quite dangerous as it could allow apps that normally do not have permission, to:</p>
      <ul>
        <li>Take pictures and videos even if the phone is locked or the screen is off.</li>
        <li>Pull GPS location data from stored photos.</li>
        <li>Listen in on two-way conversations even when recording video and taking pictures. Talk about <a href="https://www.bleepingcomputer.com/news/security/beware-of-extortion-scams-stating-they-have-video-of-you-on-adult-sites/">sextortion</a> potential!</li>
        <li>Silence the camera shutter so that victim's cant hear when pictures are taken.</li>
        <li>Transfer historical videos and photos stored on the SD card.</li>
      </ul>
      <h3>Google Camera app fixed in July 2019</h3>
      <p>Checkmarx disclosed this vulnerability to Google on July 4th, 2019 and by July 23rd, Google had elevated this vulnerability to a 'High' classification.</p>
      <p>On August 1st, it Google confirmed the researcher's suspicions that this vulnerability affected Camera apps for other Android mobile device vendors and issued CVE-2019-2234 for the vulnerability.</p>
      <p>Later in August it was determined that Samsung's Camera app was affected too and both vendors approved the publication of this vulnerability.</p>
      <p>According to Google, this vulnerability in the Camera app was fixed in July 2019 via a Google Play Store update and a patch was issued to other vendors.</p>
      <p>“We appreciate Checkmarx bringing this to our attention and working with Google and Android partners to coordinate disclosure. The issue was addressed on impacted Google devices via a Play Store update to the Google Camera Application in July 2019. A patch has also been made available to all partners.”</p>
      <p>All users are strongly advised to upgrade to the latest version of Android and make sure you are using the latest Camera app for your device.</p>
    </article>
  </body>
</html>